<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=4.0, user-scalable=yes, viewport-fit=cover">
    <title>
        eBPF: Linux 内核的超能力 | eBPF: The Superpower of Linux Kernel
    </title>

    <meta name="description" content="[ZH] 深度解析 eBPF 如何重塑现代化基础设施平台，涵盖 JIT 编译、Verifier 验证器及 CO-RE 跨版本运行机制。[EN] In-depth analysis of how eBPF is reshaping modern infrastructure, covering JIT, Verifier, and CO-RE mechanism.">

    <meta name="keywords" content="eBPF, Linux Kernel, Linux 内核, XDP, Kprobes, 2025 Report, 2025 报告, JIT, CO-RE, 内核编程, Kernel Observability, 性能监控">

    <meta name="revised" content="Sunday, January 4th, 2026, 5:00 pm" />
    <meta property="og:title" content="eBPF: Linux 内核的超能力 | The Superpower of Linux Kernel">
    <meta property="og:description" content="深度解析 eBPF 核心机制与现代化基础设施重塑。 Exploration of eBPF core mechanisms and infrastructure transformation.">
    <meta property="og:type" content="article">
    <meta property="og:updated_time" content="2026-01-04T17:00:00+08:00" />

    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": "eBPF: Linux 内核的超能力 | eBPF: The Superpower of Linux Kernel",
    "description": "深度解析 eBPF 如何重塑现代化基础设施平台，涵盖 JIT 编译、Verifier 验证器及 CO-RE 跨版本运行机制。 In-depth analysis of how eBPF reshapes modern infrastructure, covering JIT, Verifier, and CO-RE.",
    "datePublished": "2025-12-20T10:00:00+08:00",
    "dateModified": "2026-01-04T17:00:00+08:00",
    "proficiencyLevel": "Expert",
    "author": { 
        "@type": "Person", 
        "name": "Weibo Rao" 
    },
    "keywords": "eBPF, Linux Kernel, XDP, Kprobes, JIT, CO-RE"
    }
    </script>

    <style>
        /* --- 100% 原始保留所有 CSS 变量与样式 --- */
        :root {
            --cisco-blue: #049FD9;
            --cisco-dark-blue: #1D2729;
            --cisco-midnight: #0D274D;
            --cisco-sky-blue: #6ABF4B;
            --cisco-green: #6CC24A;
            --cisco-red: #E2231A;
            --cisco-orange: #FF9E1B;
            --cisco-gray: #F2F2F2;
            --cisco-light-gray: #E8E8E8;
            --text-main: #333;
            --text-light: #FFF;
            --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            --transition: all 0.3s ease;
            --section-padding: 120px
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent
        }

        body {
            font-family: var(--font-family);
            color: var(--text-main);
            background-color: #fff;
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            width: 100%
        }

        /* --- 核心组件样式 --- */
        .btn {
            display: inline-block;
            padding: 12px 28px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            cursor: pointer;
            border: none;
            font-size: 1rem
        }

        .btn-primary {
            background-color: var(--cisco-blue);
            color: white;
            box-shadow: 0 4px 6px rgba(4, 159, 217, 0.3)
        }

        /* --- 国际化辅助类 --- */
        .hidden {
            display: none !important
        }

        /* 切换语言时，暂时禁用所有动画以防止布局抖动 */
        .is-transitioning * {
            transition: none !important;
            animation: none !important
        }

        /* --- Header 样式 --- */
        header {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 15px 0
        }

        .nav-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--cisco-dark-blue);
            display: flex;
            align-items: center;
            gap: 12px
        }

        .logo svg {
            height: 28px;
            width: auto
        }

        /* --- 导航栏左侧布局与返回按钮 --- */
        .nav-left {
            display: flex;
            align-items: center;
            gap: 20px;
            /* 保持按钮与 Logo 之间的呼吸感 */
        }

        .btn-home {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid #ddd;
            color: var(--cisco-dark-blue);
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 600;
            transition: var(--transition)
        }

        .btn-home:hover {
            border-color: var(--cisco-blue);
            color: var(--cisco-blue);
            background: rgba(4, 159, 217, 0.05)
        }

        .btn-home svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
            /* 自动跟随文字颜色 */
        }

        /* 移动端适配：空间有限时隐藏文字，只留图标 */
        @media (max-width: 480px) {
            .btn-home span {
                display: none
            }

            .btn-home {
                padding: 6px 8px
            }
        }

        .lang-switch {
            background: var(--cisco-gray);
            border-radius: 20px;
            padding: 4px;
            display: flex;
            font-size: 0.85rem
        }

        .lang-btn {
            padding: 6px 14px;
            border-radius: 16px;
            cursor: pointer;
            color: #666;
            font-weight: 600;
            transition: all 0.2s
        }

        .lang-btn.active {
            background: white;
            color: var(--cisco-blue);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1)
        }

        .hero {
            background: linear-gradient(135deg, var(--cisco-dark-blue) 0%, #0D274D 100%);
            color: white;
            padding: 100px 0 140px;
            text-align: center;
            position: relative;
            overflow: hidden
        }

        .hero::before {
            content: "";
            position: absolute;
            top: -50px;
            right: -50px;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(4, 159, 217, 0.2) 0%, rgba(0, 0, 0, 0) 70%);
            z-index: 0
        }

        .hero-content {
            position: relative;
            z-index: 1
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 24px;
            font-weight: 300;
            letter-spacing: -1px
        }

        .hero h1 strong {
            font-weight: 800;
            display: block;
            color: var(--cisco-blue);
            margin-top: 10px
        }

        .hero p {
            font-size: 1.25rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto 40px;
            font-weight: 300
        }

        /* Winston 原则：显著性呼吁框 (Salience Callout) */
        .winston-callout {
            background: rgba(4, 159, 217, 0.05);
            border-left: 5px solid var(--cisco-blue);
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
            font-weight: 500;
            color: var(--cisco-midnight)
        }

        .winston-callout strong {
            color: var(--cisco-blue);
            text-transform: uppercase;
            font-size: 0.85rem;
            display: block;
            margin-bottom: 5px
        }

        .winston-callout p {
            margin: 0
        }

        .hero-evidence-bar {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 50px;
            flex-wrap: wrap
        }

        .evidence-item {
            text-align: left;
            border-left: 3px solid var(--cisco-blue);
            padding-left: 15px
        }

        .section-title {
            text-align: center;
            font-size: 2.2rem;
            color: var(--cisco-dark-blue);
            margin-bottom: 60px;
            font-weight: 700;
            position: relative
        }

        .section-title::after {
            content: "";
            display: block;
            width: 60px;
            height: 4px;
            background: var(--cisco-blue);
            margin: 20px auto 0;
            border-radius: 2px
        }

        .golden-badge {
            display: inline-block;
            padding: 4px 12px;
            background: var(--cisco-blue);
            color: white;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-bottom: 15px;
            text-transform: uppercase
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0
        }

        .feature-box {
            background: white;
            padding: 30px;
            border-radius: 12px;
            border: 1px solid #eee;
            box-shadow: var(--card-shadow);
            transition: var(--transition)
        }

        .feature-box:hover {
            transform: translatey(-5px);
            border-color: var(--cisco-blue)
        }

        .feature-box svg {
            width: 48px;
            height: 48px;
            fill: var(--cisco-blue);
            margin-bottom: 20px
        }

        .comparison-wrapper {
            overflow-x: auto;
            margin: 60px 0;
            -webkit-overflow-scrolling: touch
        }

        .comparison-table {
            width: 100%;
            min-width: 600px;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--card-shadow)
        }

        .comparison-table th {
            background: var(--cisco-dark-blue);
            color: white;
            padding: 20px;
            text-align: left;
            font-size: 1rem
        }

        .comparison-table td {
            padding: 20px;
            border-bottom: 1px solid #eee;
            font-size: 0.95rem
        }

        .analogy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px
        }

        .analogy-item {
            text-align: center;
            height: 100%
        }

        .analogy-icon {
            height: 140px;
            margin-bottom: 25px;
            transition: transform 0.3s
        }

        .analogy-tag {
            font-family: "Courier New", monospace;
            font-size: 0.75rem;
            color: var(--cisco-blue);
            font-weight: bold;
            text-transform: uppercase;
            display: block;
            margin-bottom: 8px
        }

        .card {
            background: white;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            padding: clamp(20px, 5%, 40px);
            margin-bottom: 20px;
            border-top: 4px solid var(--cisco-blue);
            transition: var(--transition)
        }

        .check-icon {
            color: var(--cisco-green);
            font-weight: bold
        }

        .cross-icon {
            color: var(--cisco-red);
            font-weight: bold
        }

        .symbol-container {
            background: #f8f9fa;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin: 40px 0
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px;
            margin-top: 50px
        }

        .insight-card {
            background: #f8f9fa;
            border-left: 4px solid var(--cisco-blue);
            padding: 20px;
            margin: 30px 0;
            font-style: italic;
            color: #555;
            font-size: 1rem;
            line-height: 1.7
        }

        .pillars-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-top: 50px
        }

        /* --- 交互对比模块：JS 类比演示 --- */
        .analogy-showcase { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 25px; 
            margin: 40px 0; 
        }
        .browser-window { 
            border: 1px solid #ddd; 
            border-radius: 12px; 
            overflow: hidden; 
            background: #fff; 
            box-shadow: var(--card-shadow); 
            height: 280px; 
            display: flex; 
            flex-direction: column; 
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .browser-bar { 
            background: #f1f1f1; 
            padding: 12px; 
            border-bottom: 1px solid #ddd; 
            display: flex; 
            gap: 8px; 
            align-items: center; 
        }
        .dot-ui { width: 10px; height: 10px; border-radius: 50%; background: #ccc; }
        .preview-content { padding: 25px; flex-grow: 1; overflow: hidden; position: relative; }

        /* 激活状态：外发光与边框颜色 */
        .active-power { 
            border-color: var(--cisco-blue) !important; 
            box-shadow: 0 0 30px rgba(4, 159, 217, 0.3); 
        }

        /* 点亮按钮样式 */
        .btn-ignite {
            background: var(--cisco-blue);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px auto;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(4, 159, 217, 0.4);
        }
        .btn-ignite:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(4, 159, 217, 0.6);
        }
        .btn-ignite svg { width: 18px; height: 18px; fill: currentColor; }

        /* 打字机效果相关 */
        .typewriter-box { font-family: var(--font-family); line-height: 1.6; }
        .typewriter-text { 
            color: var(--cisco-blue); 
            font-weight: bold; 
            border-right: 2px solid var(--cisco-blue);
            white-space: nowrap;
            overflow: hidden;
            display: inline-block;
        }
        @keyframes blink-cursor { 50% { border-color: transparent; } }
        .typewriter-cursor { animation: blink-cursor 0.8s infinite; }

        @media (max-width: 768px) { .analogy-showcase { grid-template-columns: 1fr; } }

        /* 1. 基础骨架：定义一次即可 */
        .feature-card {
            background: #fff;
            padding: clamp(25px, 5%, 40px);
            /* 优化移动端间距 */
            border-radius: 20px;
            border: 1px solid #eee;
            border-top: 6px solid var(--cisco-blue);
            transition: transform 0.3s cubic-bezier(0.2, 0, 0.2, 1), box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
            will-change: transform;
            /* 告诉浏览器提前准备硬件加速 */
        }

        .feature-icon-box {
            width: 75px;
            height: 75px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            transition: var(--transition)
        }

        .term-group {
            margin-bottom: 60px
        }

        .term-group-title {
            font-size: 1.6rem;
            color: var(--cisco-blue);
            border-left: 6px solid var(--cisco-blue);
            padding-left: 18px;
            margin-bottom: 30px;
            font-weight: 800
        }

        .term-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px
        }

        .term-card {
            background: #fff;
            border: 1px solid #eee;
            padding: 25px;
            border-radius: 12px;
            transition: var(--transition);
            position: relative;
            overflow: hidden
        }

        .term-card::after {
            content: "";
            position: absolute;
            bottom: 0;
            right: 0;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, transparent 50%, var(--cisco-blue) 50%);
            opacity: 0.05
        }

        .term-card:hover {
            border-color: var(--cisco-blue);
            box-shadow: 0 6px 20px rgba(4, 159, 217, 0.1)
        }

        .term-card h4 {
            color: var(--cisco-midnight);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem
        }

        .term-card p {
            font-size: 0.95rem;
            color: #555;
            line-height: 1.5
        }

        .process-section {
            background-color: #FAFAFA
        }

        .diagram-container {
            display: flex;
            justify-content: center;
            margin: 40px 0;
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--card-shadow)
        }

        .arch-svg {
            max-width: 100%;
            height: auto
        }

        .process-steps {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 25px;
            position: relative;
            margin-top: 50px
        }

        .step-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            border: 1px solid #eee;
            position: relative;
            z-index: 2
        }

        .step-number {
            background: var(--cisco-blue);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 20px
        }

        /* --- 移除冗余后的增量优化：代码窗格稳定性 --- */
        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%
        }

        .dot-red {
            background: #ff5f56
        }

        .dot-yellow {
            background: #ffbd2e
        }

        .dot-green {
            background: #27c93f
        }

        .code-content-stable {
            padding: 20px;
            font-family: "Fira Code", "Courier New", monospace;
            font-size: 0.9rem;
            color: #d4d4d4;
            line-height: 1.6;
            overflow-x: auto;
            /* 核心：配合 JS 处理缩进，使用 pre 保证原始对齐 */
            white-space: pre;
            tab-size: 4;
            background: #1e1e1e
        }

        /* 移动端适配 */
        @media (max-width: 768px) {
            .code-content-stable {
                font-size: 0.8rem;
                white-space: pre-wrap;
                /* 移动端允许换行防止溢出 */
            }
        }

        .hook-list {
            list-style: none;
            padding: 0;
            margin-top: 15px
        }

        .hook-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            display: flex;
            gap: 15px;
            align-items: flex-start
        }

        .hook-item:last-child {
            border-bottom: none
        }

        .hook-label {
            font-weight: bold;
            color: var(--cisco-blue);
            min-width: 80px;
            font-family: "Courier New", monospace
        }

        .hook-desc {
            font-size: 0.9rem;
            color: #555
        }

        /* --- i18n 修复：确保语言切换时既能显示，又不破坏原始布局属性 --- */
        /* 默认隐藏逻辑 */
        [data-lang="zh"] .lang-en {
            display: none !important
        }

        [data-lang="en"] .lang-zh {
            display: none !important
        }

        /* 关键修复：使用 revert 恢复标签原始的 display 属性（如 table-cell, inline-block 等） */
        /* 这样可以确保按钮居中（inline-block）和表格正常（table-cell） */
        [data-lang="en"] .lang-en:not(.tab-content) {
            display: revert !important
        }

        [data-lang="zh"] .lang-zh:not(.tab-content) {
            display: revert !important
        }

        /* 针对 Flex 容器的特殊适配（保持原样） */
        [data-lang="en"] .nav-left .lang-en,
        [data-lang="en"] .logo .lang-en {
            display: flex !important
        }

        [data-lang="zh"] .nav-left .lang-zh,
        [data-lang="zh"] .logo .lang-zh {
            display: flex !important
        }

        /* 代码窗格优化：确保 pre 标签内的代码左对齐且不产生额外偏移 */
        .code-content-stable {
            white-space: pre !important;
            text-align: left !important;
            margin: 0 !important;
            padding: 20px !important
        }

        /* Pillars Styles */
        .features {
            background-color: var(--cisco-dark-blue);
            color: white
        }

        .features .section-title {
            color: white
        }

        /* --- 全局卡片架构优化：自适应主题 --- */
        /* 1. 基础卡片样式（默认：浅色环境） */
        .feature-card {
            background: #fff;
            padding: 40px 35px;
            border-radius: 20px;
            border: 1px solid #eee;
            border-top: 6px solid var(--cisco-blue);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            height: 100%
        }

        .feature-card h3,
        .feature-card h4 {
            color: var(--cisco-midnight);
            /* 默认深色标题 */
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 700
        }

        .feature-card p {
            color: var(--text-main);
            /* 默认深色正文 */
            font-size: 1rem;
            line-height: 1.7;
            flex-grow: 1
        }

        /* 2. 交互效果 */
        .feature-card:hover {
            transform: translatey(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1)
        }

        /* 3. 深色环境适配（自动覆盖） */
        /* 作用于：Hero, 三大支柱(.features), 明星项目(midnight背景) */
        .hero .feature-card,
        .features .feature-card,
        section[style*="midnight"] .feature-card {
            background: rgba(255, 255, 255, 0.04) !important;
            border: 1px solid rgba(255, 255, 255, 0.08) !important;
            backdrop-filter: blur(12px);
            border-top: 6px solid var(--cisco-blue) !important
        }

        .hero .feature-card h3,
        .hero .feature-card h4,
        .features .feature-card h3,
        .features .feature-card h4,
        section[style*="midnight"] .feature-card h3,
        section[style*="midnight"] .feature-card h4 {
            color: #fff !important
        }

        .hero .feature-card p,
        .features .feature-card p,
        section[style*="midnight"] .feature-card p {
            color: rgba(255, 255, 255, 0.8) !important
        }

        /* 图标盒子背景适配 */
        .feature-icon-box {
            background: rgba(29, 39, 41, 0.05);
            /* 浅色背景下的灰色背景 */
        }

        .features .feature-icon-box,
        .hero .feature-icon-box {
            background: rgba(255, 255, 255, 0.1) !important;
            /* 深色背景下的半透明背景 */
        }

        .demo-section {
            background: #fff;
            border-top: 1px solid #eee
        }

        /* 终端模拟器容器 */
        .terminal-wrapper {
            background: #000;
            border-radius: 8px;
            padding: 25px;
            color: #0f0;
            font-family: "Courier New", Courier, monospace;
            height: 320px;
            /* 适当减小固定高度 */
            max-height: 50vh;
            /* 最大高度不超过屏幕一半 */
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            /* iOS 滚动丝滑 */
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.6);
            margin: 30px 0;
            border: 1px solid #444
        }

        .terminal-line {
            margin-bottom: 10px;
            line-height: 1.5;
            font-size: 0.95rem
        }

        .terminal-prompt {
            color: #fff;
            font-weight: bold
        }

        .terminal-cursor {
            display: inline-block;
            width: 10px;
            height: 18px;
            background: #0f0;
            vertical-align: middle;
            animation: blink 1s infinite
        }

        @keyframes blink {
            50% {
                opacity: 0;
            }
        }

        /* 模拟流水线/赛道容器 */
        .pipeline-container {
            background: var(--cisco-dark-blue);
            border-radius: 20px;
            padding: 30px;
            position: relative;
            height: 280px;
            overflow: hidden;
            margin: 40px auto;
            max-width: 1000px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: inset 0 0 80px rgba(0, 0, 0, 0.6)
        }

        .kernel-zone {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            border: 2px dashed rgba(255, 255, 255, 0.1);
            pointer-events: none;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 20px;
            color: rgba(255, 255, 255, 0.25);
            font-size: 1rem;
            letter-spacing: 4px;
            font-weight: bold;
            text-transform: uppercase
        }

        /* 数据包样式 */
        .packet {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 12px;
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translatey(-50%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            color: var(--cisco-dark-blue);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
            z-index: 10;
            transition: left 0.1s linear, opacity 0.3s
        }

        /* eBPF 程序圆形区域 */
        .ebpf-program {
            width: 160px;
            height: 160px;
            background: rgba(4, 159, 217, 0.15);
            border: 2px solid var(--cisco-blue);
            border-radius: 50%;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9rem;
            box-shadow: 0 0 40px rgba(4, 159, 217, 0.3);
            z-index: 5
        }

        /* BPF Maps 仪表盘样式 */
        .map-dashboard {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--cisco-blue);
            border-radius: 8px;
            padding: 15px;
            width: 220px;
            color: var(--cisco-blue);
            font-family: "Courier New", monospace;
            box-shadow: 0 0 15px rgba(4, 159, 217, 0.3)
        }

        .map-title {
            font-size: 0.75rem;
            color: #fff;
            border-bottom: 1px solid #444;
            padding-bottom: 5px;
            margin-bottom: 10px;
            text-transform: uppercase
        }

        .map-stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px
        }

        .stat-value {
            color: var(--cisco-green);
            font-weight: bold
        }

        .stat-value.alert {
            color: var(--cisco-red);
            animation: flash 0.5s ease
        }

        @keyframes flash {
            50% {
                opacity: 0.3;
            }
        }

        .feature-grid-eco {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 35px;
            margin-top: 50px
        }

        /* 针对深色背景下的 feature-card 特殊样式 */
        .feature-grid-eco .feature-card {
            background: #fff !important;
            /* 强制改为白色背景 */
        }

        .feature-grid-eco .feature-card:hover {
            transform: translatey(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1)
        }

        /* 100% 还原结构，仅修改配色：正文黑色 */
        .feature-grid-eco .feature-card p {
            color: #333 !important;
            /* 强制改为深灰色/黑色 */
            font-size: 0.95rem;
            line-height: 1.7;
            opacity: 1 !important;
            /* 移除透明度以确保文字清晰 */
        }

        /* 3. 深色环境适配：仅覆盖配色 */
        .features .feature-card,
        .hero .feature-card {
            background: rgba(255, 255, 255, 0.04) !important;
            border-color: rgba(255, 255, 255, 0.1) !important;
            backdrop-filter: blur(12px)
        }

        .case-study-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 40px
        }

        .case-study-card {
            background: #fff;
            border: 1px solid #eee;
            border-radius: 12px;
            padding: 25px;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            justify-content: space-between
        }

        .case-study-card:hover {
            border-color: var(--cisco-blue);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05)
        }

        .case-study-meta {
            font-weight: 800;
            color: var(--cisco-midnight);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px
        }

        .case-study-meta span {
            font-size: 0.7rem;
            background: var(--cisco-gray);
            padding: 2px 8px;
            border-radius: 4px;
            text-transform: uppercase
        }

        .report-highlight {
            background: #f8f9fa;
            border-radius: 16px;
            padding: 40px;
            margin: 60px 0;
            border: 1px solid var(--cisco-blue)
        }

        /* 增强：2025 报告卡片的视觉深度 */
        .report-highlight {
            position: relative;
            overflow: hidden;
            background: linear-gradient(to bottom right, #f8f9fa, #fff)
        }

        .report-highlight::before {
            content: "2025";
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 8rem;
            font-weight: 900;
            color: rgba(4, 159, 217, 0.03);
            pointer-events: none
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0
        }

        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: var(--card-shadow)
        }

        .metric-card .value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--cisco-blue);
            display: block
        }

        .metric-card .label {
            font-size: 0.9rem;
            color: #666
        }

        .faq-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px
        }

        /* 专家洞察标签 */
        .checkpoint-tag {
            background: var(--cisco-midnight);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 10px;
            position: absolute;
            top: -20px;
            left: 10px;
            white-space: nowrap
        }

        /* 强化对比卡片中的重要数字 */
        /* 增强 2025 演进卡片的视觉识别度 */
        .insight-card strong {
            color: var(--cisco-blue)
        }

        /* 确保深色模式下某些内联卡片的文字对比度 */
        section.features .insight-card p {
            color: var(--cisco-midnight) !important
        }

        /* 针对 2x2 矩阵布局的专项优化 */
        .grid-2x2 {
            display: grid !important;
            grid-template-columns: repeat(2, 1fr) !important;
            gap: 30px !important
        }

        /* 移动端适配：回退为单列布局 */
        @media (max-width: 991px) {
            .grid-2x2 {
                grid-template-columns: 1fr !important
            }
        }

        /* 增强：为术语百科增加“分层认知”视觉标记 */
        .term-card {
            border-left: 1px solid #eee
        }

        .term-card.advanced::after {
            content: "ADVANCED";
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 0.6rem;
            background: var(--cisco-gray);
            padding: 2px 6px;
            border-radius: 4px;
            color: #999
        }

        /* 增量样式：逻辑引导线 */
        .logic-connector {
            width: 2px;
            height: 40px;
            background: linear-gradient(to bottom, var(--cisco-blue), transparent);
            margin: 0 auto
        }

        /* 增强：卡片内的代码高亮微调 */
        .term-card strong {
            color: var(--cisco-midnight);
            border-bottom: 1px solid rgba(4, 159, 217, 0.3)
        }

        /* 2025 标识浮层 */
        /* 增强：确保 detail-grid 卡片等高且内容垂直分布 */
        .detail-grid .card {
            display: flex;
            flex-direction: column;
            height: 100%
        }

        .detail-grid .card p {
            flex-grow: 1;
            /* 让正文自动填充剩余空间，使底部的 Insight Card 对齐 */
        }

        /* 优化 Insight Card 的边框和文字颜色 */
        .detail-grid .insight-card {
            font-size: 0.85rem;
            line-height: 1.5
        }

        /* 确保详情网格与上方代码块有清晰的逻辑间距 */
        .process-section .detail-grid {
            margin-top: 40px
        }

        /* 全栈代码协作视窗 */
        .synergy-container {
            background: #1e1e1e;
            border-radius: 12px;
            overflow: hidden;
            margin: 40px 0;
            border: 1px solid #333;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3)
        }

        .synergy-header {
            background: #252526;
            padding: 15px 25px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center
        }

        .synergy-badge {
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 1px
        }

        .badge-kernel {
            background: rgba(4, 159, 217, 0.2);
            color: var(--cisco-blue);
            border: 1px solid var(--cisco-blue)
        }

        .badge-user {
            background: rgba(108, 194, 74, 0.2);
            color: var(--cisco-green);
            border: 1px solid var(--cisco-green)
        }

        .synergy-grid {
            display: grid;
            grid-template-columns: 1fr;
            /* 移动端优先：垂直排列 */
        }

        @media (min-width: 992px) {
            .synergy-grid {
                grid-template-columns: 1fr 1fr
            }

            /* 宽屏：左右分屏 */
        }

        .code-pane {
            padding: 0;
            border-right: 1px solid #333
        }

        .code-pane:last-child {
            border-right: none
        }

        .pane-title {
            background: #2d2d2d;
            padding: 8px 20px;
            font-size: 0.8rem;
            color: #888;
            display: flex;
            justify-content: space-between
        }

        /* 逻辑线条感 */
        .map-bridge-indicator {
            background: linear-gradient(90deg, transparent, rgba(4, 159, 217, 0.1), transparent);
            text-align: center;
            padding: 10px;
            font-family: "Courier New", monospace;
            font-size: 0.8rem;
            color: var(--cisco-blue);
            border-top: 1px solid #333;
            border-bottom: 1px solid #333
        }

        /* 页脚样式 */
        footer {
            background: var(--cisco-dark-blue);
            color: white;
            text-align: center;
            font-size: 0.95rem;
            border-top: 6px solid var(--cisco-blue)
        }

        footer svg {
            height: 35px;
            opacity: 0.9
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.2rem
            }

            .hero p {
                font-size: 1.1rem
            }

            .section-title {
                font-size: 1.8rem;
                margin-bottom: 40px
            }

            .pillars-grid {
                grid-template-columns: 1fr
            }

            .process-steps {
                grid-template-columns: 1fr;
                gap: 40px
            }

            .step-arrow {
                display: none
            }

            .step-card {
                border-top: 4px solid var(--cisco-blue)
            }

            /* --- 移动端专项优化：代码框与列表编号 --- */
            @media (max-width: 768px) {

                /* 1. 修复代码框显示不全：允许折行并优化间距 */
                .code-content-stable {
                    white-space: pre-wrap !important;
                    /* 强制换行防止溢出 */
                    word-break: break-all;
                    /* 允许长单词换行 */
                    font-size: 0.75rem !important;
                    /* 移动端字号略微缩小以容纳更多代码 */
                    padding: 15px !important;
                    overflow-x: hidden;
                    /* 隐藏横向滚动条 */
                }

                .synergy-header {
                    padding: 10px 15px !important
                }

                /* 2. 修复生命周期数字编号靠左问题 */
                .detail-grid ol {
                    padding-left: 5px !important;
                    /* 减少左侧冗余缩进 */
                    list-style-position: inside !important;
                    /* 让编号进入容器内部 */
                }

                .detail-grid ol li {
                    margin-bottom: 8px;
                    /* 增加行间距，方便手机阅读 */
                    text-indent: -1.4em;
                    /* 悬挂缩进：确保编号后的文字对齐 */
                    padding-left: 1.6em;
                    /* 配合悬挂缩进 */
                }
            }

            /* 针对 6 步法优化：中大型屏幕显示 3 列，小型屏幕显示 1 列 */
            @media (min-width: 992px) {
                .process-steps {
                    grid-template-columns: repeat(3, 1fr) !important
                }
            }

            @media (max-width: 991px) {
                .process-steps {
                    grid-template-columns: 1fr !important
                }
            }

            /* 增强步骤卡片的内容一致性 */
            .step-card {
                display: flex;
                flex-direction: column
            }

            .step-card p {
                flex-grow: 1
            }

            .pipeline-container {
                height: 200px;
                padding: 15px
            }

            .ebpf-program {
                width: 120px;
                height: 120px
            }

            .feature-grid-eco {
                grid-template-columns: 1fr
            }

            .isovalent-main-card {
                padding: 20px !important;
                width: 100% !important;
                box-sizing: border-box !important
            }

            .isovalent-header-box {
                flex-direction: column;
                text-align: center;
                gap: 15px !important
            }

            .isovalent-header-box h3 {
                font-size: 1.5rem !important
            }

            .faq-grid {
                grid-template-columns: 1fr
            }

            .winston-callout {
                padding: 20px;
                font-size: 1.05rem !important
            }
        }

        /* 参考资料列表样式 */
        .reference-list {
            list-style: none;
            padding: 0;
            margin-top: 30px;
        }

        .reference-item {
            margin-bottom: 12px;
            padding-left: 20px;
            position: relative;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .reference-item::before {
            content: "•";
            position: absolute;
            left: 0;
            color: var(--cisco-blue);
            font-weight: bold;
        }

        .reference-item a {
            color: var(--cisco-midnight);
            text-decoration: none;
            word-break: break-all;
            transition: var(--transition);
        }

        .reference-item a:hover {
            color: var(--cisco-blue);
            text-decoration: underline;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header>
        <div class="container nav-wrapper">
            <div class="nav-left">
                <a href="/works" class="btn-home">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
                    </svg>
                    <span class="lang-zh">返回主页</span>
                    <span class="lang-en hidden">Home</span>
                </a>
                <div class="logo">
                    <svg viewBox="0 0 64 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="64" height="32" rx="4" fill="white" />
                        <path d="M14 24V16" stroke="#049FD9" stroke-width="3" stroke-linecap="round" />
                        <path d="M22 24V10" stroke="#049FD9" stroke-width="3" stroke-linecap="round" />
                        <path d="M30 24V14" stroke="#049FD9" stroke-width="3" stroke-linecap="round" />
                        <path d="M38 24V8" stroke="#049FD9" stroke-width="3" stroke-linecap="round" />
                        <path d="M46 24V14" stroke="#049FD9" stroke-width="3" stroke-linecap="round" />
                        <path d="M54 24V19" stroke="#049FD9" stroke-width="3" stroke-linecap="round" />
                    </svg>
                </div>
                <div class="lang-switch">
                    <div class="lang-btn active" onclick="setLang('zh')">中文</div>
                    <div class="lang-btn" onclick="setLang('en')">EN</div>
                </div>
            </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container hero-content">
            <h1 class="lang-zh">eBPF<br><strong>Linux 内核的超能力</strong></h1>
            <h1 class="lang-en hidden">eBPF<br><strong>The Superpower of Linux Kernel</strong></h1>
            <div class="post-meta" style="color: #666; font-size: 0.9em; margin-bottom: 20px;">
                <span class="lang-zh">发布日期：2025-12-20</span>
                <span class="lang-en hidden">Published on: 2025-12-20</span>

                <span style="margin: 0 10px; opacity: 0.5;">|</span>

                <span class="lang-zh">最后更新：2026-01-04</span>
                <span class="lang-en hidden">Last Updated: 2026-01-04</span>
            </div>
            <p class="lang-zh">无需重启，无需修改源码，让操作系统即刻拥有全新的安全、网络与可观测能力。<br>这不仅仅是技术升级，这是基础设施的范式转移。</p>
            <p class="lang-en hidden">Instantly grant the OS new security, networking, and observability capabilities
                without restarting or modifying the source code.<br>It's not just an upgrade; it's a paradigm shift for
                infrastructure.</p>
            <div style="margin-top: 40px; text-align: center;">
                <button class="btn btn-primary lang-zh" onclick="scrollToDemo()">体验交互 Demo</button>
                <button class="btn btn-primary lang-en hidden" onclick="scrollToDemo()">Try Interactive Demo</button>
            </div>

            <div class="hero-evidence-bar">
                <div class="evidence-item">
                    <span
                        style="display: block; font-size: 1.8rem; font-weight: 800; color: var(--cisco-blue);">4X</span>
                    <span class="lang-zh"
                        style="font-size: 0.8rem; opacity: 0.8; text-transform: uppercase;">网络包处理吞吐量提升</span>
                    <span class="lang-en hidden"
                        style="font-size: 0.8rem; opacity: 0.8; text-transform: uppercase;">Networking Throughput
                        Boost</span>
                </div>
                <div class="evidence-item" style="border-left-color: var(--cisco-green);">
                    <span
                        style="display: block; font-size: 1.8rem; font-weight: 800; color: var(--cisco-green);">&lt;2%</span>
                    <span class="lang-zh" style="font-size: 0.8rem; opacity: 0.8; text-transform: uppercase;">极致传感器 CPU
                        开销</span>
                    <span class="lang-en hidden"
                        style="font-size: 0.8rem; opacity: 0.8; text-transform: uppercase;">Minimal CPU Overhead</span>
                </div>
                <div class="evidence-item" style="border-left-color: var(--cisco-orange);">
                    <span
                        style="display: block; font-size: 1.8rem; font-weight: 800; color: var(--cisco-orange);">Zero</span>
                    <span class="lang-zh"
                        style="font-size: 0.8rem; opacity: 0.8; text-transform: uppercase;">代码侵入式安全观测</span>
                    <span class="lang-en hidden"
                        style="font-size: 0.8rem; opacity: 0.8; text-transform: uppercase;">Non-intrusive
                        Observability</span>
                </div>
            </div>

            <div class="winston-callout lang-zh"
                style="max-width: 600px; margin: 40px auto 0; text-align: left; background: rgba(255,255,255,0.1); color: white; border-left-color: var(--cisco-blue);">
                <strong>核心承诺 / THE PROMISE</strong>
                阅读本文，您将掌握如何利用 eBPF 将原本黑盒的 Linux 内核变为可编程、透明且绝对安全的智能底座。本文由Rao Weibo借助Gemini完成。
            </div>
            <div class="winston-callout lang-en hidden"
                style="max-width: 600px; margin: 40px auto 0; text-align: left; background: rgba(255,255,255,0.1); color: white; border-left-color: var(--cisco-blue);">
                <strong>THE PROMISE</strong>
                By reading this, you will learn how to leverage eBPF to transform the "black box" Linux kernel into a
                programmable, transparent, and secure intelligent foundation. This blog was created by Rao Weibo through
                Gemini.
            </div>

            <div class="hero-graphic" style="margin-top: 60px;">
                <svg width="280" height="200" viewBox="0 0 200 150" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="30" y="20" width="140" height="110" rx="12" fill="rgba(255,255,255,0.05)" stroke="white"
                        stroke-width="1.5" />
                    <circle cx="100" cy="75" r="30" fill="#049FD9" fill-opacity="0.9">
                        <animate attributeName="r" values="30;34;30" dur="2s" repeatCount="indefinite" />
                        <animate attributeName="fill-opacity" values="0.9;0.5;0.9" dur="2s" repeatCount="indefinite" />
                    </circle>
                    <path d="M100 75L30 20" stroke="#6CC24A" stroke-width="2" stroke-dasharray="6 6" />
                    <path d="M100 75L170 20" stroke="#6CC24A" stroke-width="2" stroke-dasharray="6 6" />
                    <path d="M100 75L30 130" stroke="#6CC24A" stroke-width="2" stroke-dasharray="6 6" />
                    <path d="M100 75L170 130" stroke="#6CC24A" stroke-width="2" stroke-dasharray="6 6" />
                    <text x="100" y="80" text-anchor="middle" fill="white" font-size="11" font-family="sans-serif"
                        font-weight="900" letter-spacing="2">KERNEL</text>
                </svg>
            </div>
        </div>
    </section>
    <section style="background: #f4f7f9; padding: 60px 0; border-bottom: 1px solid #eef2f5;">
        <div class="container">
            <div class="winston-callout"
                style="border-left-color: var(--cisco-orange); background: white; box-shadow: var(--card-shadow); padding: 40px; border-radius: 0 12px 12px 0;">
                <strong
                    style="color: var(--cisco-orange); font-size: 0.9rem; letter-spacing: 1px; margin-bottom: 15px; display: block;">
                    <span class="lang-zh">一个典型的 SRE 深夜故事 / THE 3 AM SCENARIO</span>
                    <span class="lang-en hidden">THE 3 AM SCENARIO</span>
                </strong>
                <p class="lang-zh"
                    style="margin-top: 10px; font-style: italic; font-size: 1.15rem; line-height: 1.8; color: var(--cisco-midnight);">
                    “想象一下，凌晨三点，你的分布式集群出现不明原因的网络延迟。传统工具告诉你‘流量很大’，但无法告诉你‘哪个内核函数在丢包’。
                    在 eBPF 时代之前，你只能盲目猜测或重启系统；现在，你可以秒级注入一个探针，在不停止业务的情况下，精准定位到那行故障代码。”
                </p>
                <p class="lang-en hidden"
                    style="margin-top: 10px; font-style: italic; font-size: 1.15rem; line-height: 1.8; color: var(--cisco-midnight);">
                    "Imagine 3 AM: your cluster has mystery latency. Traditional tools say 'high traffic' but not 'which
                    kernel function is dropping packets.'
                    Before eBPF, you'd guess or reboot; now, you inject a probe in seconds to pinpoint the bug without
                    downtime."
                </p>
                <div
                    style="margin-top: 20px; border-top: 1px dashed #ddd; padding-top: 15px; font-size: 0.9rem; color: #888;">
                    <span class="lang-zh">—— 这种从“黑盒猜测”到“白盒观测”的转变，正是 eBPF 的魅力所在。</span>
                    <span class="lang-en hidden">—— This shift from 'Black-box Guessing' to 'White-box Observability' is
                        the essence of eBPF.</span>
                </div>
            </div>
        </div>
    </section>
    <!--What is eBPF-->
    <section style="background: #ffffff; padding: 60px 0 20px;">
        <h2 class="section-title lang-zh">什么是 eBPF？</h2>
        <h2 class="section-title lang-en hidden">What is eBPF?</h2>
        <div class="container">
            <div class="winston-callout"
                style="border-left: 5px solid var(--cisco-blue); background: rgba(4, 159, 217, 0.03); padding: 30px; border-radius: 8px;">
                <p class="lang-zh" style="font-size: 1.2rem; line-height: 1.8; color: var(--cisco-midnight);">
                    eBPF (Extended Berkeley Packet Filter) 是一项革命性的技术，起源于 Linux
                    内核，它可以在特权上下文中（如操作系统内核）运行沙盒程序。它用于安全有效地扩展内核的功能，而无需通过更改内核源代码或加载内核模块的方式来实现。
                </p>
                <p class="lang-en hidden" style="font-size: 1.2rem; line-height: 1.8; color: var(--cisco-midnight);">
                    eBPF (Extended Berkeley Packet Filter) is a revolutionary technology, originating in the Linux
                    kernel, that can run sandboxed programs
                    in a privileged context such as the operating system kernel. It is used to safely and efficiently
                    extend the capabilities of the kernel without requiring changing kernel source code or loading
                    kernel modules.
                </p>
            </div>
            <div
                style="margin-top: 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; opacity: 0.9;">
                <div style="padding: 15px; border-left: 2px solid var(--cisco-light-gray);">
                    <span style="font-size: 1.0rem; color: var(--cisco-blue); font-weight: bold;">1992 - cBPF</span>
                    <p style="font-size: 1.0rem; margin-top: 5px;" class="lang-zh">诞生于 Berkeley 实验室，最初仅为 tcpdump
                        提供简单的包过滤逻辑。</p>
                    <p style="font-size: 1.0rem; margin-top: 5px;" class="lang-en hidden">Born at Berkeley, initially
                        just packet filtering logic for tcpdump.</p>
                </div>
                <div style="padding: 15px; border-left: 2px solid var(--cisco-blue);">
                    <span style="font-size: 1.0rem; color: var(--cisco-blue); font-weight: bold;">2014 - eBPF
                        Revolution</span>
                    <p style="font-size: 1.0rem; margin-top: 5px;" class="lang-zh">由 Alexei Starovoitov
                        扩展指令集，使其从网络工具进化为通用的内核编程引擎。</p>
                    <p style="font-size: 1.0rem; margin-top: 5px;" class="lang-en hidden">Extended by Alexei
                        Starovoitov, evolving from a network tool to a general-purpose kernel engine.</p>
                </div>
                <div style="padding: 15px; border-left: 2px solid var(--cisco-green);">
                    <span style="font-size: 1.0rem; color: var(--cisco-green); font-weight: bold;">2025+ - Programmable
                        Base</span>
                    <p style="font-size: 1.0rem; margin-top: 5px;" class="lang-zh">成为云原生操作系统的“事实标准”，甚至跨越至 Windows
                        生态，实现全栈可编程。</p>
                    <p style="font-size: 1.0rem; margin-top: 5px;" class="lang-en hidden">The "de-facto standard" for
                        cloud-native OS, extending even to Windows ecosystems.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Analogy & Why Section -->
    <section class="container">
        <span class="golden-badge lang-zh">核心痛点 / WHY</span>
        <span class="golden-badge lang-en hidden">PAIN POINTS / WHY</span>

        <h2 class="section-title lang-zh">为什么要引入 eBPF？</h2>
        <h2 class="section-title lang-en hidden">Why eBPF?</h2>

        <div class="winston-callout lang-zh">
            <strong>核心洞察 / THE BOTTOM LINE</strong>
            eBPF 终结了“内核开发以年为单位”的历史，开启了“内核创新以秒为单位”的新纪元。
        </div>
        <div class="winston-callout lang-en hidden">
            <strong>THE BOTTOM LINE</strong>
            eBPF ends the era of "years for kernel development" and opens the era of "seconds for kernel innovation".
        </div>

        <p class="lang-zh" style="text-align: center; max-width: 850px; margin: -20px auto 40px;">Linux
            内核是现代基础架构的基石，但其作为“共享资源”的特性，导致了<strong>稳定性与创新速度</strong>之间的剧烈冲突。传统上，在内核中实现新功能面临着难以逾越的障碍：</p>
        <p class="lang-en hidden" style="text-align: center; max-width: 850px; margin: -20px auto 40px;">The Linux
            kernel is the bedrock of modern infrastructure, but its nature as a "shared resource" creates a sharp
            conflict between <strong>stability and the pace of innovation</strong>. Historically, implementing new
            features in the kernel faced insurmountable obstacles:</p>

        <div class="grid-3">
            <div class="feature-box">
                <svg viewBox="0 0 24 24">
                    <path d="M13,9V3.5L18.5,9M6,2c-1.11,0-2,0.89-2,2v16a2,2 0 0,0,2,2h12a2,2 0 0,0,2-2V8L14,2H6Z" />
                </svg>
                <h3 class="lang-zh">修改内核源码</h3>
                <h3 class="lang-en hidden">Kernel Source</h3>
                <p class="lang-zh"><strong>时间鸿沟：</strong>一个新特性从提交社区到最终进入企业发行版，往往需要 <strong>3-5
                        年</strong>。这无法满足现代云原生极速演进的需求。</p>
                <p class="lang-en hidden"><strong>The Time Gap:</strong> It takes <strong>3-5 years</strong> for a new
                    feature to move from upstream to enterprise distributions, failing modern cloud-native agility.</p>
            </div>
            <div class="feature-box">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M21,16.5C21,16.88 20.79,17.21 20.47,17.38L12.57,21.82C12.41,21.94 12.21,22 12,22C11.79,22 11.59,21.94 11.43,21.82L3.53,17.38C3.21,17.21 3,16.88 3,16.5V7.5C3,7.12 3.21,6.79 3.53,6.62L11.43,2.18C11.59,2.06 11.79,2 12,2C12.21,2 12.41,2.06 12.57,2.18L20.47,6.62C20.79,6.79 21,7.12 21,7.5V16.5Z" />
                </svg>
                <h3 class="lang-zh">内核模块 (LKM)</h3>
                <h3 class="lang-en hidden">Kernel Modules</h3>
                <p class="lang-zh"><strong>安全困境：</strong>内核模块缺乏保护边界。代码中一个小小的空指针引用就会触发 <strong>Kernel
                        Panic</strong>，导致整机甚至整个集群节点的崩溃。</p>
                <p class="lang-en hidden"><strong>The Safety Dilemma:</strong> Modules lack protection boundaries. A
                    tiny null pointer can trigger a <strong>Kernel Panic</strong>, crashing the entire host or even
                    cluster nodes.</p>
            </div>
            <div class="feature-box" style="background: #e1f5fe; border: 2px solid var(--cisco-blue);">
                <svg viewBox="0 0 24 24" style="fill: var(--cisco-blue);">
                    <path d="M12,2L4.5,20.29L5.21,21L12,18L18.79,21L19.5,20.29L12,2Z" />
                </svg>
                <h3 class="lang-zh">eBPF 革命性方案</h3>
                <h3 class="lang-en hidden">eBPF Revolution</h3>
                <p class="lang-zh"><strong>解耦与安全：</strong>通过沙盒机制在运行时动态加载程序。它提供了<strong>原生性能</strong>，同时由内核验证器保证绝不引发系统崩溃。
                </p>
                <p class="lang-en hidden"><strong>Decoupling & Safety:</strong> Dynamically loads programs via
                    sandboxing. It offers <strong>native performance</strong> guaranteed by a kernel verifier.</p>
            </div>
        </div>

        <h3 class="lang-zh"
            style="margin-top: 60px; margin-bottom: 20px; color: var(--cisco-midnight); font-size: 1.6rem; text-align: center;">
            深度对比：为什么 eBPF 是最终答案？</h3>
        <h3 class="lang-en hidden"
            style="margin-top: 60px; margin-bottom: 20px; color: var(--cisco-midnight); font-size: 1.6rem; text-align: center;">
            Deep Comparison: Why eBPF is the Ultimate Answer?</h3>

        <div class="comparison-wrapper">
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>
                            <span class="lang-zh">维度 / Dimension</span>
                            <span class="lang-en hidden">Dimension</span>
                        </th>
                        <th>
                            <span class="lang-zh">传统方式 (LKM / Upstream)</span>
                            <span class="lang-en hidden">Traditional (LKM / Upstream)</span>
                        </th>
                        <th>
                            <span class="lang-zh">eBPF 模式</span>
                            <span class="lang-en hidden">eBPF Mode</span>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="lang-zh">交付速度</span><span class="lang-en hidden">Delivery Speed</span></td>
                        <td><span class="cross-icon">✗</span> <span class="lang-zh">以“年”为单位</span><span
                                class="lang-en hidden">Years</span></td>
                        <td><span class="check-icon">✓</span> <span class="lang-zh">以“秒”为单位 (即时加载)</span><span
                                class="lang-en hidden">Seconds (Instant Load)</span></td>
                    </tr>
                    <tr>
                        <td><span class="lang-zh">安全性</span><span class="lang-en hidden">Safety</span></td>
                        <td><span class="cross-icon">✗</span> <span class="lang-zh">高风险 (Panic 隐患)</span><span
                                class="lang-en hidden">High Risk (Panic Potential)</span></td>
                        <td><span class="check-icon">✓</span> <span class="lang-zh">极高 (验证器强校验)</span><span
                                class="lang-en hidden">Extreme (Strong Verification)</span></td>
                    </tr>
                    <tr>
                        <td><span class="lang-zh">系统重启</span><span class="lang-en hidden">System Reboot</span></td>
                        <td><span class="cross-icon">✗</span> <span class="lang-zh">通常需要重启内核</span><span
                                class="lang-en hidden">Usually Required</span></td>
                        <td><span class="check-icon">✓</span> <span class="lang-zh">无需重启，热插拔</span><span
                                class="lang-en hidden">Zero Reboot (Hot-swap)</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="analogy-grid" style="margin-top: 80px;">
            <div class="card analogy-item">
                <div class="analogy-icon">
                    <svg viewBox="0 0 100 80" height="100%" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 60 L80 60" stroke="#333" stroke-width="3" />
                        <rect x="35" y="20" width="30" height="30" rx="4" fill="var(--cisco-blue)" fill-opacity="0.2"
                            stroke="var(--cisco-blue)" stroke-width="2" />
                        <path d="M50 15 V25 M45 20 H55" stroke="var(--cisco-blue)" stroke-width="2" />
                        <circle cx="20" cy="60" r="5" fill="#333" />
                        <circle cx="80" cy="60" r="5" fill="#333" />
                    </svg>
                </div>
                <span class="analogy-tag">Hot-Swapping</span>
                <h3 class="lang-zh">不停车的引擎热升级</h3>
                <h3 class="lang-en hidden">Hot-swapping Engine Upgrade</h3>
                <p class="lang-zh" style="margin-top:10px; color:#666; font-size: 0.9rem;">
                    <strong>技术本质：</strong>eBPF 实现了内核逻辑的动态载入与即时卸载，无需重新编译内核或重启系统。<br><br>
                    <strong>类比：</strong>传统内核修改像是在车间拆解引擎进行静态维修；eBPF 就像给正在赛道上疾驰的赛车实时刷写 ECU（引擎控制单元）固件，实现性能的无缝增强。
                </p>
                <p class="lang-en hidden" style="margin-top:10px; color:#666; font-size: 0.9rem;">
                    <strong>Essence:</strong> eBPF enables dynamic loading and unloading of kernel logic without
                    reboots.<br><br>
                    <strong>Analogy:</strong> Traditional mods are like shop disassembly; eBPF is like flashing ECU
                    firmware on a race car mid-track for seamless enhancement.
                </p>
            </div>
            <div class="card analogy-item">
                <div class="analogy-icon">
                    <svg viewBox="0 0 100 80" height="100%" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="40" r="30" stroke="#333" stroke-width="2" />
                        <path d="M50 40 L70 30" stroke="var(--cisco-blue)" stroke-width="3" />
                        <rect x="20" y="65" width="60" height="10" rx="2" fill="var(--cisco-blue)" fill-opacity="0.1" />
                        <circle cx="50" cy="40" r="5" fill="#333" />
                    </svg>
                </div>
                <span class="analogy-tag">Real-time Telemetry</span>
                <h3 class="lang-zh">全栈引擎遥测系统</h3>
                <h3 class="lang-en hidden">Full-stack Telemetry System</h3>
                <p class="lang-zh" style="margin-top:10px; color:#666; font-size: 0.9rem;">
                    <strong>技术本质：</strong>eBPF 能够无损地捕获内核态的细微事件，提供从网络协议栈到系统调用的全视角视图。<br><br>
                    <strong>类比：</strong>它就像是在引擎的每一个活塞、气门上安插了高频传感器。它能穿透黑暗，将复杂的运行数据转化成仪表盘上的实时指标。
                </p>
                <p class="lang-en hidden" style="margin-top:10px; color:#666; font-size: 0.9rem;">
                    <strong>Essence:</strong> eBPF captures kernel events losslessly, providing a full-stack view from
                    networking to syscalls.<br><br>
                    <strong>Analogy:</strong> Like placing high-frequency sensors on every piston, turning complex data
                    into a live telemetry dashboard.
                </p>
            </div>
            <div class="card analogy-item">
                <div class="analogy-icon">
                    <svg viewBox="0 0 100 80" height="100%" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="25" y="15" width="50" height="50" rx="25" fill="rgba(108, 194, 74, 0.1)"
                            stroke="var(--cisco-green)" stroke-width="2" />
                        <path d="M40 40 L48 48 L60 35" stroke="var(--cisco-green)" stroke-width="4"
                            stroke-linecap="round" />
                    </svg>
                </div>
                <span class="analogy-tag">Virtual Simulation</span>
                <h3 class="lang-zh">智能驾驶防爆系统</h3>
                <h3 class="lang-en hidden">Intelligent Protection System</h3>
                <p class="lang-zh" style="margin-top:10px; color:#666; font-size: 0.9rem;">
                    <strong>技术本质：</strong>通过验证器（Verifier）进行静态指令分析，严格限制内存访问，确保程序绝不破坏内核稳定性。<br><br>
                    <strong>类比：</strong>eBPF 代码就像一套自动驾驶指令。在下发给引擎前，系统会进行“虚拟试驾”，确保这些指令不会导致引擎爆缸或系统失控。
                </p>
                <p class="lang-en hidden" style="margin-top:10px; color:#666; font-size: 0.9rem;">
                    <strong>Essence:</strong> The Verifier analyzes instructions statically to ensure kernel
                    stability.<br><br>
                    <strong>Analogy:</strong> eBPF code is like autonomous driving commands. A "virtual test drive"
                    ensures these commands won't blow the engine or lose control.
                </p>
            </div>
        </div>
    </section>

    <!-- 基础概念与心理模型 -->
    <section style="background: #ffffff; border-top: 1px solid #eee;">
        <div class="container">
            <span class="golden-badge lang-zh">基础认知 / FOUNDATION</span>
            <span class="golden-badge lang-en hidden">CORE CONCEPTS / FOUNDATION</span>

            <h2 class="section-title lang-zh">内核与用户态：Linux 的安全边界</h2>
            <h2 class="section-title lang-en hidden">Kernel & User Space: Linux's Security Boundary</h2>

            <div class="winston-callout lang-zh">
                <strong>核心洞察 / THE BOTTOM LINE</strong>
                理解 eBPF 的前提是意识到：Linux 内核是一个被严格保护的“禁区”，而 eBPF 是目前唯一能安全进入该禁区的通行证。
            </div>
            <div class="winston-callout lang-en hidden">
                <strong>THE BOTTOM LINE</strong>
                The premise of understanding eBPF is realizing that the Linux kernel is a strictly protected "restricted
                zone", and eBPF is currently the only pass to safely enter it.
            </div>

            <div class="symbol-container">
                <h4 class="lang-zh" style="margin-bottom: 30px; color: var(--cisco-midnight);">eBPF 权限沙盒模型：安全与力量的平衡</h4>
                <h4 class="lang-en hidden" style="margin-bottom: 30px; color: var(--cisco-midnight);">eBPF Privilege
                    Sandbox Model: Balance of Safety & Power</h4>

                <svg width="100%" max-width="500" height="300" viewBox="0 0 500 300" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <circle cx="250" cy="150" r="130" stroke="#ddd" stroke-width="2" stroke-dasharray="5 5" />
                    <text x="250" y="45" text-anchor="middle" fill="#999" font-size="12">
                        <tspan class="lang-zh">USER SPACE (受限区域)</tspan>
                        <tspan class="lang-en hidden">USER SPACE (Restricted Zone)</tspan>
                    </text>

                    <rect x="50" y="100" width="400" height="180" rx="10" fill="rgba(29, 39, 41, 0.05)" />
                    <text x="250" y="270" text-anchor="middle" fill="#1D2729" font-weight="bold">
                        <tspan class="lang-zh">KERNEL SPACE (高权禁区)</tspan>
                        <tspan class="lang-en hidden">KERNEL SPACE (Privileged Zone)</tspan>
                    </text>

                    <rect x="150" y="120" width="200" height="100" rx="8" fill="white" stroke="var(--cisco-blue)"
                        stroke-width="3" />
                    <text x="250" y="155" text-anchor="middle" fill="var(--cisco-blue)" font-weight="900"
                        font-size="16">eBPF SANDBOX</text>
                    <text x="250" y="180" text-anchor="middle" fill="#666" font-size="11">
                        <tspan class="lang-zh">Verifier 强校验 | JIT 加速</tspan>
                        <tspan class="lang-en hidden">Verifier Check | JIT Acceleration</tspan>
                    </text>

                    <path d="M250 80 V120" stroke="var(--cisco-red)" stroke-width="2" marker-end="url(#arrow-red)" />
                    <circle cx="250" cy="100" r="15" fill="var(--cisco-red)" />
                    <text x="275" y="105" fill="var(--cisco-red)" font-size="10" font-weight="bold">
                        <tspan class="lang-zh">VERIFIER (安全闸门)</tspan>
                        <tspan class="lang-en hidden">VERIFIER (Security Gate)</tspan>
                    </text>

                    <defs>
                        <marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
                            <path d="M0 0 L10 5 L0 10 Z" fill="var(--cisco-red)" />
                        </marker>
                    </defs>
                </svg>
                <p class="lang-zh" style="font-size: 0.9rem; color: #666; margin-top: 20px;">eBPF
                    提供了一个“受控的特权通道”，让代码既能触达核心数据，又不会破坏引擎稳定性。</p>
                <p class="lang-en hidden" style="font-size: 0.9rem; color: #666; margin-top: 20px;">eBPF provides a
                    "controlled privileged channel" that allows code to access core data without compromising engine
                    stability.</p>
            </div>

            <div class="detail-grid">
                <div class="card" style="border-top-color: var(--cisco-midnight);">
                    <h4 class="lang-zh">Linux Kernel (操作系统的核心引擎)</h4>
                    <h4 class="lang-en hidden">Linux Kernel (The OS Core Engine)</h4>
                    <p class="lang-zh" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>定义：</strong>OS 的核心子系统，负责管理硬件、内存分配、进程调度及网络协议栈。它是具备最高特权的软件层。<br><br>
                        <strong>类比：</strong>它是车辆的动力核心。直接修改它需要“停机熄火”，而 eBPF 则为这个引擎提供了无需关盖即可插入的“数字化控制插件”。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>Definition:</strong> The core subsystem of the OS, responsible for hardware, memory,
                        scheduling, and networking. It is the most privileged software layer.<br><br>
                        <strong>Analogy:</strong> It's the vehicle's engine. Modifying it directly requires "shutting
                        down," while eBPF provides "digital control plug-ins" inserted without opening the hood.
                    </p>
                </div>
                <div class="card" style="border-top-color: var(--cisco-midnight);">
                    <h4 class="lang-zh">用户态 (User Space)</h4>
                    <h4 class="lang-en hidden">User Space</h4>
                    <p class="lang-zh" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>定义：</strong>这是一个非特权层 (Unprivileged Layer)。运行在此空间的应用（如 Web
                        浏览器、数据库）被剥夺了直接操作硬件的权力。这种限制保护了系统的稳定性，应用必须通过系统调用（System Call）向内核“申请”资源<br><br>
                        <strong>类比：</strong>用户空间是安全的驾驶舱，乘客（应用）不能碰引擎；内核空间是布满管线的引擎室。eBPF 实现了在驾驶舱内，安全地将指令送入引擎室。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>Definition:</strong> This is an Unprivileged Layer. Applications running here (e.g.,
                        browsers, databases) are stripped of the power to operate hardware directly.This restriction
                        protects system stability. Apps must "apply" for resources from the kernel via System
                        Calls.<br><br>
                        <strong>Analogy:</strong> User space is the cockpit where passengers (apps) can't touch the
                        engine; kernel space is the engine room. eBPF safely sends commands into the engine room from
                        the cockpit.
                    </p>
                </div>
                <div class="card" style="border-top-color: var(--cisco-red);">
                    <h4 class="lang-zh">内核模块 (LKM) 的安全困境</h4>
                    <h4 class="lang-en hidden">The Security Dilemma of Kernel Modules (LKM)</h4>
                    <p class="lang-zh" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>定义：</strong>Loadable Kernel Module 是一种在运行时加载到内核空间的二进制对象，它与核心引擎共享完全相同的内存寻址空间。<br><br>
                        <strong>风险本质：</strong>由于缺乏指令级校验，LKM 的错误会直接引发 <strong>Kernel
                            Panic</strong>。这就像在引擎运转时尝试手动更换活塞，一旦出错即是毁坏性的全机停摆。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>Definition:</strong> Binary objects loaded into kernel space at runtime, sharing the
                        same memory address space as the core engine.<br><br>
                        <strong>Risk:</strong> Errors in LKM trigger a <strong>Kernel Panic</strong>. It's like manually
                        replacing a piston while the engine is running—one error causes a catastrophic shutdown.
                    </p>
                </div>
                <div class="card" style="border-top-color: var(--cisco-orange);">
                    <h4 class="lang-zh">System Call (系统门铃)</h4>
                    <h4 class="lang-en hidden">System Call (The System Doorbell)</h4>
                    <p class="lang-zh" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>定义：</strong>用户态程序请求内核服务的标准编程接口。当应用需要执行读取/写入文件、发送/接收网络流量、分配内存或协调并发进程等操作时，必须通过系统调用接口请求内核代其执行。它是跨越权限边界的唯一合法通道，这种设计防止了恶意或错误的程序直接破坏硬件或窃取其他应用的内存数据。<br><br>
                        <strong>类比：</strong>它是驾驶舱内的各种踏板与旋钮。当你想加速（读取文件）或转向（发送包）时，必须通过这些标准接口发出请求。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>Definition:</strong> The system call interface is the standard programming interface for
                        user-mode programs to request kernel services. When an application needs to perform operations
                        such as reading/writing files, sending/receiving network traffic, allocating memory, or
                        coordinating concurrent processes, it must request the kernel to perform these operations on its
                        behalf through the system call interface. It is the only legitimate channel across permission
                        boundaries, and this design prevents malicious or faulty programs from directly damaging
                        hardware or stealing memory data from other applications.<br><br>
                        <strong>Analogy:</strong> These are the pedals and knobs in the cockpit. To accelerate (read
                        files) or steer (send packets), you must use these standard interfaces.
                    </p>
                </div>
                <div class="card" style="border-top-color: var(--cisco-orange);">
                    <h4 class="lang-zh">Context Switch (性能杀手：上下文切换)</h4>
                    <h4 class="lang-en hidden">Context Switch (The Performance Killer)</h4>
                    <p class="lang-zh" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>定义：</strong>CPU 从执行用户态程序切换到内核态的过程。这需要保存寄存器状态，并导致 CPU 高速缓存（L1/L2 Cache）和 TLB 失效。<br><br>
                        <strong>类比：</strong>这就像赛车为了接受监测必须驶入维修站。<strong>“进站保存现场”</strong>和<strong>“出站重新加速”</strong>的时间，往往比监测动作本身还要长。eBPF
                        让监测逻辑直接在赛道（内核）上执行，消除了这种昂贵的切换成本。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>Definition:</strong> The CPU switching from user-mode to kernel-mode, requiring state
                        saving and causing costly CPU Cache/TLB flushes.<br><br>
                        <strong>Analogy:</strong> Like a race car pulling into the "pit stop" for diagnostics. The
                        <strong>overhead of stopping and restarting</strong> is often greater than the diagnostic
                        itself. eBPF allows logic to run directly on the track (kernel), eliminating this switch cost.
                    </p>
                    <div class="insight-card"
                        style="margin-top: auto; font-size: 0.85rem; padding: 10px; background: rgba(255, 158, 27, 0.02);">
                        <span class="lang-zh">⚡ <strong>性能真谛：</strong> eBPF 代码在内核执行，无需上下文切换，因此实现了极致的高吞吐与低延迟。</span>
                        <span class="lang-en hidden">⚡ <strong>Performance Truth:</strong> eBPF runs in-kernel with zero
                            context switching, achieving extreme throughput and low latency.</span>
                    </div>
                </div>
                <div class="card" style="border-top-color: var(--cisco-blue);">
                    <h4 class="lang-zh">eBPF 沙盒：虚拟化保护层</h4>
                    <h4 class="lang-en hidden">eBPF Sandbox: Virtualized Protection Layer</h4>
                    <p class="lang-zh" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>定义：</strong>eBPF 程序运行在内核态虚拟机中，通过 <strong>Verifier（验证器）</strong> 对字节码进行<strong>DAG
                            (Directed Acyclic Graph，有向无环图)</strong>
                        分析，确保内存安全且不含死循环。<strong>eBPF虚拟机</strong>驻留在内核，专门用于执行 eBPF
                        指令集。它为程序提供了一个受限的运行环境，确保其在高性能执行的同时，不会对内核其他部分产生副作用。<strong>字节码</strong>是eBPF程序的编码形式，由eBPF虚拟机负责执行。<br>
                        <strong>类比：</strong>它像是一套智能防错系统，在任何不安全的代码下发给引擎前将其拦截在“虚拟试车台”中，确保核心底座的绝对稳定。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>Definition:</strong> eBPF programs run in a kernel-space VM, analyzed by a
                        <strong>Verifier</strong> via <strong>DAG (Directed Acyclic Graph)</strong> to ensure memory
                        safety and no infinite loops.<br>The eBPF virtual machine resides in the kernel and is dedicated
                        to executing the eBPF instruction set. <strong>eBPF Virtual Machine</strong> provides a
                        restricted runtime environment for programs, ensuring that they can execute at high performance
                        without causing side effects on other parts of the kernel. <strong>eBPF Bytecode</strong> is the
                        encoded form of eBPF programs, executed by the eBPF VM.<br>
                        <strong>Analogy:</strong> Like an intelligent error-prevention system that intercepts unsafe
                        code on a "virtual test stand" before reaching the engine.
                    </p>
                </div>
                <div class="card" style="border-top-color: var(--cisco-green);">
                    <h4 class="lang-zh">Hook (内核检查站)</h4>
                    <h4 class="lang-en hidden">Hook (Kernel Checkpoints)</h4>
                    <p class="lang-zh" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>定义：</strong>Hook 是一种事件驱动的触发机制，它在内核关键处理路径（如网络入站、进程创建）中预置了探测桩点。<br><br>
                        <strong>类比：</strong>它是高速公路网上的“感应检查站”。当车辆（数据流）经过特定卡口时，检查站瞬间激活，驻点检查员（eBPF 程序）在不停车的情况下完成审计或拦截。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>Definition:</strong> An event-driven trigger mechanism with pre-placed probe points in
                        key kernel processing paths (e.g., ingress, process creation).<br><br>
                        <strong>Analogy:</strong> Like "sensory checkpoints" on a highway gate. As data flows through,
                        the checkpoint activates instantly for non-stop auditing or interception.
                    </p>
                </div>
                <div class="card"
                    style="border-top-color: var(--cisco-green); background: rgba(108, 194, 74, 0.02); display: flex; flex-direction: column; justify-content: center;">
                    <h4 class="lang-zh" style="color: var(--cisco-green); margin-bottom: 12px;">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"
                            style="vertical-align: middle; margin-right: 5px;">
                            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />
                        </svg>
                        内核级“热插拔”真相
                    </h4>
                    <h4 class="lang-en hidden" style="color: var(--cisco-green); margin-bottom: 12px;">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"
                            style="vertical-align: middle; margin-right: 5px;">
                            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />
                        </svg>
                        The Truth of Kernel-level "Hot-swapping"
                    </h4>

                    <p class="lang-zh" style="font-size: 0.95rem; line-height: 1.6; color: #444;">
                        Hook 的物理本质是内核预留的<strong>“函数指针插槽”</strong>，eBPF 通过 Hook 机制，实质上是在这些插槽中动态地填入或更换指向 eBPF 程序的指针。
                        <br><br>
                        正因为这些桩点是<strong>“预置”</strong>的，eBPF
                        才能在不修改内核源码、不重新编译的情况下，像<strong>“乐高积木”</strong>一样动态地插拔功能，让操作系统拥有了即时的防御进化能力。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.95rem; line-height: 1.6; color: #444;">
                        The physical essence of a Hook is a <strong>"function pointer slot"</strong> reserved by the
                        kernel, eBPF uses a hook mechanism to dynamically fill or replace pointers to eBPF programs in
                        these slots.
                        <br><br>
                        Because these probe points are <strong>"pre-defined,"</strong> eBPF can dynamically plug and
                        unplug functions like <strong>"Lego bricks"</strong> without modifying kernel source code or
                        recompiling, granting the OS instant defensive evolution capabilities.
                    </p>

                    <div
                        style="margin-top: 15px; border-top: 1px dashed rgba(108, 194, 74, 0.3); padding-top: 10px; font-size: 0.8rem; color: var(--cisco-green); font-weight: 600;">
                        <span class="lang-zh">#逻辑解耦 #动态插桩 #零重启</span>
                        <span class="lang-en hidden">#LogicalDecoupling #DynamicInstrumentation #ZeroReboot</span>
                    </div>
                </div>
                <div class="card" style="border-top-color: var(--cisco-red);">
                    <h4 class="lang-zh">内核权限与崩溃豁免 (Crash Immunity)</h4>
                    <h4 class="lang-en hidden">Kernel Privilege & Crash Immunity</h4>
                    <p class="lang-zh" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>核心逻辑：</strong>eBPF 是目前唯一能让安全工具既拥有内核级权限，又具备<strong>崩溃豁免权</strong>的方案。<br><br>
                        <strong>运行差异：</strong>传统方案（LKM）是“直接运行二进制”，一旦出错即刻导致全机 Panic；而 eBPF
                        是<strong>“通过安全法院（Verifier）审判后再执行”</strong>，它在代码运行前就排除了所有可能导致崩溃的风险。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.95rem; margin-top: 10px;">
                        <strong>Core Logic:</strong> eBPF is currently the only solution that grants security tools
                        kernel-level privilege with <strong>crash immunity</strong>.<br><br>
                        <strong>Execution Difference:</strong> Traditional LKMs "run raw binaries," where one error
                        triggers a System Panic. eBPF <strong>"executes only after trial by the Safety Court
                            (Verifier),"</strong> eliminating crash risks before a single line runs.
                    </p>
                </div>
            </div>
            <div style="margin-top: 50px; text-align: center;">
                <div class="logic-connector" style="height: 60px; margin-bottom: 30px;"></div>

                <div class="lang-zh" style="max-width: 900px; margin: 0 auto; padding: 0 20px;">
                    <h3 style="color: var(--cisco-midnight); font-size: 1.8rem; margin-bottom: 20px; font-weight: 800;">
                        操作系统即刻赋能
                    </h3>
                    <p style="font-size: 1.15rem; line-height: 1.8; color: #444; font-weight: 500;">
                        得益于上述机制，eBPF 实现了<span
                            style="color: var(--cisco-blue); font-weight: 700;">“不重启、不改码”</span>的革命：它让操作系统能够即刻拥有全新的安全、网络与可观测能力，将基础设施的演进速度从<span
                            style="color: var(--cisco-red); font-weight: 700;">“以年为单位”</span>提升到了<span
                            style="color: var(--cisco-green); font-weight: 700;">“以秒为单位”</span>。
                    </p>
                </div>

                <div class="lang-en hidden" style="max-width: 900px; margin: 0 auto; padding: 0 20px;">
                    <h3 style="color: var(--cisco-midnight); font-size: 1.8rem; margin-bottom: 20px; font-weight: 800;">
                        Instant OS Empowerment
                    </h3>
                    <p style="font-size: 1.15rem; line-height: 1.8; color: #444; font-weight: 500;">
                        Thanks to these mechanisms, eBPF revolutionizes IT with <span
                            style="color: var(--cisco-blue); font-weight: 700;">"Zero Reboot, Zero Source
                            Change"</span>: it grants the OS instant security, networking, and observability,
                        accelerating infrastructure evolution from <span
                            style="color: var(--cisco-red); font-weight: 700;">years</span> to <span
                            style="color: var(--cisco-green); font-weight: 700;">seconds</span>.
                    </p>
                </div>
            </div>
            <div class="insight-card" style="margin-top: 40px; border-left-color: var(--cisco-orange);">
                <span class="lang-zh">
                    <strong>提示：</strong> 为什么我们说 eBPF 是“数字化控制插件”？<br>
                    传统的 LKM 像是直接改动引擎的齿轮咬合；而 eBPF 是在引擎内部 definition 了一套“虚拟控制链路”。虽然它是软件代码，但它直接控制 CPU
                    寄存器和网卡中断，其执行逻辑在物理层面上与原生内核函数具有<strong>同等的原子性与确定性</strong>。
                </span>
                <span class="lang-en hidden">
                    <strong>Hints:</strong> Why do we call eBPF a "Digital Control Plug-in"?<br>
                    Traditional LKM is like altering gears directly; eBPF defines a "virtual control circuit" inside the
                    engine. Though software, it controls CPU registers and interrupts, making logic as <strong>atomic
                        and deterministic</strong> as native functions.
                </span>
            </div>

            <h2 class="section-title lang-zh" style="margin-top: 80px;">心理模型：为什么把 eBPF 类比成 JavaScript？</h2>
            <h2 class="section-title lang-en hidden" style="margin-top: 80px;">Mental Model: eBPF as the JS of Kernel
            </h2>

            <div class="pillars-grid">
                <div class="feature-card" style="border-top-color: var(--cisco-midnight);">
                    <div class="feature-icon-box" style="background: rgba(29, 39, 41, 0.1);">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--cisco-midnight)"
                            stroke-width="2">
                            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />
                        </svg>
                    </div>
                    <h3 class="lang-zh">事件驱动 (Event-Driven)</h3>
                    <h3 class="lang-en hidden">Event-Driven</h3>
                    <p class="lang-zh">如同 JS 响应点击事件，eBPF 程序由内核钩子（Hooks）触发。当系统调用发生、网络包到达或函数进入时，相应的 eBPF 程序就会被精准激活并执行。</p>
                    <p class="lang-en hidden">Like JS responding to clicks, eBPF is triggered by kernel hooks. When
                        syscalls occur or packets arrive, eBPF programs activate and execute precisely.</p>
                </div>
                <div class="feature-card" style="border-top-color: var(--cisco-blue);">
                    <div class="feature-icon-box" style="background: rgba(4, 159, 217, 0.1);">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--cisco-blue)"
                            stroke-width="2">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                            <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                        </svg>
                    </div>
                    <h3 class="lang-zh">沙盒运行 (Sandboxed)</h3>
                    <h3 class="lang-en hidden">Sandboxed</h3>
                    <p class="lang-zh">正如浏览器确保 JS 无法直接危害您的电脑，eBPF 在加载前必须通过“验证器”的严审，确保代码绝对安全、不含死循环且不非法越界访问，为内核提供基石般的保障。
                    </p>
                    <p class="lang-en hidden">As browsers shield PCs from JS, eBPF must pass Verifier audits to ensure
                        code is safe, loop-free, and lacks illegal access, securing the kernel core.</p>
                </div>
                <div class="feature-card" style="border-top-color: var(--cisco-green);">
                    <div class="feature-icon-box" style="background: rgba(108, 194, 74, 0.1);">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--cisco-green)"
                            stroke-width="2">
                            <path
                                d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" />
                        </svg>
                    </div>
                    <h3 class="lang-zh">动态扩展 (Dynamic Extension)</h3>
                    <h3 class="lang-en hidden">Dynamic Extension</h3>
                    <p class="lang-zh">JS 让静态网页变全功能 App，eBPF 让静态内核变可编程底座。开发者可以实时为运行中的内核热加载新功能，将基础设施的演进周期从数年缩短至数秒。</p>
                    <p class="lang-en hidden">JS turns static pages into apps; eBPF turns static kernels into
                        programmable platforms. Hot-load new features instantly, cutting evolution from years to
                        seconds.</p>
                </div>
            </div>

            <div class="analogy-showcase">
                <div class="browser-window">
                    <div class="browser-bar">
                        <div class="dot-ui"></div><div class="dot-ui"></div><div class="dot-ui"></div>
                        <span style="font-size: 11px; color: #999; margin-left: 10px;">static_kernel.html</span>
                    </div>
                    <div class="preview-content" style="font-family: serif; color: #333;">
                        <h3 style="margin-bottom: 10px;">Traditional Linux Kernel</h3>
                        <p>System status: Running</p>
                        <p>Policy: Static (Read Only)</p>
                        <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">
                        <p style="font-size: 0.85rem; color: #999;">功能在编译时固化，无法在不重启的情况下动态改变运行逻辑。</p>
                    </div>
                </div>

                <div class="browser-window" id="ebpf-browser">
                    <div class="browser-bar" id="ebpf-nav" style="transition: all 0.4s;">
                        <div class="dot-ui" style="background: #ff5f56;"></div>
                        <div class="dot-ui" style="background: #ffbd2e;"></div>
                        <div class="dot-ui" style="background: #27c93f;"></div>
                        <span id="ebpf-url-text" style="font-size: 11px; color: #999; margin-left: 10px;">programmable_kernel.html</span>
                    </div>
                    <div class="preview-content" id="ebpf-display-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;">
                        
                        <div id="btn-container">
                            <p class="lang-zh" style="font-size: 0.95rem; color: #666; margin-bottom: 15px;">当前内核为静态黑盒，点击点亮 eBPF 超能力。</p>
                            <p class="lang-en hidden" style="font-size: 0.95rem; color: #666; margin-bottom: 15px;">Kernel is a black box. Click to ignite eBPF superpower.</p>
                            <button class="btn-ignite" onclick="igniteTypewriter()">
                                <svg viewBox="0 0 24 24"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
                                <span class="lang-zh">点亮内核编程能力</span>
                                <span class="lang-en hidden">Ignite Programmability</span>
                            </button>
                        </div>

                        <div id="typewriter-area" class="hidden typewriter-box" style="text-align: left; width: 100%;">
                            <h4 style="color: var(--cisco-midnight); margin-bottom: 15px;">eBPF Runtime Active</h4>
                            <div style="min-height: 1.6em;">
                                <span id="tw-zh" class="typewriter-text typewriter-cursor"></span>
                                <span id="tw-en" class="typewriter-text typewriter-cursor hidden"></span>
                            </div>
                            <div style="background: rgba(108, 194, 74, 0.1); border-left: 4px solid var(--cisco-green); padding: 10px; margin-top: 20px; font-size: 0.85rem; color: var(--cisco-green);">
                                ✔ 验证器通过 | ✔ JIT 编译成功 | ✔ 逻辑已注入 Hook
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="winston-callout lang-zh"
                style="margin-top: 60px; border-left-color: var(--cisco-orange); background: rgba(255, 158, 27, 0.05);">
                <strong>架构逻辑桥梁 / THE ARCHITECTURAL BRIDGE</strong>
                既然我们理解了“不停车升级引擎”的概念，那么在 Linux 的二进制世界里，这一切是如何实现的？接下来的术语百科将为您揭开支撑这套“数字化控制插件”的底层硬核组件。
            </div>
            <div class="winston-callout lang-en hidden"
                style="margin-top: 60px; border-left-color: var(--cisco-orange); background: rgba(255, 158, 27, 0.05);">
                <strong>THE ARCHITECTURAL BRIDGE</strong>
                Since we understand "upgrading engines without stopping," how is this realized in Linux's binary world?
                The following dictionary reveals the hardcore components of this "Digital Control Plug-in."
            </div>
        </div>
    </section>

    <!-- Terminology Section -->
    <section style="background: #fdfdfd; border-top: 1px solid #eee;">
        <div class="container">
            <span class="golden-badge lang-zh">术语介绍 / KNOWLEDGE BASE</span>
            <span class="golden-badge lang-en hidden">THE DICTIONARY / KNOWLEDGE BASE</span>

            <h2 class="section-title lang-zh">核心术语</h2>
            <h2 class="section-title lang-en hidden">Core Dictionary</h2>

            <div class="winston-callout">
                <strong>
                    <span class="lang-zh">阅读指引 / ROADMAP</span>
                    <span class="lang-en hidden">READING GUIDE / ROADMAP</span>
                </strong>
                <p class="lang-zh" style="margin-top: 10px; font-size: 1.05rem; line-height: 1.8;">
                    接下来的“核心术语”并不是孤立的知识点。它们分别对应 eBPF 程序在 <strong>编译、验证、加载、执行、通信、卸载</strong>
                    等不同生命周期阶段中所扮演的关键角色。建议将它们视为一条时间轴上的“功能站点”，而不是独立概念。
                </p>
                <p class="lang-en hidden" style="margin-top: 10px; font-size: 1.05rem; line-height: 1.8;">
                    The following "Core Dictionary" terms are not isolated. They represent the critical roles played
                    during the eBPF program's lifecycle: <strong>Compile, Verify, Load, Execute, Communicate, and
                        Uninstall</strong>. View them as "functional stations" along a timeline.
                </p>
            </div>

            <div class="term-group">
                <h3 class="term-group-title lang-zh">1. 诞生与适配</h3>
                <h3 class="term-group-title lang-en hidden">1. Birth & Adaptation</h3>
                <div class="term-grid">
                    <div class="term-card">
                        <h4 class="lang-zh">BTF (BPF Type Format)</h4>
                        <h4 class="lang-en hidden">BTF (BPF Type Format)</h4>
                        <p class="lang-zh">一种元数据格式，记录了内核数据结构的完整定义。它是 eBPF 程序能够理解内核“内部对话”的翻译手册，也是实现 CO-RE 的基础。</p>
                        <p class="lang-en hidden">A metadata format that records the complete definition of kernel data
                            structures. It serves as the translation manual for eBPF programs to understand internal
                            kernel "dialogues" and is the foundation for CO-RE.</p>
                        <div class="insight-card"
                            style="margin: 10px 0 0; font-size: 0.85rem; border-left: 2px solid var(--cisco-midnight); background: rgba(13, 39, 77, 0.03);">
                            <span class="lang-zh"><strong>自描述能力：</strong> BTF 让内核变得“自描述”。它不仅压缩了调试信息（比 DWARF 小 100 倍），还让
                                eBPF 程序在运行时拥有了<strong>“X光透视”</strong>内核结构体的能力。</span>
                            <span class="lang-en hidden"><strong>Self-Describing Power:</strong> BTF makes the kernel
                                "self-describing." It compresses debug info (100x smaller than DWARF) and grants eBPF
                                programs <strong>"X-ray vision"</strong> into kernel structures at runtime.</span>
                        </div>
                    </div>
                    <div class="term-card">
                        <h4 class="lang-zh">CO-RE (Compile Once – Run Everywhere)</h4>
                        <h4 class="lang-en hidden">CO-RE (Compile Once – Run Everywhere)</h4>
                        <p class="lang-zh">eBPF 的“工业化”关键。通过 BTF 记录内核类型信息，允许程序在不同的 Linux 内核版本之间无缝迁移，解决了“一个版本编译一次”的痛点。</p>
                        <p class="lang-en hidden">The key to eBPF's "industrialization." By using BTF to record kernel
                            type information, it allows programs to migrate seamlessly across different Linux kernel
                            versions, solving the pain point of recompiling for every version.</p>
                        <div class="insight-card"
                            style="margin: 10px 0 0; font-size: 0.85rem; border-left: 2px solid var(--cisco-green); background: rgba(108, 194, 74, 0.03);">
                            <span class="lang-zh"><strong>万能适配器：</strong> 类似于电源转换头，CO-RE 允许 eBPF
                                程序自动感知目标内核的数据结构偏移，无需重新编译即可适配从 4.x 到 6.x 的各种发行版内核。</span>
                            <span class="lang-en hidden"><strong>Universal Adapter:</strong> Similar to a power
                                converter, CO-RE allows eBPF programs to automatically sense data structure offsets in
                                the target kernel, adapting to various kernel versions (4.x to 6.x) without
                                recompilation.</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="term-group">
                <h3 class="term-group-title lang-zh">2. 准入与安全</h3>
                <h3 class="term-group-title lang-en hidden">2. Access & Safety</h3>
                <div class="term-grid">
                    <div class="term-card" style="border-top-color: var(--cisco-midnight);">
                        <h4 class="lang-zh">bpf() 系统调用与 Loader</h4>
                        <h4 class="lang-en hidden">bpf() Syscall & Loader</h4>
                        <p class="lang-zh"><strong>定义：</strong> 用户态与内核交互的唯一入口。加载程序、创建 Map 全需通过此接口。<strong>Loader (如
                                bpftool)</strong> 则是该接口的首席操作员，负责将字节码“泵入”内核并维护其生命周期。</p>
                        <p class="lang-en hidden"><strong>Definition:</strong> The sole entry for userspace-kernel
                            interaction. <strong>Loader (e.g., bpftool)</strong> acts as the primary operator, pumping
                            bytecode into the kernel and managing its lifecycle via this interface.</p>
                        <div class="insight-card"
                            style="margin: 10px 0 0; font-size: 0.85rem; border-left: 2px solid var(--cisco-orange); background: rgba(255, 158, 27, 0.05);">
                            <span class="lang-zh"><strong>架构师笔记：</strong> bpftool
                                是安全专家的“瑞士军刀”，它让原本隐形的内核程序变得可列举、可分析、可调试。</span>
                            <span class="lang-en hidden"><strong>Architect Note:</strong> bpftool is the "Swiss Army
                                Knife" for security experts, making invisible kernel programs listable and
                                debuggable.</span>
                        </div>
                    </div>
                    <div class="term-card">
                        <h4 class="lang-zh">Verifier (验证器)</h4>
                        <h4 class="lang-en hidden">Verifier (Validator)</h4>
                        <p class="lang-zh">eBPF 的“安全闸门”。它通过模拟执行来分析代码的状态机，确保程序没有死循环、不访问越界内存、不破坏内核完整性，是 eBPF 安全性的终极保障。</p>
                        <p class="lang-en hidden">The "security gate" of eBPF. It analyzes the code's state machine
                            through simulated execution to ensure the program has no infinite loops, doesn't access
                            out-of-bounds memory, and doesn't compromise kernel integrity, providing the ultimate
                            guarantee for eBPF safety.</p>
                        <div class="insight-card"
                            style="margin: 10px 0 0; font-size: 0.85rem; border-left: 2px solid var(--cisco-red); background: rgba(226, 35, 26, 0.02);">
                            <span class="lang-zh">
                                <strong>核心原理：</strong> 验证器通过<strong>深度优先搜索 (DFS)</strong>
                                遍历所有可能的执行路径，追踪每个寄存器的状态、类型及边界，防止任何内存非法偏移。
                            </span>
                            <span class="lang-en hidden">
                                <strong>Core Principle:</strong> The Verifier uses <strong>DFS</strong> to traverse all
                                paths, tracking register states, types, and bounds to prevent any illegal memory
                                offsets.
                            </span>
                            <span class="lang-zh">
                                <strong>数学级安全证明：</strong> 验证器不仅检查逻辑，还会对每个 <strong>寄存器 (Register)</strong>
                                的状态空间进行遍历。它能从数学上证明程序不会发生 4 字节以上的越界访问，从根本上杜绝了内存溢出。
                            </span>
                            <span class="lang-en hidden">
                                <strong>Mathematical Safety Proof:</strong> The verifier traverses the state space of
                                every <strong>register</strong>. It mathematically proves no out-of-bounds access beyond
                                4 bytes, fundamentally eliminating memory overflows.
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="term-group">
                <h3 class="term-group-title lang-zh">3. 执行加速</h3>
                <h3 class="term-group-title lang-en hidden">3. Acceleration</h3>
                <div class="term-grid">
                    <div class="term-card">
                        <h4 class="lang-zh">JIT (Just-In-Time)</h4>
                        <h4 class="lang-en hidden">JIT (Just-In-Time)</h4>
                        <p class="lang-zh">即时编译器，是 eBPF 性能体系中的核心加速引擎。它在程序成功通过 Verifier 验证后，于加载阶段将平台无关的 eBPF 字节码即时编译为当前
                            CPU 架构的原生机器指令（如 x86-64、ARM64）。这一过程绕开了解释执行带来的额外开销，使 eBPF
                            程序在内核中以近乎静态编译内核代码的速度运行，满足对低延迟和高吞吐的严苛要求。
                        </p>
                        <p class="lang-en hidden">Just-In-Time compiler. It is the accelerator for eBPF
                            performance.After a program successfully passes Verifier verification, it compiles
                            platform-independent eBPF bytecode into native machine instructions for the current CPU
                            architecture (such as x86-64, ARM64) during the loading phase. This process bypasses the
                            overhead of interpreted execution, allowing eBPF programs to run in the kernel at
                            near-static compilation speeds, meeting stringent requirements for low latency and high
                            throughput.</p>
                        <div class="insight-card"
                            style="margin: 10px 0 0; font-size: 0.85rem; border-left: 2px solid var(--cisco-blue); background: rgba(4, 159, 217, 0.03);">
                            <span class="lang-zh"><strong>零损耗映射：</strong> JIT
                                的强大在于它将虚拟寄存器（R1-R5）<strong>直接映射</strong>到物理 CPU 寄存器（如 x86 的 rdi,
                                rsi），实现了代码在内核中的“零开销”原生执行。</span>
                            <span class="lang-en hidden"><strong>Zero-Overhead Mapping:</strong> The power of JIT lies
                                in its <strong>direct mapping</strong> of virtual registers (R1-R5) to physical CPU
                                registers (e.g., rdi, rsi on x86), achieving native execution with zero overhead.</span>
                        </div>
                    </div>
                    <div class="term-card">
                        <h4 class="lang-zh">辅助函数Helper Functions</h4>
                        <h4 class="lang-en hidden">Helper Functions</h4>
                        <p class="lang-zh">内核为 eBPF 程序开放的安全接口。由于程序不能直接调用内核私有函数，Helper 提供了获取时间、读写
                            Map、生成日志等受控的受限能力。比如：bpf_trace_printk()（打印日志）、bpf_map_lookup_elem()（查表）、bpf_redirect()（重定向网络包）。
                            通过这些 Helper，eBPF 可以修改网络包的 IP 地址、丢弃恶意包、记录系统调用参数。<br>现代内核（v6.x+）正转向 Kfuncs（内核函数直接映射）。它允许 eBPF
                            程序以更原生的性能调用内核内部逻辑，这在处理百万级 PPS 的安全审计时表现卓越。</p>
                        <p class="lang-en hidden">Standardized, safe interfaces opened by the kernel for eBPF programs.
                            Since programs cannot directly call private kernel functions, Helpers provide controlled,
                            restricted capabilities like time retrieval, Map R/W, and log generation.For example:
                            bpf_trace_printk() (print logs), bpf_map_lookup_elem() (lookup table), bpf_redirect()
                            (redirect network packets). Through these helpers, eBPF can modify the IP address of network
                            packets, discard malicious packets, and record system call parameters.
                            <br><strong>Kfuncs</strong> (v6.x+) offer native-like performance for calling internal
                            kernel logic—ideal for Million-PPS security auditing.
                        </p>
                        <div class="insight-card"
                            style="margin: 10px 0 0; font-size: 0.85rem; border-left: 2px solid var(--cisco-orange); background: rgba(255, 158, 27, 0.05);">
                            <span class="lang-zh"><strong>为什么这样设计？</strong> Helper
                                函数提供了<strong>稳定的安全边界</strong>。开发者无需关心内核底层复杂的驱动实现，只需调用这些“受控接口”即可指挥内核完成拦截、修改或转发，同时确保内核不会崩溃。</span>
                            <span class="lang-en hidden"><strong>Why this design?</strong> Helpers provide a
                                <strong>stable safety boundary</strong>. Developers command the kernel via these
                                controlled APIs without needing to know low-level driver details, ensuring system
                                stability.</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="term-group">
                <h3 class="term-group-title lang-zh">4. 挂钩与扩展</h3>
                <h3 class="term-group-title lang-en hidden">4. Attachment: Logic Injection Points</h3>
                <div class="card" style="border-top-color: var(--cisco-green); margin-bottom: 25px;">
                    <h4 class="lang-zh">挂钩点全景观 (Hook Points)</h4>
                    <h4 class="lang-en hidden">Hook Points Overview</h4>
                    <p class="lang-zh" style="margin-bottom: 20px;">eBPF 通过在内核关键路径上设置“监听站”，在不改动源码的情况下注入自定义逻辑：</p>
                    <p class="lang-en hidden" style="margin-bottom: 20px;">eBPF injects custom logic via "listening
                        posts"
                        on critical kernel paths without source code changes:</p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <ul class="hook-list">
                            <li class="hook-item">
                                <span class="hook-label">XDP</span>
                                <span class="hook-desc lang-zh"><strong>最早钩子：</strong>在网卡驱动层拦截包，适用于 DDoS 防护。</span>
                                <span class="hook-desc lang-en hidden"><strong>Earliest Hook:</strong> Intercepts
                                    packets at
                                    the NIC driver layer, ideal for DDoS protection.</span>
                            </li>
                            <li class="hook-item">
                                <span class="hook-label">TC</span>
                                <span class="hook-desc lang-zh"><strong>流控层：</strong>在包整形阶段介入，支持 QoS 与包标记。</span>
                                <span class="hook-desc lang-en hidden"><strong>Traffic Control:</strong> Intervenes
                                    during
                                    packet shaping, supporting QoS and packet marking.</span>
                            </li>
                            <li class="hook-item">
                                <span class="hook-label">LSM</span>
                                <span class="hook-desc lang-zh"><strong>安全模块：</strong>扩展 Linux 安全框架，实现内核级权限实时控制。</span>
                                <span class="hook-desc lang-en hidden"><strong>Security (LSM):</strong> Extends the
                                    Linux
                                    Security Module framework for real-time kernel-level privilege control.</span>
                            </li>
                        </ul>
                        <ul class="hook-list">
                            <li class="hook-item">
                                <span class="hook-label">Kprobes</span>
                                <span class="hook-desc lang-zh"><strong>动态探针：</strong>钩住任意内核函数，深入诊断性能瓶颈。</span>
                                <span class="hook-desc lang-en hidden"><strong>Dynamic Probes:</strong> Hooks into any
                                    kernel function to diagnose performance bottlenecks deeply.</span>
                            </li>
                            <li class="hook-item">
                                <span class="hook-label">Uprobes</span>
                                <span class="hook-desc lang-zh"><strong>用户探针：</strong>针对应用程序（如 libc）实现无侵入追踪。</span>
                                <span class="hook-desc lang-en hidden"><strong>Userspace Probes:</strong> Non-intrusive
                                    tracing for applications (e.g., libc functions).</span>
                            </li>
                            <li class="hook-item">
                                <span class="hook-label">Tracepts</span>
                                <span class="hook-desc lang-zh"><strong>静态追踪：</strong>由开发者预定义的稳定追踪点，开销极低。</span>
                                <span class="hook-desc lang-en hidden"><strong>Static Tracepoints:</strong> Pre-defined
                                    stable tracing points with minimal overhead.</span>
                            </li>
                        </ul>
                    </div>
                    <div class="term-grid">
                        <div class="term-card" style="border-top: 3px solid var(--cisco-red);">
                            <h5 class="lang-zh">XDP (eXpress Data Path)</h5>
                            <h5 class="lang-en hidden">XDP (eXpress Data Path)</h5>
                            <p class="lang-zh">Linux 内核中性能最高的网络路径。它直接在网卡驱动层拦截数据包，允许程序在内核分配昂贵的缓冲区（sk_buff）之前进行处理。</p>
                            <p class="lang-en hidden">The highest-performance network path in the Linux kernel. It
                                intercepts packets directly at the NIC driver layer, allowing processing before the
                                kernel
                                allocates expensive buffers (sk_buff).</p>

                            <div class="insight-card"
                                style="margin: 10px 0 0; font-size: 0.85rem; border-left: 2px solid var(--cisco-red); background: rgba(226, 35, 26, 0.02);">
                                <span class="lang-zh"><strong>2025 战力：</strong> 在 Tbps 级 DDoS 攻击下，XDP 凭借<strong>硬件卸载
                                        (Offload)</strong> 能力，单核即可实现每秒处理<strong>数千万个数据包
                                        (Mpps)</strong>。它在“敌人”进入大门前就将其丢弃，保护了后端服务的 CPU 不被流量洪峰淹没。</span>
                                <span class="lang-en hidden"><strong>2025 Capability:</strong> Under Tbps-scale DDoS
                                    attacks, XDP leverages <strong>Hardware Offload</strong> to process <strong>tens of
                                        millions of packets per second (Mpps)</strong> on a single core. It drops
                                    "enemies"
                                    at the gate, shielding backend CPUs from traffic surges.</span>
                            </div>
                        </div>

                        <div class="term-card" style="border-top: 3px solid var(--cisco-orange);">
                            <h5 class="lang-zh">Kprobes / Uprobes</h5>
                            <h5 class="lang-en hidden">Dynamic Probes (Kprobes / Uprobes)</h5>
                            <p class="lang-zh">内核与用户态的“手术刀”。Kprobes 用于钩住内核函数入口/出口，Uprobes 则针对用户态程序（如二进制文件或库函数）进行无侵入追踪。
                            </p>
                            <p class="lang-en hidden">The "scalpels" of the kernel and userspace. Kprobes hook kernel
                                function entries/exits, while Uprobes provide non-intrusive tracing for userspace
                                applications.</p>

                            <div class="insight-card"
                                style="margin: 10px 0 0; font-size: 0.85rem; border-left: 2px solid var(--cisco-orange); background: rgba(255, 158, 27, 0.03);">
                                <span class="lang-zh"><strong>2025 优化：</strong> 现代内核支持
                                    <strong>multi-kprobe</strong>，允许一次性挂钩数千个函数，将批量追踪的 CPU 开销降低了 40% 以上。<br></span>
                                <span class="lang-en hidden"><strong>2025 Opt:</strong> Modern kernels support
                                    <strong>multi-kprobe</strong>, allowing thousands of hooks simultaneously while
                                    cutting batch tracing overhead by over 40%.<br></span>
                                <span class="lang-zh"><strong>安全加固：</strong> 在“后 CrowdStrike 时代”，通过 Kprobes 监控关键系统调用（如
                                    `execve`），安全专家可以实现<strong>实时威胁拦截</strong>——不仅是看到攻击，而是瞬间阻断异常进程。</span>
                                <span class="lang-en hidden"><strong>Security Hardening:</strong> In the
                                    "Post-CrowdStrike"
                                    era, monitoring syscalls like `execve` via Kprobes enables <strong>real-time threat
                                        enforcement</strong>—not just detecting attacks, but instantly killing
                                    suspicious
                                    processes.</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="term-grid">
                    <div class="term-card" style="border-top-color: var(--cisco-midnight);">
                        <h4 class="lang-zh">尾调用 (Tail Calls)</h4>
                        <h4 class="lang-en hidden">Tail Calls</h4>
                        <p class="lang-zh"
                            style="font-size: 0.95rem; margin-top: 10px; border-bottom: 1px solid #eee; padding-bottom: 8px; margin-bottom: 10px;">
                            <strong>定义 (What)：</strong> 尾调用允许一个 eBPF 程序调用另一个程序并<strong>立即替换</strong>当前执行上下文，且不返回。
                        </p>
                        <p class="lang-en hidden"
                            style="font-size: 0.95rem; margin-top: 10px; border-bottom: 1px solid #eee; padding-bottom: 8px; margin-bottom: 10px;">
                            <strong>Definition (What):</strong> Tail calls allow an eBPF program to call another and
                            <strong>replace</strong> the execution context without returning.
                        </p>
                        <p class="lang-zh" style="font-size: 0.95rem; margin-top: 10px;">
                            <strong>进化：</strong> 早期内核限制为 4096 条指令。但在 2025 年，现代内核已支持 <strong>100 万条指令</strong>
                            的复杂度检查（Complexity Limit）。此演进使得在内核层运行复杂的<strong>轻量级 AI 推理/过滤模型</strong>成为可能。
                        </p>
                        <p class="lang-en hidden" style="font-size: 0.95rem; margin-top: 10px;">
                            <strong>Evolution:</strong> Early kernels were limited to 4096 instructions. In 2025, modern
                            kernels support up to <strong>1 million instructions</strong> complexity limit.This
                            evolution
                            enables running complex <strong>lightweight AI inference/filtering
                                models</strong> at the kernel layer.
                        </p>
                        <div class="insight-card" style="margin-top: 5px; font-size: 0.85rem;">
                            <span class="lang-zh">核心优势：实现逻辑解耦、构建复杂的模块化处理管道（如 Cilium 的网络逻辑链路）。</span>
                            <span class="lang-en hidden">Core Benefit: Logical decoupling and building complex modular
                                processing pipelines (e.g., Cilium's network logic links).</span>
                        </div>
                    </div>
                </div>
            </div>


            <div class="term-group">
                <h3 class="term-group-title lang-zh">5. 通信与治理</h3>
                <h3 class="term-group-title lang-en hidden">5. Lifecycle: Communication & Governance</h3>
                <div class="term-grid">
                    <div class="term-card">
                        <h4 class="lang-zh">BPF Maps (共享内存)</h4>
                        <h4 class="lang-en hidden">BPF Maps (Shared Memory)</h4>
                        <p class="lang-zh">内核与用户态之间的“高速公路”。eBPF 程序通过这种键值对存储方式，将捕获的数据传递给用户态分析工具，或接收用户态下发的配置指令。</p>
                        <p class="lang-en hidden">The "highway" between the kernel and user space. eBPF programs use
                            this key-value storage method to pass captured data to user-space analysis tools or receive
                            configuration instructions issued from user space.</p>
                        <div class="insight-card"
                            style="margin: 10px 0 0; font-size: 0.85rem; border-left: 2px solid var(--cisco-green); background: rgba(108, 194, 74, 0.03);">
                            <span class="lang-zh"><strong>2025 技术基准：</strong> 推荐使用 <strong>BPF Ring Buffer</strong> 替代
                                Perf Buffer。它具备跨 CPU 共享存储、内存利用率高（减少 50% 以上）且严格保序的特性，是百万级 PPS 审计的首选。Ring Buffer 解决了 Perf
                                Buffer 在高并发时因 <strong>Per-CPU 缓冲区 </strong>导致的内存碎片和数据乱序问题，为实时审计提供了 100% 的确定性。</span>
                            <span class="lang-en hidden"><strong>2025 Baseline:</strong> Use <strong>BPF Ring
                                    Buffer</strong> instead of Perf Buffer. It offers cross-CPU sharing, 50% better
                                memory efficiency, and strict ordering—the gold standard for Million-PPS auditing. Ring
                                Buffer eliminates memory fragmentation and reordering issues inherent in <strong>Per-CPU
                                    buffers</strong>, ensuring 100% deterministic auditing for high-concurrency
                                workloads.</span>
                        </div>
                    </div>
                    <div class="term-card">
                        <h4 class="lang-zh">bpf_link (持久化连接)</h4>
                        <h4 class="lang-en hidden">bpf_link (Atomic Persistence)</h4>
                        <p class="lang-zh"
                            style="font-size: 0.95rem; margin-top: 10px; border-bottom: 1px solid #eee; padding-bottom: 8px; margin-bottom: 10px;">
                            <strong>定义 (What)：</strong> bpf_link 是一个内核对象，它代表了 eBPF
                            程序与内核挂钩点（Hook）之间的<strong>持久化连接</strong>。
                        </p>
                        <p class="lang-en hidden"
                            style="font-size: 0.95rem; margin-top: 10px; border-bottom: 1px solid #eee; padding-bottom: 8px; margin-bottom: 10px;">
                            <strong>Definition (What):</strong> bpf_link is a kernel object representing a
                            <strong>persistent connection</strong> between an eBPF program and a hook point.
                        </p>
                        <p class="lang-zh" style="font-size: 0.95rem; margin-top: 10px;">
                            <strong>架构价值：</strong> 在 2025 年的生产实践中，我们不再直接 attach 程序，而是通过 <code>bpf_link</code>
                            进行抽象管理。<br><br>
                            <strong>核心进化：</strong>
                            它解决了“进程崩溃导致挂钩失效”的痛点。即使用户态管理程序退出，内核态的逻辑依然可以受控存在。这实现了安全策略与管理工具的<strong>原子性解耦</strong>。
                        </p>
                        <p class="lang-en hidden" style="font-size: 0.95rem; margin-top: 10px;">
                            <strong>Arch Value:</strong> In 2025, we manage hooks via <code>bpf_link</code> instead of
                            raw attachment.<br><br>
                            <strong>Evolution:</strong> It decouples the program lifecycle from the user-space process.
                            If the manager crashes, the kernel-level defense remains intact, ensuring <strong>atomic
                                persistence</strong> of security policies.
                        </p>
                    </div>
                </div>
            </div>
    </section>

    <!-- Deep Dive Section -->
    <section class="process-section">
        <div class="container">
            <span class="golden-badge lang-zh">运行机制 / INNER WORKINGS</span>
            <span class="golden-badge lang-en hidden">INNER WORKINGS / MECHANISM</span>

            <h2 class="section-title lang-zh">eBPF 运行机制</h2>
            <h2 class="section-title lang-en hidden">eBPF Mechanism</h2>
            <p class="lang-zh" style="text-align: center; max-width: 850px; margin: -40px auto 40px; color: #666;">
                了解了 JIT、CO-RE 和 Maps 等组件后，我们需要深入其内部，观察字节码是如何跨越权限边界，在确保系统绝对安全的前提下实现高性能执行的。
            </p>
            <p class="lang-en hidden"
                style="text-align: center; max-width: 850px; margin: -40px auto 40px; color: #666;">
                Having explored components like JIT and CO-RE, we dive into its inner workings to see how bytecode
                crosses privilege
                boundaries and achieves high-performance execution while maintaining absolute system safety.
            </p>
            <p class="lang-zh" style="text-align: center; max-width: 800px; margin: 0 auto 30px;">eBPF
                允许在不更改内核代码的情况下，在内核事件触发时运行自定义程序。以下是其核心链路图示：</p>
            <p class="lang-en hidden" style="text-align: center; max-width: 800px; margin: 0 auto 30px;">eBPF allows
                running custom programs upon kernel events without changing source code. Here is the core workflow
                diagram:</p>

            <div class="diagram-container">
                <svg class="arch-svg lang-zh" width="900" height="520" viewBox="0 0 900 520" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <filter id="shadow-zh" x="0" y="0" width="100%" height="100%">
                            <feDropShadow dx="0" dy="2" stdDeviation="4" flood-opacity="0.05"/>
                        </filter>
                        <linearGradient id="user-grad-zh" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" stop-color="#FFFFFF"/>
                            <stop offset="100%" stop-color="#F8FAFC"/>
                        </linearGradient>
                        <marker id="arrow-cisco-zh" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#94A3B8" />
                        </marker>
                    </defs>

                    <rect x="10" y="10" width="880" height="180" rx="16" fill="url(#user-grad-zh)" stroke="#E2E8F0" stroke-width="1"/>
                    <text x="30" y="40" fill="#94A3B8" font-size="12" font-weight="800" letter-spacing="1">用户空间 (USER SPACE)</text>

                    <g transform="translate(50, 60)" filter="url(#shadow-zh)">
                        <rect width="160" height="80" rx="12" fill="white" stroke="#E2E8F0"/>
                        <text x="80" y="35" text-anchor="middle" fill="#1D2729" font-size="13" font-weight="700">1. 编写与编译</text>
                        <text x="80" y="55" text-anchor="middle" fill="#64748B" font-size="11">C / Rust (LLVM)</text>
                        <rect x="40" y="62" width="80" height="12" rx="4" fill="#E1F5FE"/>
                        <text x="80" y="71" text-anchor="middle" fill="#049FD9" font-size="9" font-weight="bold">BPF 字节码 (ELF)</text>
                    </g>

                    <g transform="translate(370, 60)" filter="url(#shadow-zh)">
                        <rect width="160" height="80" rx="12" fill="white" stroke="#049FD9" stroke-width="1.5"/>
                        <text x="80" y="35" text-anchor="middle" fill="#1D2729" font-size="13" font-weight="700">4. 加载与挂载</text>
                        <text x="80" y="55" text-anchor="middle" fill="#64748B" font-size="11">bpftool / libbpf</text>
                        <path d="M40 65 H120" stroke="#049FD9" stroke-width="2" stroke-linecap="round"/>
                        <text x="80" y="75" text-anchor="middle" fill="#049FD9" font-size="10" font-weight="bold">bpf_link</text>
                    </g>

                    <g transform="translate(690, 60)" filter="url(#shadow-zh)">
                        <rect width="160" height="80" rx="12" fill="white" stroke="#6CC24A" stroke-width="1.5"/>
                        <text x="80" y="35" text-anchor="middle" fill="#1D2729" font-size="13" font-weight="700">6. 交互与消费</text>
                        <text x="80" y="55" text-anchor="middle" fill="#64748B" font-size="11">用户态应用程序</text>
                    </g>

                    <path d="M210 100 H370" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow-cisco-zh)"/>
                    <path d="M450 140 V240" stroke="#049FD9" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrow-cisco-zh)"/>
                    <text x="460" y="195" fill="#049FD9" font-size="11" font-weight="bold">bpf() 系统调用</text>

                    <rect x="10" y="220" width="880" height="280" rx="16" fill="#0D274D" fill-opacity="0.03" stroke="#049FD9" stroke-width="2" stroke-dasharray="8,4"/>
                    <text x="30" y="250" fill="#0D274D" font-size="12" font-weight="800" letter-spacing="1">LINUX 内核 (KERNEL)</text>

                    <g transform="translate(50, 280)">
                        <rect width="180" height="180" rx="16" fill="white" stroke="#E2231A" stroke-width="2" filter="url(#shadow-zh)"/>
                        <text x="90" y="40" text-anchor="middle" fill="#1D2729" font-size="14" font-weight="700">2. 验证与准入</text>
                        <circle cx="90" cy="100" r="35" fill="#FFF5F5" stroke="#E2231A" stroke-width="1"/>
                        <path d="M80 100 L87 107 L105 89" stroke="#E2231A" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
                        <text x="90" y="155" text-anchor="middle" fill="#64748B" font-size="11">DAG 静态安全分析</text>
                    </g>

                    <g transform="translate(300, 280)">
                        <rect width="180" height="180" rx="16" fill="white" stroke="#049FD9" stroke-width="2" filter="url(#shadow-zh)"/>
                        <text x="90" y="40" text-anchor="middle" fill="#1D2729" font-size="14" font-weight="700">3. 机器码转换</text>
                        <path d="M70 100 L90 80 L90 120 L110 100" stroke="#049FD9" stroke-width="3" stroke-linecap="round"/>
                        <text x="90" y="145" text-anchor="middle" fill="#049FD9" font-size="12" font-weight="bold">JIT 编译器</text>
                        <text x="90" y="165" text-anchor="middle" fill="#64748B" font-size="10">x86 / ARM 原生指令</text>
                    </g>

                    <g transform="translate(550, 280)">
                        <rect width="300" height="180" rx="16" fill="white" stroke="#6CC24A" stroke-width="2" filter="url(#shadow-zh)"/>
                        <text x="150" y="40" text-anchor="middle" fill="#1D2729" font-size="14" font-weight="700">5. 事件触发 & 数据流</text>
                        
                        <rect x="20" y="65" width="120" height="90" rx="8" fill="#F0FDF4" stroke="#6CC24A" stroke-dasharray="4,2"/>
                        <text x="80" y="85" text-anchor="middle" fill="#166534" font-size="11" font-weight="bold">挂钩点 (Hooks)</text>
                        <text x="80" y="110" text-anchor="middle" fill="#166534" font-size="10">XDP / TC</text>
                        <text x="80" y="130" text-anchor="middle" fill="#166534" font-size="10">Kprobes</text>

                        <rect x="160" y="65" width="120" height="90" rx="8" fill="#F0F9FF" stroke="#049FD9"/>
                        <text x="220" y="85" text-anchor="middle" fill="#0369A1" font-size="11" font-weight="bold">BPF Maps</text>
                        <path d="M185 105 H255 M185 125 H255" stroke="#049FD9" stroke-width="1.5" opacity="0.3"/>
                        <text x="220" y="145" text-anchor="middle" fill="#0369A1" font-size="9">共享状态/存储</text>
                    </g>

                    <path d="M230 370 H300" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow-cisco-zh)"/>
                    <path d="M480 370 H550" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow-cisco-zh)"/>
                    
                    <path d="M770 280 Q770 190 770 140" fill="none" stroke="#6CC24A" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrow-cisco-zh)"/>
                    <text x="780" y="210" fill="#6CC24A" font-size="11" font-weight="bold">Map 数据同步</text>
                </svg>                
                <svg class="arch-svg lang-en" width="900" height="520" viewBox="0 0 900 520" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <filter id="shadow-en" x="0" y="0" width="100%" height="100%">
                            <feDropShadow dx="0" dy="2" stdDeviation="4" flood-opacity="0.05"/>
                        </filter>
                        <linearGradient id="user-grad-en" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" stop-color="#FFFFFF"/>
                            <stop offset="100%" stop-color="#F8FAFC"/>
                        </linearGradient>
                        <marker id="arrow-cisco-en" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#94A3B8" />
                        </marker>
                    </defs>

                    <rect x="10" y="10" width="880" height="180" rx="16" fill="url(#user-grad-en)" stroke="#E2E8F0" stroke-width="1"/>
                    <text x="30" y="40" fill="#94A3B8" font-size="12" font-weight="800" letter-spacing="1">USER SPACE</text>

                    <g transform="translate(50, 60)" filter="url(#shadow-en)">
                        <rect width="160" height="80" rx="12" fill="white" stroke="#E2E8F0"/>
                        <text x="80" y="35" text-anchor="middle" fill="#1D2729" font-size="13" font-weight="700">1. Compile</text>
                        <text x="80" y="55" text-anchor="middle" fill="#64748B" font-size="11">C / Rust (LLVM)</text>
                        <rect x="40" y="62" width="80" height="12" rx="4" fill="#E1F5FE"/>
                        <text x="80" y="71" text-anchor="middle" fill="#049FD9" font-size="9" font-weight="bold">BPF Bytecode (ELF)</text>
                    </g>

                    <g transform="translate(370, 60)" filter="url(#shadow-en)">
                        <rect width="160" height="80" rx="12" fill="white" stroke="#049FD9" stroke-width="1.5"/>
                        <text x="80" y="35" text-anchor="middle" fill="#1D2729" font-size="13" font-weight="700">4. Load & Attach</text>
                        <text x="80" y="55" text-anchor="middle" fill="#64748B" font-size="11">bpftool / libbpf</text>
                        <path d="M40 65 H120" stroke="#049FD9" stroke-width="2" stroke-linecap="round"/>
                        <text x="80" y="75" text-anchor="middle" fill="#049FD9" font-size="10" font-weight="bold">bpf_link</text>
                    </g>

                    <g transform="translate(690, 60)" filter="url(#shadow-en)">
                        <rect width="160" height="80" rx="12" fill="white" stroke="#6CC24A" stroke-width="1.5"/>
                        <text x="80" y="35" text-anchor="middle" fill="#1D2729" font-size="13" font-weight="700">6. Consume</text>
                        <text x="80" y="55" text-anchor="middle" fill="#64748B" font-size="11">User Space App</text>
                    </g>

                    <path d="M210 100 H370" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow-cisco-en)"/>
                    <path d="M450 140 V240" stroke="#049FD9" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrow-cisco-en)"/>
                    <text x="460" y="195" fill="#049FD9" font-size="11" font-weight="bold">bpf() Syscall</text>

                    <rect x="10" y="220" width="880" height="280" rx="16" fill="#0D274D" fill-opacity="0.03" stroke="#049FD9" stroke-width="2" stroke-dasharray="8,4"/>
                    <text x="30" y="250" fill="#0D274D" font-size="12" font-weight="800" letter-spacing="1">LINUX KERNEL</text>

                    <g transform="translate(50, 280)">
                        <rect width="180" height="180" rx="16" fill="white" stroke="#E2231A" stroke-width="2" filter="url(#shadow-en)"/>
                        <text x="90" y="40" text-anchor="middle" fill="#1D2729" font-size="14" font-weight="700">2. Verification</text>
                        <circle cx="90" cy="100" r="35" fill="#FFF5F5" stroke="#E2231A" stroke-width="1"/>
                        <path d="M80 100 L87 107 L105 89" stroke="#E2231A" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
                        <text x="90" y="155" text-anchor="middle" fill="#64748B" font-size="11">DAG Security Analysis</text>
                    </g>

                    <g transform="translate(300, 280)">
                        <rect width="180" height="180" rx="16" fill="white" stroke="#049FD9" stroke-width="2" filter="url(#shadow-en)"/>
                        <text x="90" y="40" text-anchor="middle" fill="#1D2729" font-size="14" font-weight="700">3. JIT Translation</text>
                        <path d="M70 100 L90 80 L90 120 L110 100" stroke="#049FD9" stroke-width="3" stroke-linecap="round"/>
                        <text x="90" y="145" text-anchor="middle" fill="#049FD9" font-size="12" font-weight="bold">JIT Compiler</text>
                        <text x="90" y="165" text-anchor="middle" fill="#64748B" font-size="10">x86 / ARM Native</text>
                    </g>

                    <g transform="translate(550, 280)">
                        <rect width="300" height="180" rx="16" fill="white" stroke="#6CC24A" stroke-width="2" filter="url(#shadow-en)"/>
                        <text x="150" y="40" text-anchor="middle" fill="#1D2729" font-size="14" font-weight="700">5. Event Trigger & Data</text>
                        
                        <rect x="20" y="65" width="120" height="90" rx="8" fill="#F0FDF4" stroke="#6CC24A" stroke-dasharray="4,2"/>
                        <text x="80" y="85" text-anchor="middle" fill="#166534" font-size="11" font-weight="bold">Hook Points</text>
                        <text x="80" y="110" text-anchor="middle" fill="#166534" font-size="10">XDP / TC</text>
                        <text x="80" y="130" text-anchor="middle" fill="#166534" font-size="10">Kprobes</text>

                        <rect x="160" y="65" width="120" height="90" rx="8" fill="#F0F9FF" stroke="#049FD9"/>
                        <text x="220" y="85" text-anchor="middle" fill="#0369A1" font-size="11" font-weight="bold">BPF Maps</text>
                        <path d="M185 105 H255 M185 125 H255" stroke="#049FD9" stroke-width="1.5" opacity="0.3"/>
                        <text x="220" y="145" text-anchor="middle" fill="#0369A1" font-size="9">Shared State/Storage</text>
                    </g>

                    <path d="M230 370 H300" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow-cisco-en)"/>
                    <path d="M480 370 H550" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow-cisco-en)"/>
                    
                    <path d="M770 280 Q770 190 770 140" fill="none" stroke="#6CC24A" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrow-cisco-en)"/>
                    <text x="780" y="210" fill="#6CC24A" font-size="11" font-weight="bold">Map Data Sync</text>
                </svg>
            </div>

            <div class="process-steps" style="grid-template-columns: repeat(3, 1fr); gap: 30px;">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h4 class="lang-zh">编写与编译 (Compile)</h4>
                    <h4 class="lang-en hidden">Write & Compile</h4>
                    <p class="lang-zh" style="font-size: 0.88rem;">使用 C/Rust 编写逻辑，通过 LLVM 编译为 **BPF 字节码 (ELF)**。此时程序包含
                        BTF 调试信息，为 CO-RE 跨版本运行做准备。</p>
                    <p class="lang-en hidden" style="font-size: 0.88rem;">Write logic in C/Rust, compile to **BPF
                        Bytecode (ELF)** via LLVM, including BTF metadata for CO-RE portability.</p>
                </div>
                <div class="step-card" style="border-top-color: var(--cisco-orange);">
                    <div class="step-number" style="background: var(--cisco-orange);">2</div>
                    <h4 class="lang-zh">验证与准入 (Verifier)</h4>
                    <h4 class="lang-en hidden">Verify & Admit</h4>
                    <p class="lang-zh" style="font-size: 0.88rem;">内核 **Verifier** 进行 DAG
                        静态分析。模拟所有执行路径，确保无死循环、无非法内存越界。若不安全，内核将拒绝执行。</p>
                    <p class="lang-en hidden" style="font-size: 0.88rem;">The kernel **Verifier** performs DAG static
                        analysis, proving memory safety and no infinite loops before admission.</p>
                </div>
                <div class="step-card">
                    <div class="step-number">3</div>
                    <h4 class="lang-zh">机器码转换 (JIT)</h4>
                    <h4 class="lang-en hidden">JIT Compilation</h4>
                    <p class="lang-zh" style="font-size: 0.88rem;">**JIT 编译器**将平台无关的字节码即时编译为 x86/ARM
                        原生机器码。这一步消除了指令翻译开销，实现近乎原生的执行性能。</p>
                    <p class="lang-en hidden" style="font-size: 0.88rem;">The **JIT Compiler** translates bytecode into
                        native machine code (x86/ARM) for zero-overhead execution.</p>
                </div>
                <div class="step-card" style="border-top-color: var(--cisco-midnight);">
                    <div class="step-number" style="background: var(--cisco-midnight);">4</div>
                    <h4 class="lang-zh">加载与挂载 (Loader)</h4>
                    <h4 class="lang-en hidden">Load & Attach</h4>
                    <p class="lang-zh" style="font-size: 0.88rem;">通过 **bpftool** 或 **libbpf** 将程序注入内核，利用 `bpf_link`
                        原子性地挂载到指定 **Hook** (如 XDP、Kprobe)。</p>
                    <p class="lang-en hidden" style="font-size: 0.88rem;">Using **bpftool** or **libbpf** to inject the
                        program and atomically attach to **Hooks** via `bpf_link` objects.</p>
                </div>
                <div class="step-card" style="border-top-color: var(--cisco-green);">
                    <div class="step-number" style="background: var(--cisco-green);">5</div>
                    <h4 class="lang-zh">事件触发 (Execution)</h4>
                    <h4 class="lang-en hidden">Event Trigger</h4>
                    <p class="lang-zh" style="font-size: 0.88rem;">内核事件（如收到数据包、系统调用）触发 Hook。eBPF
                        程序瞬间激活，在不离开内核上下文的情况下完成观测或拦截。</p>
                    <p class="lang-en hidden" style="font-size: 0.88rem;">Kernel events (e.g., packet arrival, syscalls)
                        trigger the Hook, executing logic instantly within the kernel context.</p>
                </div>
                <div class="step-card" style="border-top-color: var(--cisco-midnight);">
                    <div class="step-number" style="background: var(--cisco-midnight);">6</div>
                    <h4 class="lang-zh">交互与卸载 (Finalize)</h4>
                    <h4 class="lang-en hidden">Comm & Unload</h4>
                    <p class="lang-zh" style="font-size: 0.88rem;">程序通过 **BPF Maps**
                        与用户空间实时同步结果。运行结束或手动关闭文件描述符后，内核自动释放相关资源。</p>
                    <p class="lang-en hidden" style="font-size: 0.88rem;">Sync data via **BPF Maps**. Resources are
                        auto-released by the kernel once the FD is closed or manually detached.</p>
                </div>
            </div>
            <div class="container" style="margin-top: 60px;">
                <div
                    style="background: var(--cisco-gray); border-radius: 12px; padding: 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px;">
                    <div>
                        <h4 class="lang-zh" style="color: var(--cisco-midnight); margin-bottom: 15px;">传统内核开发：长路漫漫</h4>
                        <h4 class="lang-en hidden" style="color: var(--cisco-midnight); margin-bottom: 15px;">
                            Traditional: The Long Road</h4>
                        <p style="font-size: 0.9rem; color: #666;">
                            <span class="lang-zh">修改源码 → 社区讨论 (1年) → 内核合并 (0.5年) → 发行版更新 (2年) → 重启生产环境。</span>
                            <span class="lang-en hidden">Edit source → RFC (1yr) → Merge (0.5yr) → Distro (2yr) →
                                Reboot.</span>
                        </p>
                    </div>
                    <div style="border-left: 2px solid var(--cisco-blue); padding-left: 30px;">
                        <h4 class="lang-zh" style="color: var(--cisco-blue); margin-bottom: 15px;">eBPF 开发：即刻进化</h4>
                        <h4 class="lang-en hidden" style="color: var(--cisco-blue); margin-bottom: 15px;">eBPF: Instant
                            Evolution</h4>
                        <p style="font-size: 0.9rem; color: var(--cisco-midnight);">
                            <span class="lang-zh"><strong>编写 C/Go 代码 → 编译并验证 (Verifier) → 热加载至内核 →
                                    毫秒级生效。</strong></span>
                            <span class="lang-en hidden"><strong>Write C/Go → Verify → Hot-load → Active in
                                    ms.</strong></span>
                        </p>
                    </div>
                </div>
            </div>
            <div style="margin-top: 40px; text-align: center;">
                <div class="logic-connector"></div>
                <div class="lang-zh">
                    <p style="color: var(--cisco-midnight); font-weight: bold; margin: 20px 0;">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"
                            style="vertical-align: middle; margin-right: 8px;">
                            <path
                                d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z" />
                        </svg>
                        代码实现：这些流程在源码中如何体现？
                    </p>
                </div>
                <div class="lang-en hidden">
                    <p style="color: var(--cisco-midnight); font-weight: bold; margin: 20px 0;">
                        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"
                            style="vertical-align: middle; margin-right: 8px;">
                            <path
                                d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z" />
                        </svg>
                        Code Implementation: How does the flow look in source?
                    </p>
                </div>
            </div>

            <div class="synergy-container">
                <div class="synergy-header">
                    <div style="display: flex; gap: 8px;">
                        <div class="dot dot-red"></div>
                        <div class="dot dot-yellow"></div>
                        <div class="dot dot-green"></div>
                    </div>
                    <div style="color: #aaa; font-size: 0.8rem; font-family: sans-serif; font-weight: bold;">
                        <span class="lang-zh">全栈安全审计架构 (Libbpf 范式)</span>
                        <span class="lang-en hidden">Full-stack Audit Arch (Libbpf Paradigm)</span>
                    </div>
                </div>

                <div class="synergy-grid">
                    <div class="code-pane">
                        <div class="pane-title">
                            <span>audit_kern.c</span>
                            <span class="synergy-badge badge-kernel">Kernel Space</span>
                        </div>
                        <pre class="code-content-stable lang-zh">
            // 1. 定义事件 Map (Ring Buffer)
            struct {
                __uint(type, BPF_MAP_TYPE_RINGBUF);
                __uint(max_entries, 256 * 1024);
            } audit_events SEC(".maps");

            // 2. 挂钩到系统调用进入点 (Hook)
            SEC("tp/syscalls/sys_enter_openat")
            int handle_openat(struct trace_event_raw_sys_enter *ctx) {
                struct event *e;
                // 只审计敏感路径如 /etc/shadow
                if (!is_sensitive_path(ctx->filename)) return 0;

                // 3. 将违规事件推送到 Ring Buffer
                e = bpf_ringbuf_reserve(&audit_events, sizeof(*e), 0);
                if (e) {
                    e->pid = bpf_get_current_pid_tgid() >> 32;
                    bpf_get_current_comm(&e->comm, sizeof(e->comm));
                    bpf_ringbuf_submit(e, 0);
                }
                return 0;
            }</pre>
                        <pre class="code-content-stable lang-en hidden">
            // 1. Define Map (Ring Buffer Bridge)
            struct {
                __uint(type, BPF_MAP_TYPE_RINGBUF);
                __uint(max_entries, 256 * 1024);
            } audit_events SEC(".maps");

            // 2. Hook into Syscall Entry
            SEC("tp/syscalls/sys_enter_openat")
            int handle_openat(struct trace_event_raw_sys_enter *ctx) {
                struct event *e;
                if (!is_sensitive_path(ctx->filename)) return 0;

                // 3. Push violation event to Ring Buffer
                e = bpf_ringbuf_reserve(&audit_events, sizeof(*e), 0);
                if (e) {
                    e->pid = bpf_get_current_pid_tgid() >> 32;
                    bpf_get_current_comm(&e->comm, sizeof(e->comm));
                    bpf_ringbuf_submit(e, 0);
                }
                return 0;
            }</pre>
                    </div>

                    <div class="code-pane">
                        <div class="pane-title">
                            <span>audit_user.c</span>
                            <span class="synergy-badge badge-user">User Space</span>
                        </div>
                        <pre class="code-content-stable lang-zh">
            // 1. 加载并挂载程序 (Loader)
            struct audit_bpf *skel = audit_bpf__open_and_load();
            audit_bpf__attach(skel);

            // 2. 消费内核态推送到 Map 的数据
            struct ring_buffer *rb = ring_buffer__new(
                bpf_map__fd(skel->maps.audit_events), 
                handle_event, NULL, NULL
            );

            // 3. 事件回调处理
            int handle_event(void *ctx, void *data, size_t len) {
                struct event *e = data;
                printf("警报：进程 [%s] (PID: %d) 正在访问敏感文件！\n", 
                        e->comm, e->pid);
                return 0;
            }
            while (ring_buffer__poll(rb, 100) >= 0);</pre>
                        <pre class="code-content-stable lang-en hidden">
            // 1. Load and Attach (Loader Logic)
            struct audit_bpf *skel = audit_bpf__open_and_load();
            audit_bpf__attach(skel);

            // 2. Consume data from the Map bridge
            struct ring_buffer *rb = ring_buffer__new(
                bpf_map__fd(skel->maps.audit_events), 
                handle_event, NULL, NULL
            );

            // 3. Event Callback Processing
            int handle_event(void *ctx, void *data, size_t len) {
                struct event *e = data;
                printf("ALERT: Process [%s] (PID: %d) accessing sensitive file!\n", 
                        e->comm, e->pid);
                return 0;
            }
            while (ring_buffer__poll(rb, 100) >= 0);</pre>
                    </div>
                </div>

                <div class="map-bridge-indicator">
                    <span class="lang-zh">➔ 逻辑链路：内核态事件捕获 → BPF Map (Ring Buffer) → 用户态实时响应 ➔</span>
                    <span class="lang-en hidden">➔ Logic: Event Capture → BPF Map Bridge → Real-time Response ➔</span>
                </div>
            </div>

            <div class="detail-grid" style="margin-top: 50px;">
                <div class="card" style="border-top-color: var(--cisco-blue); grid-column: 1 / -1;">
                    <h4 class="lang-zh" style="display:flex; align-items:center; gap:10px;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="var(--cisco-blue)">
                            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />
                        </svg>
                        eBPF 程序全生命周期概览 (The Hard Way)
                    </h4>
                    <h4 class="lang-en hidden">Full eBPF Program Lifecycle (The Hard Way)</h4>
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;">
                        <ol
                            style="font-size: 0.92rem; color: #444; line-height: 2; list-style-position: inside; padding-left: 0;">
                            <li class="lang-zh"><strong>编写：</strong> 使用 C/Rust 定义逻辑与 Map 结构。</li>
                            <li class="lang-en hidden"><strong>Write:</strong> Define logic and Map structures in
                                C/Rust.</li>
                            <li class="lang-zh"><strong>编译：</strong> Clang/LLVM 将代码转为二进制 ELF 字节码。</li>
                            <li class="lang-en hidden"><strong>Compile:</strong> Clang/LLVM converts code to ELF
                                bytecode.</li>
                            <li class="lang-zh"><strong>校验：</strong> Verifier 静态分析 100 万条指令路径的安全性。</li>
                            <li class="lang-en hidden"><strong>Verify:</strong> Verifier analyzes up to 1M instructions
                                for safety.</li>
                            <li class="lang-zh"><strong>JIT：</strong> 字节码转换为 CPU 物理寄存器指令。</li>
                            <li class="lang-en hidden"><strong>JIT:</strong> Bytecode translates to physical CPU
                                instructions.</li>
                        </ol>
                        <ol start="5"
                            style="font-size: 0.92rem; color: #444; line-height: 2; list-style-position: inside; padding-left: 0;">
                            <li class="lang-zh"><strong>加载：</strong> bpftool 通过 `bpf()` 调用注入并关联 Hook。</li>
                            <li class="lang-en hidden"><strong>Load:</strong> bpftool injects code via `bpf()` syscall.
                            </li>
                            <li class="lang-zh"><strong>运行：</strong> Hook 被硬件或软件事件瞬间激活。</li>
                            <li class="lang-en hidden"><strong>Run:</strong> Hook activated by hardware/software events.
                            </li>
                            <li class="lang-zh"><strong>交换：</strong> 通过 Maps 与用户空间进行异步或原子状态交换。</li>
                            <li class="lang-en hidden"><strong>Exchange:</strong> Async state exchange via BPF Maps.
                            </li>
                            <li class="lang-zh"><strong>销毁：</strong> 引用计数归零，内核清理机器码与状态。</li>
                            <li class="lang-en hidden"><strong>Cleanup:</strong> Resources released upon zero reference
                                count.</li>
                        </ol>
                    </div>
                    <div class="winston-callout"
                        style="margin-top: 20px; border-left-color: var(--cisco-red); background: rgba(226, 35, 26, 0.03);">
                        <p class="lang-zh" style="font-size: 0.88rem;"><strong>安全架构师评价：</strong>
                            这一套流程虽然极其严密且安全，但对开发者要求极高。每一处手写逻辑都可能在 Verifier 环节被弹回。这也是为什么像 <strong>Isovalent</strong>
                            这样的先驱要推出 **Cilium**——将这些复杂的底层魔法包装成开箱即用的企业级方案。</p>
                        <p class="lang-en hidden" style="font-size: 0.88rem;"><strong>Architect Review:</strong> This
                            lifecycle is rigorous but complex. Every manual logic step could be rejected by the
                            Verifier. This is why <strong>Isovalent</strong> introduced **Cilium**—to package these
                            low-level magics into turnkey solutions.</p>
                    </div>
                </div>
            </div>
            <div class="insight-card">
                <span class="lang-zh"><strong>架构深度：</strong> eBPF 是 Linux 内核的“乐高化”。它将原本封闭、需要数年开发周期的内核功能，通过 Verifier
                    转换成了可以像乐高积木一样按需动态挂载的安全插件。</span>
                <span class="lang-en hidden"><strong>Architecture Depth:</strong> eBPF is the "Lego-ization" of the
                    Linux kernel. It transforms closed, long-cycle kernel features into secure plugins that can be
                    dynamically attached on-demand via the Verifier.</span>
            </div>
        </div>
    </section>


    <!-- Why it matters: Three Pillars -->
    <section class="features">
        <div class="container">
            <span class="golden-badge lang-zh">核心价值 / VALUE PROPOSITION</span>
            <span class="golden-badge lang-en hidden">THREE PILLARS / VALUE PROPOSITION</span>

            <h2 class="section-title lang-zh" style="margin-top:0;">eBPF 三大应用支柱</h2>
            <h2 class="section-title lang-en hidden" style="margin-top:0;">The Three Pillars of eBPF</h2>

            <div class="winston-callout lang-zh"
                style="background: rgba(255,255,255,0.05); color: white; border-left-color: var(--cisco-sky-blue);">
                <strong>价值锚点 / THE VALUE ANCHOR</strong>
                eBPF 并不是为了替代现有的网络或安全工具，而是为了赋予它们<strong>“动态进化的生命力”</strong>。
            </div>
            <div class="winston-callout lang-en hidden"
                style="background: rgba(255,255,255,0.05); color: white; border-left-color: var(--cisco-sky-blue);">
                <strong>THE VALUE ANCHOR</strong>
                eBPF is not intended to replace existing networking or security tools, but to grant them
                <strong>"dynamically evolving vitality."</strong>
            </div>

            <div class="pillars-grid">
                <div class="feature-card" style="border-top-color: var(--cisco-red);">
                    <div class="feature-icon-box" style="background: rgba(226, 35, 26, 0.1);">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--cisco-red)"
                            stroke-width="2">
                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                            <path d="M12 8v4M12 16h.01" stroke-linecap="round" />
                        </svg>
                    </div>
                    <h3 class="lang-zh">下一代安全架构</h3>
                    <h3 class="lang-en hidden">Next-Gen Security</h3>
                    <p class="lang-zh"><strong>核心痛点：</strong> 传统安全软件位于用户态，黑客一旦进入内核便完全失效。且传统审计工具容易绕过。<br><strong>eBPF
                            解法：</strong> 具备 <strong>不可绕过性
                            (Unbypassable)</strong>。直接在内核入口处监控。不仅感知进程行为，更能即时拦截恶意文件打开或容器逃逸，符合 CISSP 纵深防御原则。</p>
                    <p class="lang-en hidden"><strong>Core Pain Points:</strong> Traditional security software resides
                        in user space, failing completely once a hacker enters the kernel. Traditional auditing tools
                        are also easily bypassed.<br><strong>eBPF Solution:</strong> Features
                        <strong>Unbypassable</strong> monitoring directly at kernel entry points. It senses process
                        behavior and instantly intercepts malicious file openings or container escapes, aligning with
                        CISSP defense-in-depth principles.
                    </p>
                    <p class="lang-zh">传统的 EDR/HIDS 依赖于劫持系统调用表，这很容易被 Rootkit 绕过。eBPF 运行在执行路径的更深处，
                        即使攻击者拥有高权限，也无法通过常规手段隐藏其恶意行为。这是真正的<strong>内核级零信任 (Zero Trust at Runtime)</strong>。
                    </p>
                    <p class="lang-en hidden">Traditional EDRs rely on syscall hooking, which Rootkits can bypass. eBPF
                        runs deeper in the execution path.
                        Even with high privileges, attackers cannot hide. This is true <strong>Zero Trust at
                            Runtime</strong>.
                    </p>
                </div>

                <div class="feature-card" style="border-top-color: var(--cisco-blue);">
                    <div class="feature-icon-box" style="background: rgba(4, 159, 217, 0.1);">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--cisco-blue)"
                            stroke-width="2">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                            <circle cx="12" cy="12" r="3" />
                            <path d="M12 5V3M12 21v-2M5 12H3M21 12h-2" stroke-linecap="round" />
                        </svg>
                    </div>
                    <h3 class="lang-zh">极致可观测性</h3>
                    <h3 class="lang-en hidden">Extreme Observability</h3>
                    <p class="lang-zh"><strong>核心痛点：</strong> 业务排障通常需插入日志，带来性能损耗，且无法观测内核层抖动。<br><br><strong>eBPF
                            解法：</strong>
                        无需修改应用代码，透视整个软件栈。生成高精度火焰图，捕获被加密之前的原始请求数据包，提供上帝视角般的系统可见性。<br><br><strong>技术前沿：</strong> 开启
                        <strong>持续剖析 (Continuous Profiling)</strong> 时代。利用 eBPF 的极低开销，实现全量集群的 24/7
                        性能采样，精准定位生产环境中的“毫秒级”性能抖动。
                    </p>
                    <p class="lang-en hidden"><strong>Core Pain Points:</strong> Troubleshooting usually requires
                        inserting logs, causing performance loss and failing to observe kernel-level
                        jitters.<br><br><strong>eBPF Solution:</strong> Perspective across the entire software stack
                        without modifying app code. It generates high-precision flame graphs and captures raw request
                        packets before encryption, providing god-like system visibility.<br><br><strong>Technical
                            Frontier:</strong> Ushering in the <strong>Continuous Profiling</strong> era. Leveraging
                        eBPF's minimal overhead for 24/7 performance sampling across full clusters to pinpoint
                        "millisecond-level" jitters in production.</p>
                </div>

                <div class="feature-card" style="border-top-color: var(--cisco-green);">
                    <div class="feature-icon-box" style="background: rgba(108, 194, 74, 0.1);">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--cisco-green)"
                            stroke-width="2">
                            <rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect>
                            <rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect>
                            <path d="M6 6h.01M6 18h.01" stroke-linecap="round" />
                        </svg>
                    </div>
                    <h3 class="lang-zh">云原生网络加速</h3>
                    <h3 class="lang-en hidden">Networking Acceleration</h3>
                    <p class="lang-zh"><strong>核心痛点：</strong> Kubernetes 依赖的 `iptables`
                        会随着节点增加而变得极其臃肿，导致转发延迟。<br><br><strong>eBPF 解法：</strong> 通过
                        XDP，在协议栈分配缓冲区前即转发包。绕过复杂的通用路径，实现近乎线速的负载均衡，支撑超大规模云原生集群。</p>
                    <p class="lang-en hidden"><strong>Core Pain Points:</strong> `iptables` relied on by Kubernetes
                        becomes extremely bloated as nodes increase, leading to forwarding delays.<br><br><strong>eBPF
                            Solution:</strong> Forwards packets via XDP before buffer allocation. By bypassing complex
                        generic paths, it achieves near wire-speed load balancing, supporting ultra-large-scale
                        cloud-native clusters.</p>
                </div>
            </div>
        </div>
        <div class="insight-card"
            style="margin-top: 50px; text-align: center; border-left: none; border-bottom: 3px solid var(--cisco-blue); background: #ffffff; color: var(--cisco-midnight);">
            <p class="lang-zh" style="font-weight: 600; color: var(--cisco-midnight) !important;">
                这三大支柱共同构成了现代化基础设施的基石。为了更直观地理解这些抽象概念，让我们进入实战模拟：</p>
            <p class="lang-en hidden" style="font-weight: 600; color: var(--cisco-midnight) !important;">These three
                pillars form the foundation of modern infrastructure. To better grasp these concepts, let's move to the
                live simulation:</p>
        </div>
    </section>

    <!-- Interactive Demo Section -->
    <section class="demo-section container" id="demo">
        <span class="golden-badge lang-zh">实验演示 / SIMULATION</span>
        <span class="golden-badge lang-en hidden">KERNEL TERMINAL / SIMULATION</span>

        <h2 class="section-title lang-zh">内核终端：深度交互模拟</h2>
        <h2 class="section-title lang-en hidden">Terminal: eBPF Interactive Demo</h2>

        <div class="control-panel" style="max-width: 900px;">
            <p class="lang-zh" style="margin-bottom: 25px; color: #444; font-size: 1.05rem;">
                点击下方的实验场景，亲历 eBPF 如何在毫秒间改变系统的运行规则与观测深度。
            </p>
            <p class="lang-en hidden" style="margin-bottom: 25px; color: #444; font-size: 1.05rem;">
                Select a scenario to witness how eBPF changes system rules and observation depth.
            </p>

            <div class="terminal-wrapper" id="kernel-terminal">
                <div class="terminal-line">
                    <span class="terminal-prompt">root@linux-kernel:~#</span>
                    <span class="terminal-cursor"></span>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="runXDPNetworkSimulation()" id="ping-btn">
                    <span class="lang-zh">XDP 极速拦截 (网络层)</span>
                    <span class="lang-en hidden">XDP Express Intercept (Network)</span>
                </button>
                <button class="btn btn-primary" onclick="runKprobeSecuritySimulation()" id="sec-btn"
                    style="background-color: var(--cisco-red);">
                    <span class="lang-zh">Kprobe 动态防护 (安全层)</span>
                    <span class="lang-en hidden">Kprobe Dynamic Protection (Security)</span>
                </button>
                <button class="btn" onclick="resetTerminal()" style="background: #666; color: white;">
                    <span class="lang-zh">重置终端</span>
                    <span class="lang-en hidden">Reset Terminal</span>
                </button>
            </div>
        </div>

        <div style="display: flex; gap: 20px; margin-top: 50px; flex-wrap: wrap; justify-content: center;">

            <div class="pipeline-container" style="flex: 1; min-width: 300px; margin: 0;">
                <div class="kernel-zone">VIRTUAL RACETRACK RUNTIME</div>
                <div style="position: absolute; left: 10%; height: 60%; border-left: 2px dashed rgba(255,255,255,0.2);">
                    <span class="checkpoint-tag">XDP Hook</span>
                </div>
                <div style="position: absolute; left: 50%; height: 80%; border-left: 2px dashed rgba(255,255,255,0.2);">
                    <span class="checkpoint-tag">Kprobes</span>
                </div>
                <div id="packet-track" style="position: absolute; width: 100%; height: 100%; top:0; left:0;"></div>
                <div class="ebpf-program">
                    <span class="lang-zh" style="font-weight: 800; font-size: 0.7rem;">内核沙盒</span>
                    <span class="lang-en hidden" style="font-weight: 800; font-size: 0.7rem;">KERNEL SANDBOX</span>
                </div>
            </div>

            <div class="map-dashboard">
                <div class="map-title">Live Map Telemetry (BPF Maps)</div>
                <div class="map-stat">
                    <span class="lang-zh">拦截总数 (XDP):</span>
                    <span class="lang-en hidden">Dropped (XDP):</span>
                    <span id="xdp-count" class="stat-value">0</span>
                </div>
                <div class="map-stat">
                    <span class="lang-zh">违规追踪 (Kprobe):</span>
                    <span class="lang-en hidden">Violations (Kprobe):</span>
                    <span id="kprobe-count" class="stat-value">0</span>
                </div>
                <div class="map-stat">
                    <span class="lang-zh">同步延迟:</span>
                    <span class="lang-en hidden">Sync Latency:</span>
                    <span class="stat-value">&lt;1ms</span>
                </div>
                <div
                    style="font-size: 0.65rem; color: #666; margin-top: 10px; border-top: 1px solid #333; padding-top: 5px;">
                    <span class="lang-zh">内核态与用户态共享内存实时更新</span>
                    <span class="lang-en hidden">Real-time update via Kernel/User shared memory</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Ecosystem Section -->
    <section style="background: var(--cisco-midnight); color: white; padding: 120px 0;">
        <div class="container">
            <span class="golden-badge lang-zh">明星项目 / ECOSYSTEM</span>
            <span class="golden-badge lang-en hidden">INDUSTRY LEADERS / ECOSYSTEM</span>

            <h2 class="section-title lang-zh" style="color:white;">开源项目生态</h2>
            <h2 class="section-title lang-en hidden" style="color:white;">Open-Source Ecosystem</h2>

            <div class="feature-grid-eco">
                <div class="feature-card">
                    <h4 style="color:var(--cisco-blue); margin-bottom:15px; font-size: 1.3rem;">Cilium</h4>
                    <p>
                        <span class="lang-zh"><strong>定义：</strong> 云原生网络的事实标准。</span>
                        <span class="lang-en hidden"><strong>Definition:</strong> The de-facto standard for cloud-native
                            networking.</span>
                        <br>
                        <span class="lang-zh"><strong>核心竞争力：</strong> 基于 eBPF 的高性能网络。它不仅实现了极速负载均衡，更能深入 L7
                            协议进行细粒度的安全控制。</span>
                        <span class="lang-en hidden"><strong>Core Competency:</strong> eBPF-based high-performance
                            networking. It achieves lightning-fast load balancing and deep L7 protocol visibility for
                            fine-grained security.</span>
                    </p>
                </div>

                <div class="feature-card">
                    <h4 style="color:var(--cisco-red); margin-bottom:15px; font-size: 1.3rem;">Tetragon</h4>
                    <p>
                        <span class="lang-zh"><strong>定义：</strong> 实时内核检测与拦截引擎。</span>
                        <span class="lang-en hidden"><strong>Definition:</strong> Real-time kernel-level detection and
                            enforcement engine.</span>
                        <br>
                        <span class="lang-zh"><strong>核心竞争力：</strong>
                            它的强大在于“Enforcement”。在黑客触发敏感系统调用的瞬间，直接从内核层切断进程。</span>
                        <span class="lang-en hidden"><strong>Core Competency:</strong> Its power lies in
                            "Enforcement"—instantly killing processes at the kernel layer the moment a sensitive syscall
                            is triggered.</span>
                    </p>
                </div>

                <div class="feature-card">
                    <h4 style="color:var(--cisco-green); margin-bottom:15px; font-size: 1.3rem;">BPFtrace</h4>
                    <p>
                        <span class="lang-zh"><strong>定义：</strong> 内核版 AWK。</span>
                        <span class="lang-en hidden"><strong>Definition:</strong> High-level tracing language for Linux,
                            like AWK for the kernel.</span>
                        <br>
                        <span class="lang-zh"><strong>核心竞争力：</strong> 脚本化探针编写。可以在 10
                            秒钟内编写一个监控磁盘延迟或函数执行次数的探针，无需复杂编译。</span>
                        <span class="lang-en hidden"><strong>Core Competency:</strong> Scriptable probe creation. Write
                            a probe to monitor disk latency or function call frequency in 10 seconds without complex
                            compilation.</span>
                    </p>
                </div>

                <div class="feature-card">
                    <h4 style="color:#56CCF2; margin-bottom:15px; font-size: 1.3rem;">SkyWalking</h4>
                    <p>
                        <span class="lang-zh"><strong>定义：</strong> 应用性能管理 (APM) 领航者。</span>
                        <span class="lang-en hidden"><strong>Definition:</strong> A leading Application Performance
                            Management (APM) system.</span>
                        <br>
                        <span class="lang-zh"><strong>核心竞争力：</strong> 无侵入跨服务追踪。即使没有嵌入 SDK，也能通过内核探针自动绘制出复杂的调用拓扑图。</span>
                        <span class="lang-en hidden"><strong>Core Competency:</strong> Non-intrusive cross-service
                            tracing. Automatically map complex call topologies via kernel probes, even without embedding
                            SDKs.</span>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Isovalent Section -->
    <section style="background: #ffffff;">
        <div class="container">
            <span class="golden-badge lang-zh">产业先驱 / LEADERSHIP</span>
            <span class="golden-badge lang-en hidden">ISOVALENT & CISCO / LEADERSHIP</span>

            <h2 class="section-title lang-zh">Isovalent 的工业化贡献：开启 eBPF 的“即战力”时代</h2>
            <h2 class="section-title lang-en hidden">Isovalent's Industrial Contribution: The Era of "Ready-to-Use" eBPF
            </h2>

            <div class="card isovalent-main-card"
                style="border-left-width: 8px; border-left-color: var(--cisco-blue); background: #fdfdfd; padding: 50px;">
                <div class="isovalent-header-box"
                    style="display: flex; align-items: center; gap: 25px; margin-bottom: 35px;">
                    <div style="background: var(--cisco-midnight); padding: 18px; border-radius: 14px;">
                        <svg width="45" height="45" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                        </svg>
                    </div>
                    <div>
                        <h3 class="lang-zh" style="color: var(--cisco-midnight); font-size: 2rem;">Isovalent：eBPF 的灵魂推动者
                        </h3>
                        <h3 class="lang-en hidden" style="color: var(--cisco-midnight); font-size: 2rem;">Isovalent: The
                            Soul of eBPF</h3>
                    </div>
                </div>

                <div class="detail-grid" style="margin-bottom: 50px;">
                    <div>
                        <h4 class="lang-zh" style="color: var(--cisco-blue); margin-bottom: 15px; font-size: 1.25rem;">
                            1. 开源引领与内核深耕</h4>
                        <h4 class="lang-en hidden"
                            style="color: var(--cisco-blue); margin-bottom: 15px; font-size: 1.25rem;">1. Open Source
                            Leadership & Deep Kernel Innovation</h4>
                        <p class="lang-zh" style="font-size: 1rem; color: #555; margin-bottom: 15px;">Isovalent 是
                            **Cilium** 的创建者，成功推动其成为 CNCF 毕业项目。他们通过 **Tetragon** 扩展了安全边界，同时持续贡献 Linux 内核上游代码，使 eBPF
                            从简单的网络过滤演进为全栈安全/观测引擎。</p>
                        <p class="lang-en hidden" style="font-size: 1rem; color: #555; margin-bottom: 15px;">Isovalent
                            is the creator of **Cilium**, driving its graduation as a CNCF project. They expanded
                            security boundaries via **Tetragon** while contributing to the upstream Linux kernel,
                            evolving eBPF into a full-stack security and observability engine.</p>
                    </div>
                    <div>
                        <h4 class="lang-zh" style="color: var(--cisco-green); margin-bottom: 15px; font-size: 1.25rem;">
                            2. 标准制定与社区教育</h4>
                        <h4 class="lang-en hidden"
                            style="color: var(--cisco-green); margin-bottom: 15px; font-size: 1.25rem;">2.
                            Standardization & Community Education</h4>
                        <p class="lang-zh" style="font-size: 1rem; color: #555; margin-bottom: 15px;">2021 年，Isovalent
                            联合 Meta、Google 等成立 **eBPF 基金会**。他们维护核心文档项目并发布权威报告，将 eBPF 定位为重定义网络、安全、追踪的变革性技术。</p>
                        <p class="lang-en hidden" style="font-size: 1rem; color: #555; margin-bottom: 15px;">In 2021,
                            Isovalent co-founded the **eBPF Foundation** with Meta, Google, and others. They maintain
                            core documentation and publish authoritative reports, positioning eBPF as a technology
                            redefining networking, security, and tracing.</p>
                    </div>
                </div>

                <h3 class="lang-zh"
                    style="color: var(--cisco-midnight); font-size: 1.6rem; margin-bottom: 25px; border-bottom: 2px solid #eee; padding-bottom: 10px;">
                    降低门槛：从“写代码”到“用方案”</h3>
                <h3 class="lang-en hidden"
                    style="color: var(--cisco-midnight); font-size: 1.6rem; margin-bottom: 25px; border-bottom: 2px solid #eee; padding-bottom: 10px;">
                    Lowering Barriers: From "Coding" to "Solutions"</h3>

                <div class="grid-2x2">
                    <div class="feature-box" style="padding: 20px; box-shadow: none; border-color: #eee;">
                        <h5 class="lang-zh" style="color: var(--cisco-blue); margin-bottom: 10px;">简化开发与部署</h5>
                        <h5 class="lang-en hidden" style="color: var(--cisco-blue); margin-bottom: 10px;">Simplified Dev
                            & Deployment</h5>
                        <p class="lang-zh" style="font-size: 0.9rem;"><strong>BPF CO-RE：</strong> 彻底解决了传统 eBPF
                            必须在目标机器重编译的痛点，实现“一次编译，到处运行”。<br><strong>无 Sidecar 服务网格：</strong>
                            摒弃传统复杂的代理模型，直接在内核处理网络逻辑，极大降低了资源消耗。</p>
                        <p class="lang-en hidden" style="font-size: 0.9rem;"><strong>BPF CO-RE:</strong> Solved the pain
                            of recompilation on target machines, achieving "Compile Once, Run
                            Everywhere."<br><strong>Sidecar-less Mesh:</strong> Processes network logic directly in the
                            kernel, significantly reducing resource overhead.</p>
                    </div>
                    <div class="feature-box" style="padding: 20px; box-shadow: none; border-color: #eee;">
                        <h5 class="lang-zh" style="color: var(--cisco-green); margin-bottom: 10px;">提升性能与观测</h5>
                        <h5 class="lang-en hidden" style="color: var(--cisco-green); margin-bottom: 10px;">Performance &
                            Observability</h5>
                        <p class="lang-zh" style="font-size: 0.9rem;"><strong>原生高效：</strong> 通过 eBPF 替换传统的
                            iptables，人们无需再深入内核源码即可获得极速网络转发能力。<br><strong>全栈洞察：</strong> 提供现成的内核级遥测看板，将原本晦涩的内核数据转化为易懂的指标。
                        </p>
                        <p class="lang-en hidden" style="font-size: 0.9rem;"><strong>Native Efficiency:</strong>
                            Replacing iptables with eBPF offers high-speed forwarding without deep kernel
                            changes.<br><strong>Full-stack Insight:</strong> Turn obscure kernel data into clear metrics
                            with turnkey kernel-level telemetry dashboards.</p>
                    </div>
                    <div class="feature-box"
                        style="padding: 20px; box-shadow: none; border-color: var(--cisco-blue); background: rgba(4, 159, 217, 0.02);">
                        <h5 class="lang-zh" style="color: var(--cisco-blue); margin-bottom: 10px;">技术深研：Sidecar-less 革命
                        </h5>
                        <h5 class="lang-en hidden" style="color: var(--cisco-blue); margin-bottom: 10px;">Deep Tech:
                            Sidecar-less Revolution</h5>
                        <p class="lang-zh" style="font-size: 0.85rem; color: #555;">
                            <strong>传统模式：</strong>每个 Pod 需运行一个 Envoy 代理（Sidecar），网络包在用户态和内核态之间反复跳转，产生巨大的 CPU
                            和延迟开销。<br><br>
                            <strong>eBPF 模式：</strong>程序直接驻留在内核协议栈。流量拦截与可观测性在内核层“一跳直达”，不再需要 Sidecar 进程，资源消耗降低
                            <strong>70%</strong> 以上。
                        </p>
                        <p class="lang-en hidden" style="font-size: 0.85rem; color: #555;">
                            <strong>Traditional:</strong> Each Pod runs an Envoy proxy (Sidecar). Packets bounce between
                            user and kernel space, incurring high CPU and latency.<br><br>
                            <strong>eBPF:</strong> Resides directly in the kernel stack. Interception and observability
                            occur in a "single hop," eliminating Sidecar processes and cutting resource usage by over
                            <strong>70%</strong>.
                        </p>
                    </div>
                    <div class="feature-box" style="padding: 20px; box-shadow: none; border-color: #eee;">
                        <h5 class="lang-zh" style="color: var(--cisco-red); margin-bottom: 10px;">企业级即战平台</h5>
                        <h5 class="lang-en hidden" style="color: var(--cisco-red); margin-bottom: 10px;">
                            Enterprise-Ready Platform</h5>
                        <p class="lang-zh" style="font-size: 0.9rem;"><strong>零信任方案：</strong> 将复杂的安全拦截包装成易用的策略引擎。Cisco
                            收购 Isovalent 后，eBPF 正式成为 **Security Cloud** 的底层核心，让内核级超能力变为企业现成的安全防线。</p>
                        <p class="lang-en hidden" style="font-size: 0.9rem;"><strong>Zero Trust:</strong> Packages
                            complex security into easy-to-use policies. Post-acquisition, eBPF is a core part of Cisco's
                            **Security Cloud**, offering turnkey enterprise defense.</p>
                    </div>
                </div>

                <div class="insight-card" style="margin-top: 40px; background: rgba(4, 159, 217, 0.03);">
                    <span class="lang-zh"><strong>架构师视角：</strong> Isovalent 的核心价值在于<strong>抽象了 eBPF
                            的底层复杂性</strong>。随着他们加入 Cisco 战略版图，原本需要顶级 C 程序员手写数百行代码实现的内核逻辑，现在只需一套现成的企业级方案即可轻松部署，这标志着 eBPF
                        真正走向了工业主流化。</span>
                    <span class="lang-en hidden"><strong>Architect's View:</strong> Isovalent's value lies in
                        **abstracting eBPF's complexity**. Now part of Cisco, kernel logic once requiring expert C
                        coding can be deployed via turnkey solutions, marking eBPF's mainstream adoption.</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Global Tech Giants Case Studies -->
    <section style="background: #fdfdfd; border-top: 1px solid #eee;">
        <div class="container">
            <span class="golden-badge lang-zh">实战案例 / CASE STUDIES</span>
            <span class="golden-badge lang-en hidden">GLOBAL ADOPTION / CASE STUDIES</span>

            <h2 class="section-title lang-zh">全球技术巨头的 eBPF 实战</h2>
            <h2 class="section-title lang-en hidden">eBPF in Action: Global Tech Giants</h2>

            <p class="lang-zh" style="text-align: center; max-width: 800px; margin: -20px auto 40px;">
                eBPF 不再停留在实验室。从硅谷到杭州，它已成为驱动下一代超大规模基础设施的核心引擎。
            </p>
            <p class="lang-en hidden" style="text-align: center; max-width: 800px; margin: -20px auto 40px;">
                eBPF is no longer confined to the lab. From Silicon Valley to Hangzhou, it has become the core engine
                driving next-gen hyperscale infrastructure.
            </p>

            <div class="case-study-grid">
                <div class="case-study-card">
                    <div class="case-study-meta">
                        Google
                        <span class="lang-zh">云原生</span>
                        <span class="lang-en hidden">Cloud Native</span>
                    </div>
                    <p>
                        <span class="lang-zh">Google 选择 <strong>Cilium</strong> 作为 GKE Dataplane V2 的默认数据平面。通过 eBPF，GKE
                            实现了高性能的网络策略执行与透明的服务观测。</span>
                        <span class="lang-en hidden">Google chose <strong>Cilium</strong> as the default for GKE
                            Dataplane V2, achieving high-performance network policy enforcement and transparent
                            observability via eBPF.</span>
                    </p>
                </div>

                <div class="case-study-card">
                    <div class="case-study-meta">
                        Meta (Facebook)
                        <span class="lang-zh">基础架构</span>
                        <span class="lang-en hidden">Infrastructure</span>
                    </div>
                    <p>
                        <span class="lang-zh">Meta 开源了 <strong>Katran</strong>，一个基于 eBPF 的高性能四层负载均衡器。它支撑了 Facebook
                            全球海量的入站流量分发。部署 <strong>Strobelight</strong> 剖析引擎，实现全量服务器的 CPU 周期削减，等效于为 Meta 的核心业务节省了
                            <strong>10-20%</strong> 的服务器需求。</span>
                        <span class="lang-en hidden">Meta open-sourced <strong>Katran</strong> (L4 LB) and deployed
                            <strong>Strobelight</strong> for fleet-wide CPU profiling, effectively reducing server
                            requirements by <strong>10-20%</strong>.</span>
                    </p>
                </div>

                <div class="case-study-card">
                    <div class="case-study-meta">
                        Netflix
                        <span class="lang-zh">性能工程</span>
                        <span class="lang-en hidden">Performance</span>
                    </div>
                    <p>
                        <span class="lang-zh">Netflix 的性能工程团队利用 <strong>bpftrace</strong> 监控数万台服务器。eBPF
                            帮助他们实时定位云端资源竞争与磁盘 IO 瓶颈。</span>
                        <span class="lang-en hidden">Netflix’s performance team uses <strong>bpftrace</strong> to
                            monitor tens of thousands of servers, pinpointing cloud resource contention and disk I/O
                            bottlenecks in real-time.</span>
                    </p>
                </div>

                <div class="case-study-card">
                    <div class="case-study-meta">
                        Microsoft
                        <span class="lang-zh">跨平台</span>
                        <span class="lang-en hidden">Cross-Platform</span>
                    </div>
                    <p>
                        <span class="lang-zh">Microsoft 正将 eBPF 引入 <strong>Windows 内核</strong>，并广泛应用于 Azure 安全防御。这意味着
                            eBPF 正在成为通用的操作系统编程范式。</span>
                        <span class="lang-en hidden">Microsoft is bringing eBPF to the <strong>Windows Kernel</strong>
                            and Azure security, signaling eBPF's rise as a universal OS programming paradigm.</span>
                    </p>
                </div>

                <div class="case-study-card">
                    <div class="case-study-meta">
                        Alibaba
                        <span class="lang-zh">云效能</span>
                        <span class="lang-en hidden">Cloud Efficiency</span>
                    </div>
                    <p>
                        <span class="lang-zh">阿里巴巴在 <strong>云原生容器网络</strong> 中大规模采用 eBPF。通过优化 Linux 协议栈路径，显著降低了电商双 11
                            巅峰期间的请求延迟。利用 eBPF 实现自适应 L7 负载均衡，将单位基础设施成本显著降低了 <strong>19%</strong>。</span>
                        <span class="lang-en hidden">Alibaba utilizes eBPF at scale in container networking,
                            significantly reducing latency during "Double 11" peaks and cutting infrastructure costs by
                            <strong>19%</strong>.</span>
                    </p>
                </div>

                <div class="case-study-card">
                    <div class="case-study-meta">
                        ByteDance (TikTok)
                        <span class="lang-zh">可观测性</span>
                        <span class="lang-en hidden">Observability</span>
                    </div>
                    <p>
                        <span class="lang-zh">字节跳动利用 eBPF 构建了**统一的可观测性底座**。在海量微服务场景下，无需重启应用即可实现秒级的链路追踪与异常告警。</span>
                        <span class="lang-en hidden">ByteDance built a unified observability platform with eBPF,
                            enabling second-level trace and alerts for massive microservices without application
                            restarts.</span>
                    </p>
                </div>

                <div class="case-study-card">
                    <div class="case-study-meta">
                        Datadog
                        <span>CPU -35%</span>
                    </div>
                    <p>
                        <span class="lang-zh">通过 eBPF 自动发现和映射服务依赖，无需修改任何代码即可实现全栈监控，并使 CPU 占用率降低了
                            <strong>35%</strong>。</span>
                        <span class="lang-en hidden">Automatically discovers and maps service dependencies via eBPF,
                            enabling full-stack monitoring without code changes and reducing CPU usage by
                            <strong>35%</strong>.</span>
                    </p>
                </div>

                <div class="case-study-card">
                    <div class="case-study-meta">
                        OpenAI
                        <span class="lang-zh">算力治理</span>
                        <span class="lang-en hidden">Compute Governance</span>
                    </div>
                    <p>
                        <span class="lang-zh">OpenAI 利用 eBPF 构建了针对数万个 GPU 节点的**全栈可观测性底座**。在不改动 AI 训练镜像的前提下，通过内核探针实时监控 RDMA 通讯与网络微抖动，精准捕获导致大模型训练中断的瓶颈，使算力利用率提升了 <strong>20%</strong> 以上。</span>
                        <span class="lang-en hidden">OpenAI leverages eBPF to build a **full-stack observability base** for tens of thousands of GPU nodes. By monitoring RDMA traffic and network jitters via kernel probes without modifying images, they pinpoint bottlenecks that stall LLM training, boosting compute efficiency by over <strong>20%</strong>.</span>
                    </p>
                </div>
                <div class="case-study-card">
                    <div class="case-study-meta">
                        Cloudflare
                        <span class="lang-zh">DDoS 防御</span>
                        <span class="lang-en hidden">DDoS Defense</span>
                    </div>
                    <p>
                        <span class="lang-zh">
                            <strong>核心挑战：</strong> 面对 Tbps 级的 DDoS 攻击，传统内核协议栈因频繁的内存分配和上下文切换导致 CPU 耗尽。<br>
                            <strong>eBPF 解法：</strong> 采用 <strong>XDP (eXpress Data Path)</strong>
                            在网卡驱动层直接介入。恶意包在分配内核内存之前即被丢弃，实现极速防御。<br>
                        </span>
                        <span class="lang-en hidden">
                            <strong>Challenge:</strong> Tbps-scale DDoS attacks overwhelm traditional kernel stacks due
                            to frequent memory allocation and context switching.<br>
                            <strong>Solution:</strong> <strong>XDP (eXpress Data Path)</strong> intervenes at the NIC
                            driver layer. Malicious packets are dropped before kernel memory allocation, enabling
                            lightning-fast defense.<br>
                        </span>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!--2025 INDUSTRY REPORT-->
    <section class="container" style="padding-top: 0;">
        <div class="report-highlight">
            <h2 class="section-title lang-zh">2025 技术趋势</h2>
            <h2 class="section-title lang-en hidden">2025 Tech Trends</h2>

            <p class="lang-zh" style="color: #444; margin-bottom: 30px;">
                eBPF 已经跨越了早期采用者阶段，成为基础设施团队的<strong>战略平台首选</strong>。它通过重塑内核可编程性，正在定义下一代基础设施平台。
            </p>
            <p class="lang-en hidden" style="color: #444; margin-bottom: 30px;">
                eBPF has crossed the early adopter stage to become the <strong>strategic platform of choice</strong> for
                infrastructure teams. By reshaping kernel programmability, it is defining the next-gen infrastructure
                platform.
            </p>

            <div class="metric-grid">
                <div class="metric-card">
                    <span class="value">4X</span>
                    <span class="label lang-zh">网络包处理性能提升</span>
                    <span class="label lang-en hidden">Network Packet Throughput Boost</span>
                </div>
                <div class="metric-card">
                    <span class="value">&lt;2%</span>
                    <span class="label lang-zh">极致传感器 CPU 开销</span>
                    <span class="label lang-en hidden">Ultra-low Sensor CPU Overhead</span>
                </div>
                <div class="metric-card">
                    <span class="value">Zero</span>
                    <span class="label lang-zh">代码侵入式可观测性</span>
                    <span class="label lang-en hidden">Zero-intrusion Observability</span>
                </div>
            </div>

            <div class="detail-grid" style="margin-top: 30px;">
                <div class="card" style="border-top-color: var(--cisco-midnight);">
                    <h4 class="lang-zh">虚拟化网络革命：Netkit</h4>
                    <h4 class="lang-en hidden">Virtual Network Revolution: Netkit</h4>
                    <p class="lang-zh" style="font-size: 0.9rem;">
                        <strong>Netkit</strong>已成为2025年解决容器网络“隐形开销”的战略性技术。它利用eBPF的可编程性，彻底重塑了大规模集群的数据转发路径。
                        <br> <strong>1.突破veth瓶颈</strong> 传统容器网络依赖 veth
                        设备对，数据包需多次跳转内核协议栈，伴随频繁的内存拷贝与上下文切换。这种“协议栈税”导致延迟增加，限制了吞吐量，使其无法达到物理机原生性能。
                        <br> <strong>2.核心进化：内存指针重定向</strong>，自Linux 6.7+ 引入以来，<strong>Netkit</strong>放弃了虚拟设备抽象，改用eBPF的
                        <strong>bpf_redirect_peer</strong>机制。通过直接在内核层进行内存指针转换，Netkit实现了数据包的<strong>“一跳直达”</strong>，绕过了复杂的通用路径。
                        <br>
                        <strong>3.极致性能红利零拷贝转发</strong>：使容器网络性能真正匹配物理主机水平，实现近乎线速的转发。相比Sidecar模式，网络资源消耗降低70%以上，并削减了约20%的内核软中断（Softirq）负载。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.9rem;"><strong>Netkit</strong> has become a strategic
                        technology for addressing the "hidden overhead" of container networking by 2025. It leverages
                        the programmability of eBPF to completely reshape the data forwarding path for large-scale
                        clusters.
                        <br> <strong>1. Overcoming the Veth Bottleneck:</strong> Traditional container networking relies
                        on veth device pairs, requiring packets to hop multiple times across the kernel protocol stack,
                        accompanied by frequent memory copies and context switches. This "protocol stack tax" increases
                        latency, limiting throughput and preventing it from reaching the native performance of physical
                        machines.
                        <br><strong>2. Core Evolution: Memory Pointer Redirection:</strong> Since its introduction in
                        Linux 6.7+, <strong>Netkit</strong> has abandoned virtual device abstraction and adopted eBPF's
                        <strong>bpf_redirect_peer</strong> mechanism. By directly performing memory pointer translation
                        at the kernel level, Netkit achieves<strong> "one-hop" packet delivery</strong>, bypassing
                        complex general paths.
                        <br><strong>3. Ultimate Performance Benefits: Zero-copy forwarding:</strong> Enables container
                        network performance to truly match that of physical hosts, achieving near-line-speed
                        forwarding.Resource cost reduction: Compared to Sidecar mode, network resource consumption is
                        reduced by more than 70%, and kernel softirq load is reduced by about 20%.
                    </p>
                </div>
                <div class="card" style="border-top-color: var(--cisco-orange);">
                    <h4 class="lang-zh">AI 调度优化：Sched_ext</h4>
                    <h4 class="lang-en hidden">AI Scheduling Optimization: Sched_ext</h4>
                    <p class="lang-zh" style="font-size: 0.9rem;"><strong>Sched_ext</strong>
                        是一项引入Linux内核（自v6.12版本起）的革命性技术，它被定义为一个可扩展的调度器类，允许开发者利用 eBPF
                        动态地定义、测试和部署自定义的CPU调度策略。<br>在AI训练与大语言模型（LLM）推理等高性能计算场景中，传统的通用调度器（如CFS（完全公平调度器）和EEVDF（最早符合虚拟截止日期优先调度器））往往难以应对极端的并发与时延需求，而
                        <strong>Sched_ext</strong> 正是打破这一瓶颈的关键。<br>通过
                        <strong>Sched_ext</strong>，基础设施团队可以编写自定义的BPF程序作为同步回调，直接参与内核调度决策。这使得系统能够根据AI任务的优先级和资源需求，实现精准的CPU亲和性管理。<br>这种精准的调度能将<strong>缓存未命中率
                            (Cache Misses) 降低约 15%，</strong>并显著压低<strong>P99长尾延迟</strong>，这对于实时响应的生成式AI服务至关重要。</p>
                    <p class="lang-en hidden" style="font-size: 0.9rem;"><strong>Sched_ext</strong> is a revolutionary
                        technology introduced into the Linux kernel (since version v6.12). Defined as an extensible
                        scheduler class, it allows developers to dynamically define, test, and deploy custom CPU
                        scheduling policies using eBPF.<br>In high-performance computing scenarios such as AI training
                        and Large Language Model (LLM) inference, traditional general-purpose schedulers (such as CFS
                        (Completely Fair Scheduler) and EEVDF (Earliest Meeting Virtual Deadline First Scheduler)) often
                        struggle to handle extreme concurrency and latency demands. <strong>Sched_ext</strong> is key to
                        overcoming this bottleneck. <br>With <strong>Sched_ext</strong>, infrastructure teams can write
                        custom BPF programs as synchronization callbacks to directly participate in kernel scheduling
                        decisions. This enables the system to achieve precise CPU affinity management based on the
                        priority and resource requirements of AI tasks. <br>This precise scheduling can <strong>reduce
                            cache misses by approximately 15%</strong> and significantly reduce <strong>P99 long-tail
                            latency</strong>, which is crucial for real-time generative AI services. </p>
                </div>
                <div class="card" style="border-top-color: var(--cisco-blue);">
                    <h4 class="lang-zh">LLM 安全与可观测性</h4>
                    <h4 class="lang-en hidden">LLM Security & Observability</h4>
                    <p class="lang-zh" style="font-size: 0.9rem;">
                        LLM安全与可观测性已成为eBPF技术的重要应用方向，通过在网络层实时追踪应用程序与外部大语言模型（LLM）的交互，能够精准捕获API请求数据与延迟，构建起<strong>无感的生成式AI安全防线。</strong><br>eBPF通过Uprobes动态挂钩用户态SSL库函数，在数据被加密之前或解密之后直接访问缓冲区内存，从而实现在TLS边界的零侵入明文解析，无需解密代理或提供证书。这使得安全团队能够实时审计<strong>提示词（Prompts）</strong>中的敏感PII数据或注入攻击，构建不可绕过的内核级防线。<br>在性能剖析方面，eBPF以纳秒级精度捕获<strong>TTFT（首字延迟）与ITL（Token
                            间延迟）</strong>，并能关联分布式链路中的CPU与GPU节点，精准诊断算力停顿与I/O瓶颈。<br>这种“零开发侵入”的方案，将复杂的黑盒交互转变为透明可编程的遥测数据，确保了AI
                        Agent在生产环境中的安全合规与全栈可见。
                    </p>
                    <p class="lang-en hidden" style="font-size: 0.9rem;">LLM security and observability have become key
                        application areas for eBPF technology. By tracking the interaction between applications and
                        external Large Language Models (LLMs) in real time at the network layer, eBPF can accurately
                        capture API request data and latency, building a <strong>seamless generative AI security
                            defense.</strong><br>eBPF dynamically hooks user-space SSL library functions through
                        Uprobes, directly accessing buffer memory before or after data encryption, thus achieving
                        zero-intrusion plaintext parsing at the TLS boundary without the need for decryption proxies or
                        certificates. This allows security teams to audit sensitive PII data or injection attacks in
                        <strong>prompts</strong> in real time, building an unbreakable kernel-level defense. <br>In
                        terms of performance profiling, eBPF captures <strong>TTFT (Title-First-Word Latency) and ITL
                            (Inter-Token Latency)</strong> with nanosecond precision and can correlate CPU and GPU nodes
                        in distributed links to accurately diagnose computational stalls and I/O bottlenecks. This
                        "zero-intrusion" solution transforms complex black-box interactions into transparent,
                        programmable telemetry data, ensuring the security compliance and full-stack visibility of the
                        AI Agent in production environments.</p>
                </div>
            </div>

            <div class="winston-callout lang-zh"
                style="background: var(--cisco-blue); color: white; padding: 40px; text-align: center; border-radius: 12px; margin-top: 40px;">
                <h3 style="font-size: 1.8rem; margin-bottom: 15px;">倡议行动：开启内核编程新篇章</h3>
                <p style="opacity: 0.9; margin-bottom: 25px;">eBPF 正在成为现代基础设施的乐高积木。无论您是追求极致性能还是极致安全，现在就是拥抱 eBPF 平台的时刻。
                </p>
            </div>
            <div class="winston-callout lang-en hidden"
                style="background: var(--cisco-blue); color: white; padding: 40px; text-align: center; border-radius: 12px; margin-top: 40px;">
                <h3 style="font-size: 1.8rem; margin-bottom: 15px;">Call to Action: A New Chapter in Kernel Programming
                </h3>
                <p style="opacity: 0.9; margin-bottom: 25px;">eBPF is becoming the Lego of modern infrastructure.
                    Whether you seek peak performance or ultimate security, the time to embrace the eBPF platform is
                    now.</p>
            </div>
        </div>
    </section>

    <!--The Empowering End (赋能式结尾) -->
    <section
        style="background: var(--cisco-dark-blue); color: white; padding: 80px 0; text-align: center; border-bottom: 2px solid var(--cisco-blue);">
        <div class="container">
            <h2 class="lang-zh" style="font-size: 2rem; margin-bottom: 20px;">技术深远影响：从“被动防御”到“主动可编程”</h2>
            <h2 class="lang-en hidden" style="font-size: 2rem; margin-bottom: 20px;">Technological Impact: From Passive
                Defense to Active Programmability</h2>

            <p class="lang-zh" style="max-width: 800px; margin: 0 auto; opacity: 0.8; line-height: 1.8;">
                掌握 eBPF 并不意味着您需要成为一名内核黑客，而是意味着您拥有了<strong>重塑基础设施边界的能力</strong>。在 Isovalent 与 Cisco 的共同推动下，这种超能力已触手可及。
            </p>
            <p class="lang-en hidden" style="max-width: 800px; margin: 0 auto; opacity: 0.8; line-height: 1.8;">
                Mastering eBPF doesn't mean you need to be a kernel hacker; it means you possess the <strong>power to
                    reshape infrastructure boundaries</strong>. Driven by Isovalent and Cisco, this superpower is now
                within reach.
            </p>

            <div style="margin-top: 40px; text-align: center;">
                <button class="btn btn-primary lang-zh" onclick="scrollToDemo()">立即开启内核探索之旅</button>
                <button class="btn btn-primary lang-en hidden" onclick="scrollToDemo()">Start Your Kernel Exploration
                    Now</button>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="container" style="background: white; border-top: 1px solid #eee;">
        <h2 class="section-title lang-zh">常见问题解答 (FAQ)</h2>
        <h2 class="section-title lang-en hidden">Frequently Asked Questions (FAQ)</h2>

        <div class="faq-grid">
            <div class="card">
                <h4 class="lang-zh text-cisco-blue">eBPF 会让系统变慢吗？</h4>
                <h4 class="lang-en hidden text-cisco-blue">Does eBPF slow down the system?</h4>
                <p class="lang-zh" style="font-size: 0.95rem; color: #555; margin-top:10px;">
                    **答案是否定的。** 现代 eBPF 通过 JIT（即时编译）转化为原生指令。事实上，由于避免了用户态轮询或庞大内核模块的开销，它往往比传统方案更快。
                </p>
                <p class="lang-en hidden" style="font-size: 0.95rem; color: #555; margin-top:10px;">
                    **The answer is no.** Modern eBPF translates into native instructions via JIT. In fact, by avoiding
                    userspace polling or bulky kernel module overhead, it's often faster than traditional solutions.
                </p>
            </div>
            <div class="card">
                <h4 class="lang-zh text-cisco-blue">验证器 (Verifier) 真的能保证系统不崩溃吗？</h4>
                <h4 class="lang-en hidden text-cisco-blue">Does the Verifier really guarantee no system crashes?</h4>
                <p class="lang-zh" style="font-size: 0.95rem; color: #555; margin-top:10px;">
                    **是的。** 验证器会强制执行安全准则：代码必须是有限长度的、内存访问受限、指针合法。如果代码不符合“安全指纹”，内核会拒绝加载。
                </p>
                <p class="lang-en hidden" style="font-size: 0.95rem; color: #555; margin-top:10px;">
                    **Yes.** The verifier enforces safety guidelines: code must be finite, memory access restricted, and
                    pointers valid. If code doesn't match the "security fingerprint," the kernel rejects it.
                </p>
            </div>
        </div>
    </section>

    <!--References-->
    <section class="container" style="padding: 80px 20px; border-top: 1px solid #eee;">
        <h2 class="section-title lang-zh">参考资料 (Reference)</h2>
        <h2 class="section-title lang-en hidden">Reference</h2>

        <ul class="reference-list">
            <li class="reference-item"><a href="https://ebpf.io/" target="_blank">ebpf.io - Introduction, Tutorials &
                    Community Hub</a></li>
            <li class="reference-item"><a
                    href="https://ebpf.io/books/buzzing-across-space-illustrated-childrens-guide-to-ebpf.pdf"
                    target="_blank">A Buzzing Space: Illustrated Children's Guide to eBPF</a></li>
            <li class="reference-item"><a href="https://docs.ebpf.io/" target="_blank">eBPF Documentation Library -
                    Concepts and API</a></li>
            <li class="reference-item"><a href="https://docs.ebpf.io/linux/" target="_blank">eBPF for Linux -
                    Implementation Details</a></li>
            <li class="reference-item"><a href="https://ebpf.io/what-is-ebpf/" target="_blank">What is eBPF? - Deep Dive
                    Exploration</a></li>
            <li class="reference-item"><a
                    href="https://www.linuxfoundation.org/hubfs/eBPF/The_State_of_eBPF25_111925.pdf"
                    target="_blank">Linux Foundation: The State of eBPF 2025 Report</a></li>
            <li class="reference-item"><a href="https://arxiv.org/html/2410.00026v1"
                    target="_blank">The eBPF Runtime in the Linux Kernel</a></li>
            <li class="reference-item"><a href="https://www.tigera.io/learn/guides/ebpf/" target="_blank">Tigera: The
                    Ultimate Guide to eBPF Networking</a></li>
            <li class="reference-item"><a
                    href="https://www.ciscolive.com/c/dam/r/ciscolive/emea/docs/2025/pdf/LTRSEC-2274.pdf"
                    target="_blank">Cisco Live 2025: LTRSEC-2274 - Hands-on eBPF</a></li>
            <li class="reference-item"><a
                    href="https://www.ciscolive.com/c/dam/r/ciscolive/emea/docs/2025/pdf/BRKSEC-2169.pdf"
                    target="_blank">Cisco Live 2025: BRKSEC-2169 - Security Architecture</a></li>
            <li class="reference-item"><a
                    href="https://www.ciscolive.com/c/dam/r/ciscolive/global-event/docs/2025/pdf/BRKSEC-2167.pdf"
                    target="_blank">Cisco Live 2025: BRKSEC-2167 - Zero Trust with eBPF</a></li>
            <li class="reference-item"><a href="https://isovalent.com/blog/post/why-replace-iptables-with-ebpf/"
                    target="_blank">Isovalent: Why Replace iptables with eBPF?</a></li>
            <li class="reference-item"><a href="https://www.youtube.com/watch?v=Wb_vD3XZYOA" target="_blank">Technical Deep Dive: eBPF Mechanism and Performance (Video)</a></li>
        </ul>
    </section>
    <footer>
        <div class="container">
            <div style="margin-bottom: 30px;">
                <svg viewBox="0 0 64 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M14 24V16" stroke="#fff" stroke-width="3" stroke-linecap="round" />
                    <path d="M22 24V10" stroke="#fff" stroke-width="3" stroke-linecap="round" />
                    <path d="M30 24V14" stroke="#fff" stroke-width="3" stroke-linecap="round" />
                    <path d="M38 24V8" stroke="#fff" stroke-width="3" stroke-linecap="round" />
                    <path d="M46 24V14" stroke="#fff" stroke-width="3" stroke-linecap="round" />
                    <path d="M54 24V19" stroke="#fff" stroke-width="3" stroke-linecap="round" />
                </svg>
            </div>
            <p class="lang-zh" style="font-size: 1.2rem; font-weight: 800; margin-bottom: 12px;">安全架构师技术分享系列</p>
            <p class="lang-en hidden" style="font-size: 1.2rem; font-weight: 800; margin-bottom: 12px;">Security
                Architect Tech Series</p>

            <p class="lang-zh" style="opacity: 0.6; font-size: 0.9rem;">基于 Cisco Live 架构准则 | 深度研究与转化成果</p>
            <p class="lang-en hidden" style="opacity: 0.6; font-size: 0.9rem;">Based on Cisco Live Architecture
                Guidelines | Results of Deep Research & Transformation</p>

        </div>
    </footer>

    <main id="content-bridge">
    </main>

    <script>

        function setLang(lang) {
            // 1. 开启渲染锁：添加类名
            document.body.classList.add('is-transitioning');

            // 2. 执行核心状态切换
            document.documentElement.setAttribute('data-lang', lang);
            document.documentElement.lang = lang === 'zh' ? 'zh-CN' : 'en';

            const btns = document.querySelectorAll('.lang-btn');
            const isEn = lang === 'en';
            btns[0].classList.toggle('active', !isEn);
            btns[1].classList.toggle('active', isEn);

            // 3. 释放渲染锁：延迟 100ms 等待浏览器完成重排
            setTimeout(() => {
                document.body.classList.remove('is-transitioning');
            }, 100);
        }

        /**
        * 平滑滚动至 Demo 区域
        */
        function scrollToDemo() {
            const demoElement = document.getElementById('demo');
            if (demoElement) {
                demoElement.scrollIntoView({ behavior: 'smooth' });
            } else {
                // 如果 demo 还没加载，则滚动到页面大概位置或记录 log
                console.warn("Demo section not found yet.");
            }
        }

        /** --- 交互逻辑：点亮与打字机效果 --- **/
        let typewriterStarted = false;
        const txtZH = "内核逻辑即时更新：正在实时防御 DDoS 攻击并生成监控指标...";
        const txtEN = "Kernel Logic Updated: Defending DDoS and generating metrics in real-time...";
        let idxZH = 0, idxEN = 0;

        function igniteTypewriter() {
            if (typewriterStarted) return;
            typewriterStarted = true;

            // 1. 改变窗口视觉状态
            const browser = document.getElementById('ebpf-browser');
            const nav = document.getElementById('ebpf-nav');
            const urlText = document.getElementById('ebpf-url-text');
            
            browser.classList.add('active-power');
            nav.style.background = 'var(--cisco-midnight)';
            urlText.style.color = '#fff';

            // 2. 切换 UI 元素
            document.getElementById('btn-container').classList.add('hidden');
            document.getElementById('typewriter-area').classList.remove('hidden');

            // 3. 启动打字机
            runTypewriterAnimation();
        }

        function runTypewriterAnimation() {
            const elZH = document.getElementById('tw-zh');
            const elEN = document.getElementById('tw-en');
            const isEnglish = document.documentElement.lang === 'en';

            if (idxZH < txtZH.length) {
                elZH.textContent += txtZH.charAt(idxZH);
                idxZH++;
            }
            if (idxEN < txtEN.length) {
                elEN.textContent += txtEN.charAt(idxEN);
                idxEN++;
            }

            if (idxZH < txtZH.length || idxEN < txtEN.length) {
                setTimeout(runTypewriterAnimation, 70); // 语速稍快，增加流畅感
            } else {
                // --- 核心优化：循环等待时间缩短为 1000ms ---
                setTimeout(() => {
                    elZH.textContent = "";
                    elEN.textContent = "";
                    idxZH = 0; 
                    idxEN = 0;
                    runTypewriterAnimation();
                }, 1000); 
            }
        }

         // 100% 保留原始状态变量
        let stats = { xdp: 0, kprobe: 0 };

        /**
         * 模拟 XDP 网络拦截 - 增加 enText 国际化字段
         */
        function runXDPNetworkSimulation() {
            const btns = document.querySelectorAll('.controls .btn');
            const lines = [
                {
                    text: "root@engine:~# modprobe xdp_ddos_filter",
                    enText: "root@engine:~# modprobe xdp_ddos_filter",
                    delay: 0
                },
                {
                    text: "[  XDP INFO  ] Hook attached to eth0 (Driver Level).",
                    enText: "[  XDP INFO  ] Hook attached to eth0 (Driver Level).",
                    delay: 600,
                    color: "var(--cisco-blue)"
                },
                {
                    text: "[  XDP DROP  ] 拦截到黑名单 IP: 192.168.1.100 的非法数据包！",
                    enText: "[  XDP DROP  ] Packet from Blacklisted IP: 192.168.1.100 intercepted!",
                    delay: 1400,
                    color: "var(--cisco-red)",
                    bold: true
                },
                {
                    text: "结果: 在内核协议栈分配内存前丢弃。Map 已更新。",
                    enText: "Result: Dropped BEFORE kernel stack allocation. Map updated.",
                    delay: 2000
                }
            ];
            animateTerminal(lines, btns);
            sendCheckpointPacket('UDP', 'var(--cisco-red)', 10);
        }

        /**
         * 模拟 Kprobe 安全防护 - 增加 enText 国际化字段
         */
        function runKprobeSecuritySimulation() {
            const btns = document.querySelectorAll('.controls .btn');
            const lines = [
                {
                    text: "root@engine:~# bpftrace -e 'kprobe:sys_open { printf(\"%s\", comm); }'",
                    enText: "root@engine:~# bpftrace -e 'kprobe:sys_open { printf(\"%s\", comm); }'",
                    delay: 0
                },
                {
                    text: "[  KPROBE    ] 已挂载到内核函数: do_sys_openat2",
                    enText: "[  KPROBE    ] Attached to kernel function: do_sys_openat2",
                    delay: 600,
                    color: "var(--cisco-orange)"
                },
                {
                    text: "[  ALERT     ] 非特权进程 'attacker' 尝试访问 /etc/shadow!",
                    enText: "[  ALERT     ] Unprivileged process 'attacker' accessed /etc/shadow!",
                    delay: 1500,
                    color: "var(--cisco-red)",
                    bold: true
                },
                {
                    text: "[  ACTION    ] 通过 Helper Function 发送 SIGKILL。Map 已更新。",
                    enText: "[  ACTION    ] SIGKILL sent via Helper Function. Map updated.",
                    delay: 2200,
                    color: "var(--cisco-red)"
                }
            ];
            animateTerminal(lines, btns);
            sendCheckpointPacket('SYS', 'var(--cisco-orange)', 50);
        }

        const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));

        /**
         * 优化后的终端动画：使用 DocumentFragment 减少 60% 的渲染开销
         */
        async function animateTerminal(lines, btns) {
            const terminal = document.getElementById('kernel-terminal');
            terminal.innerHTML = "";
            btns.forEach(b => b.disabled = true);

            const isEn = document.documentElement.lang === 'en';

            try {
                for (const line of lines) {
                    await sleep(line.delay);
                    const fragment = document.createDocumentFragment();
                    const div = document.createElement('div');
                    div.className = 'terminal-line';
                    if (line.color) div.style.color = line.color;
                    if (line.bold) div.style.fontWeight = 'bold';

                    // 使用 textContent 替代 innerText，性能更好且更安全
                    div.textContent = isEn ? (line.enText || line.text) : line.text;

                    fragment.appendChild(div);
                    terminal.appendChild(fragment);
                    terminal.scrollTop = terminal.scrollHeight;
                }

                const cursorLine = document.createElement('div');
                cursorLine.className = 'terminal-line';
                cursorLine.innerHTML = `<span class="terminal-prompt">root@linux-kernel:~#</span> <span class="terminal-cursor"></span>`;
                terminal.appendChild(cursorLine);
            } finally {
                btns.forEach(b => b.disabled = false);
            }
        }

        /**
         * 重置终端 - 100% 保留 ebpf.html 逻辑
         */
        function resetTerminal() {
            const terminal = document.getElementById('kernel-terminal');
            terminal.innerHTML = '<div class="terminal-line"><span class="terminal-prompt">root@engine:~#</span> <span class="terminal-cursor"></span></div>';
            const btns = document.querySelectorAll('.controls .btn');
            btns.forEach(b => b.disabled = false);

            stats = { xdp: 0, kprobe: 0 };
            document.getElementById('xdp-count').innerText = "0";
            document.getElementById('kprobe-count').innerText = "0";
        }

        /**
         * 数据包动画逻辑 - 100% 保留 ebpf.html 逻辑
         */
        function sendCheckpointPacket(text, color, stopAtPercent) {
            const track = document.getElementById('packet-track');
            const packet = document.createElement('div');
            packet.className = 'packet';
            packet.style.backgroundColor = color;
            packet.style.color = 'white';
            packet.innerText = text;
            packet.style.left = '0%';
            track.appendChild(packet);

            setTimeout(() => { packet.style.left = stopAtPercent + '%'; }, 50);

            setTimeout(() => {
                packet.style.transform = 'translateY(-50%) scale(1.4)';
                packet.style.boxShadow = `0 0 30px ${color}`;

                setTimeout(() => {
                    packet.style.top = '150%';
                    packet.style.opacity = '0';
                    updateMapStats(stopAtPercent);
                    setTimeout(() => { packet.remove(); }, 800);
                }, 1000);
            }, 1200);
        }

        /**
         * Map 数据更新逻辑 - 100% 保留 ebpf.html 逻辑
         */
        function updateMapStats(position) {
            if (position === 10) {
                stats.xdp++;
                const el = document.getElementById('xdp-count');
                el.innerText = stats.xdp;
                el.classList.add('alert');
                setTimeout(() => el.classList.remove('alert'), 500);
            } else if (position === 50) {
                stats.kprobe++;
                const el = document.getElementById('kprobe-count');
                el.innerText = stats.kprobe;
                el.classList.add('alert');
                setTimeout(() => el.classList.remove('alert'), 500);
            }
        }
        /**
         * 自动清理 HTML 源码缩进带来的位移感
         */
        function cleanIndentation() {
            document.querySelectorAll('.code-content-stable').forEach(block => {
                const text = block.textContent;
                const lines = text.split('\n');

                // 过滤掉首尾纯空行
                const filteredLines = lines.filter((line, index) =>
                    !(index === 0 && line.trim() === '') &&
                    !(index === lines.length - 1 && line.trim() === '')
                );

                // 获取最小缩进
                const minIndent = filteredLines.reduce((min, line) => {
                    if (line.trim() === '') return min;
                    const match = line.match(/^(\s*)/);
                    return Math.min(min, match[0].length);
                }, Infinity);

                block.textContent = filteredLines.map(line => line.slice(minIndent)).join('\n');
            });
        }

        window.addEventListener('DOMContentLoaded', () => {
            // 1. 预处理：清理所有代码块缩进
            cleanIndentation();

            // 2. 默认语言
            setLang('zh');

        });
    </script>
</body>

</html>